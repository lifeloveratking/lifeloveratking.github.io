<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Linux</title>
    <url>/2023/04/19/Linux-1/</url>
    <content><![CDATA[<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h4 id="1-什么是Linux？"><a href="#1-什么是Linux？" class="headerlink" title="1.什么是Linux？"></a>1.什么是Linux？</h4><p>是一套免费使用和自由传播的类UNIX操作系统，其内核由林纳斯·本纳第克特·托瓦兹于1991年第一次释出，它主要受到Minix和Unix思想的启发，是一个基于POSIX和Unix的多用户、多任务、支持多线程和多CPU的操作系统。它能运行主要的Unix工具软件、应用程序和网络协议。它支持32位和64位硬件。</p>
<h4 id="2-Linux内核主要负责哪些功能"><a href="#2-Linux内核主要负责哪些功能" class="headerlink" title="2.Linux内核主要负责哪些功能"></a>2.Linux内核主要负责哪些功能</h4><ul>
<li>系统内存管理</li>
<li>软件程序管理</li>
<li>硬件设备管理</li>
<li>文件系统管理</li>
</ul>
<h4 id="3-交互方式"><a href="#3-交互方式" class="headerlink" title="3.交互方式"></a>3.交互方式</h4><p>控制台终端、图形化终端</p>
<h4 id="4-启动shell"><a href="#4-启动shell" class="headerlink" title="4.启动shell"></a>4.启动shell</h4><p>GNU bash shell能提供对linux 系统的交互式访问。作为普通程序运行，通常在用户登陆终端时启动。登录时系统启动的shell依赖与用户账户的配置。</p>
<h4 id="5-bash手册"><a href="#5-bash手册" class="headerlink" title="5.bash手册"></a>5.bash手册</h4><p>大多数linux发行版自带以查找shell命令及其他GNU工具信息的在线手册。man命令用来访问linux系统上的手册页面。当用man命令查看手册，使用分页的程序来现实的。</p>
<h4 id="6-登陆后你在的位置？"><a href="#6-登陆后你在的位置？" class="headerlink" title="6.登陆后你在的位置？"></a>6.登陆后你在的位置？</h4><p>一般登陆后，你的位置位于自己的主目录中。</p>
<h4 id="7-绝对文件路径-相对文件路径？快捷方式？"><a href="#7-绝对文件路径-相对文件路径？快捷方式？" class="headerlink" title="7.绝对文件路径?相对文件路径？快捷方式？"></a>7.绝对文件路径?相对文件路径？快捷方式？</h4><p>绝对文件路径：描述了在虚拟目录结构中该目录的确切位置，以虚拟目录跟目录开始，相当于目录全名。</p>
<p>以正斜线(&#x2F;)开始，比如 &#x2F;usr&#x2F;local。</p>
<p>相对文件路径：允许用户执行一个基于当前位置的目标文件路径。</p>
<p>比如:当前在&#x2F;usr&#x2F;local</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  local ls</span><br><span class="line">Caskroom   Frameworks bin        go         lib        sbin       var</span><br><span class="line">Cellar     Homebrew   etc        include    opt        share</span><br><span class="line">➜  local cd go</span><br></pre></td></tr></table></figure>

<p>快捷方式(在相对路径中使用):</p>
<p>单点符(.) : 表示当前目录; 双点符(..) :  表示当前目录的父目录。</p>
<h4 id="8-迷路，我的当前位置在哪？"><a href="#8-迷路，我的当前位置在哪？" class="headerlink" title="8.迷路，我的当前位置在哪？"></a>8.迷路，我的当前位置在哪？</h4><p>pwd 显示当前目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz local]# pwd</span><br><span class="line">/usr/local</span><br></pre></td></tr></table></figure>

<h4 id="9-如何切换目录？"><a href="#9-如何切换目录？" class="headerlink" title="9.如何切换目录？"></a>9.如何切换目录？</h4><p>语法: cd destination</p>
<p>destination : 相对文件路径或绝对文件路径</p>
<p>可以跳到存在的任意目录。</p>
<h4 id="10-如何查看目录中的文件？区分哪些是文件哪些是目录-递归查"><a href="#10-如何查看目录中的文件？区分哪些是文件哪些是目录-递归查" class="headerlink" title="10.如何查看目录中的文件？区分哪些是文件哪些是目录?递归查?"></a>10.如何查看目录中的文件？区分哪些是文件哪些是目录?递归查?</h4><p>ls 命令会用最基本的形式显示当前目录下的文件和目录：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  local ls</span><br><span class="line">Caskroom   Frameworks bin        go         lib        sbin       var</span><br><span class="line">Cellar     Homebrew   etc        include    opt        share</span><br></pre></td></tr></table></figure>

<p>可以看出默认是按照字母序展示的</p>
<p>一般来说，ls命令回显示不同的颜色区分不同的文件类型,如果没有安装颜色插件可以用ls -F来区分哪些是目录（目录带&#x2F;)，哪些是文件（文件不带&#x2F;)</p>
<p>  ls -R 递归展示出目录下以及子目录的文件，目录越多输出越多</p>
<h4 id="11-创建文件？创建目录？批量创建"><a href="#11-创建文件？创建目录？批量创建" class="headerlink" title="11.创建文件？创建目录？批量创建?"></a>11.创建文件？创建目录？批量创建?</h4><p>创建文件:touch 文件名</p>
<p>批量创建文件: touch  文件名 文件名 …</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  test touch a</span><br><span class="line">➜  test ls</span><br><span class="line">a</span><br><span class="line">➜  test touch b c</span><br><span class="line">➜  test ls</span><br><span class="line">a b c</span><br></pre></td></tr></table></figure>

<p>创建目录：mkdir 目录名</p>
<p>批量创建目录: mkdir 目录名 目录名 …</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  test mkdir aa</span><br><span class="line">➜  test mkdir bb cc</span><br><span class="line">➜  test ls</span><br><span class="line">a  aa b  bb c  cc</span><br><span class="line">➜  test ls -F</span><br><span class="line">a   aa/ b   bb/ c   cc/</span><br></pre></td></tr></table></figure>

<h4 id="12-删除文件-强制删除？递归删除"><a href="#12-删除文件-强制删除？递归删除" class="headerlink" title="12.删除文件?强制删除？递归删除?"></a>12.删除文件?强制删除？递归删除?</h4><p>语法: rm destination</p>
<p>-i 询问是否删除,-r 递归删除，-f 强制删除。</p>
<p>rm不能删除有文件的目录,需要递归删除。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest rm jdk</span><br><span class="line">rm: jdk: is a directory</span><br><span class="line">➜  xktest rm -r jdk</span><br><span class="line">➜  xktest ls</span><br></pre></td></tr></table></figure>

<p>rm -i 询问删除,建议大家平时删除多用 -i，确定一下再删除。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest touch tomcat</span><br><span class="line">➜  xktest rm -i tomcat</span><br><span class="line">remove tomcat? n</span><br></pre></td></tr></table></figure>

<p>rm -rf 会直接删除，没有警告信息，使用必须谨慎**。</p>
<h4 id="13-制表符自动补全？"><a href="#13-制表符自动补全？" class="headerlink" title="13.制表符自动补全？"></a>13.制表符自动补全？</h4><p>有的时候文件的名字很长，很容易拼出错即使拼写对了也很浪费时间。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest ls java*</span><br><span class="line">javaxiaokaxiu</span><br></pre></td></tr></table></figure>

<p>   比如操作javaxiaokaxiu这个文件时，输入到java的时候，然后按制表键(tab)就会补全成javaxiaokaxiu,是不是方便多了。</p>
<h4 id="14-复制文件"><a href="#14-复制文件" class="headerlink" title="14.复制文件"></a>14.复制文件</h4><p>语法: cp source target</p>
<p>如果target不存在则直接创建，如果存在，默认不会提醒你是否需要覆盖，需要加-i就会询问你是否覆盖,n否y是。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest cp a c</span><br><span class="line">➜  xktest cp -i a c</span><br><span class="line">overwrite c? (y/n [n]) y</span><br><span class="line">➜  xktest ls</span><br><span class="line">a c</span><br></pre></td></tr></table></figure>

<h4 id="15-重新命名文件？移动文件？"><a href="#15-重新命名文件？移动文件？" class="headerlink" title="15.重新命名文件？移动文件？"></a>15.重新命名文件？移动文件？</h4><p>语法 ： mv soucre target </p>
<p>重命名:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest ls</span><br><span class="line">➜  xktest touch java</span><br><span class="line">➜  xktest ls</span><br><span class="line">java</span><br><span class="line">➜  xktest mv java java1.8</span><br><span class="line">➜  xktest ls</span><br><span class="line">java1.8</span><br></pre></td></tr></table></figure>

<p>移动文件:</p>
<p>新建jdk目录把java1.8文件移动到jdk目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  xktest ls</span><br><span class="line">java1.8</span><br><span class="line">➜  xktest mkdir jdk</span><br><span class="line">➜  xktest mv java1.8 jdk</span><br><span class="line">➜  xktest ls -R</span><br><span class="line">jdk</span><br><span class="line"></span><br><span class="line">./jdk:</span><br><span class="line">java1.8</span><br></pre></td></tr></table></figure>

<h4 id="16-什么是链接文件？"><a href="#16-什么是链接文件？" class="headerlink" title="16.什么是链接文件？"></a>16.什么是链接文件？</h4><p>如过需要在系统上维护同一文件的两份或者多份副本，除了保存多分单独的物理文件副本之外。还可以采用保存一份物理文件副本和多个虚拟副本的方法，这种虚拟的副本就叫做链接。</p>
<h4 id="17-查看文件类型-字符编码？"><a href="#17-查看文件类型-字符编码？" class="headerlink" title="17.查看文件类型?字符编码？"></a>17.查看文件类型?字符编码？</h4><p>语法: file destination</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache file tomcat</span><br><span class="line">tomcat: ASCII text</span><br></pre></td></tr></table></figure>

<p>可以看出，file命令可以显示文件的类型text以及字符编码ASCII</p>
<h4 id="18-查看整个文件？按照有文本显示行号？无文本显示行号？"><a href="#18-查看整个文件？按照有文本显示行号？无文本显示行号？" class="headerlink" title="18.查看整个文件？按照有文本显示行号？无文本显示行号？"></a>18.查看整个文件？按照有文本显示行号？无文本显示行号？</h4><p>语法 : cat destination</p>
<p>-n 显示行号，-b 有文本的显示行号。 （默认是不显示行号的)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache cat -n tomcat</span><br><span class="line">     1  text</span><br><span class="line">     2  text</span><br><span class="line">     3</span><br><span class="line">     4  start</span><br><span class="line">     5  stop</span><br><span class="line">     6  restart</span><br><span class="line">     7  end</span><br><span class="line">➜  apache cat -b tomcat</span><br><span class="line">     1  text</span><br><span class="line">     2  text</span><br><span class="line"></span><br><span class="line">     3  start</span><br><span class="line">     4  stop</span><br><span class="line">     5  restart</span><br><span class="line">     6  end</span><br></pre></td></tr></table></figure>

<h4 id="19-查看部分文件"><a href="#19-查看部分文件" class="headerlink" title="19.查看部分文件"></a>19.查看部分文件</h4><p>语法 : tail  destination</p>
<p>默认情况会展示文件的末尾10行。 -n 行数，显示最后n行。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache tail -n 2 tomcat</span><br><span class="line">restart</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>语法: head destination </p>
<p>默认情况会展示文件的开头10行。 -n 行数，显示开头n行。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache head -n 2 tomcat</span><br><span class="line">text</span><br><span class="line">text</span><br></pre></td></tr></table></figure>

<h4 id="20-数据排序-对数字进行排序？对月份排序？"><a href="#20-数据排序-对数字进行排序？对月份排序？" class="headerlink" title="20.数据排序?对数字进行排序？对月份排序？"></a>20.数据排序?对数字进行排序？对月份排序？</h4><p>默认情况下，文件的数据展示是按照原顺序展示的。sort命令可以对文本文件中的数据进行排序。sort默认会把数据当成字符处理。</p>
<p>语法: sort destination</p>
<p>sort -n 所以排序数字时需要用-n，它的含义是说当前排序是的数字。</p>
<p>sort -M 比如月份Jan、Feb、Mar，如果希望它按照月份排序，加入-M就会按照月份的大小来排序。</p>
<h4 id="21-查找匹配数据？反向搜？"><a href="#21-查找匹配数据？反向搜？" class="headerlink" title="21.查找匹配数据？反向搜？"></a>21.查找匹配数据？反向搜？</h4><p>语法: grep [options] pattern [file]</p>
<p>该命令会查找匹配执行模式的字符串的行，并输出。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache grep start tomcat</span><br><span class="line">start</span><br><span class="line">restart</span><br></pre></td></tr></table></figure>

<p>-v 反向搜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache grep -v start tomcat</span><br><span class="line">text</span><br><span class="line">text</span><br><span class="line"></span><br><span class="line">stop</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>-n 显示行号</p>
<p>-c 显示匹配的行数</p>
<h4 id="22-压缩工具有哪些"><a href="#22-压缩工具有哪些" class="headerlink" title="22.压缩工具有哪些?"></a>22.压缩工具有哪些?</h4><p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/image-20200421122324314.png" alt="image-20200421122324314"></p>
<h4 id="23-如何压缩文件？如何解压文件"><a href="#23-如何压缩文件？如何解压文件" class="headerlink" title="23.如何压缩文件？如何解压文件?"></a>23.如何压缩文件？如何解压文件?</h4><p>比如以.gz的格式举例。</p>
<p>压缩语法: gzip destination</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache gzip tomcat</span><br><span class="line">➜  apache ls</span><br><span class="line">tomcat.gz</span><br></pre></td></tr></table></figure>

<p>解压语法: gunzip destination</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache gunzip tomcat.gz</span><br><span class="line">➜  apache ls</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure>

<h4 id="24-Linux广泛使用的归档数据方法"><a href="#24-Linux广泛使用的归档数据方法" class="headerlink" title="24.Linux广泛使用的归档数据方法?"></a>24.Linux广泛使用的归档数据方法?</h4><p>虽然zip命令能压缩和解压单个文件，但是更多的时候广泛使用tar命令来做归档。</p>
<p>语法: tar function [options] obj1 obj2</p>
<p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/image-20200421122932671.png" alt="image-20200421122932671"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache tar -cvf service.tar service1 service2 // 创建规定文件service.tar</span><br><span class="line">a service1</span><br><span class="line">a service2</span><br><span class="line">➜  apache tar -tf service.tar //查看文件中的目录内容</span><br><span class="line">service1</span><br><span class="line">service2</span><br><span class="line">➜  apache tar zxvf service.tar //解压</span><br><span class="line">x service1</span><br><span class="line">x service2</span><br></pre></td></tr></table></figure>

<h4 id="25-如何查看命令历史记录"><a href="#25-如何查看命令历史记录" class="headerlink" title="25.如何查看命令历史记录?"></a>25.如何查看命令历史记录?</h4><p>   history 命令可以展示你用的命令的历史记录。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4463  touch service1 service2</span><br><span class="line">4464  ls</span><br><span class="line">4465  tar -cvf service.tar service1 service2</span><br><span class="line">4466  tar -tf service.tar</span><br><span class="line">4467  tar zxvf service</span><br><span class="line">4468  tar zxvf service.t</span><br><span class="line">4469  tar zxvf service.tar</span><br><span class="line">4470  ls</span><br><span class="line">4471  tar -zxvf  service.tar</span><br><span class="line">4472  ls</span><br></pre></td></tr></table></figure>

<h4 id="26-查看已有别名-建立属于自己的别名"><a href="#26-查看已有别名-建立属于自己的别名" class="headerlink" title="26.查看已有别名?建立属于自己的别名?"></a>26.查看已有别名?建立属于自己的别名?</h4><p>alias -p 查看当前可用别名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# alias -p</span><br><span class="line">alias cp=&#x27;cp -i&#x27;</span><br><span class="line">alias egrep=&#x27;egrep —color=auto&#x27;</span><br><span class="line">alias fgrep=&#x27;fgrep —color=auto&#x27;</span><br><span class="line">alias grep=&#x27;grep —color=auto&#x27;</span><br><span class="line">alias l.=&#x27;ls -d .* —color=auto&#x27;</span><br><span class="line">alias ll=&#x27;ls -l —color=auto&#x27;</span><br></pre></td></tr></table></figure>

<p>alias li &#x3D; ‘ls  -li’ 创建别名</p>
<h4 id="27-什么是环境变量？"><a href="#27-什么是环境变量？" class="headerlink" title="27.什么是环境变量？"></a>27.什么是环境变量？</h4><p>bash shell用一个叫作环境变量(environment variable)的特性来存储有关shell会话和工作环境的信息。这项特性允许你在内存中存储数据，以便程序或shell中运行的脚本能够轻松访问到它们。这也是存储持久数据的一种简便方法。</p>
<p>在bash shell中，环境变量分为两类: </p>
<p> 全局变量：对于 shell会话和所有生成的子shell都是可见的。 局部变量： 只对创建他们的shell可见。</p>
<h4 id="28-储存用户的文件是-包括哪些信息？"><a href="#28-储存用户的文件是-包括哪些信息？" class="headerlink" title="28.储存用户的文件是?包括哪些信息？"></a>28.储存用户的文件是?包括哪些信息？</h4><p>&#x2F;etc&#x2F;passwd存储来一些用户有关的信息。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>文件信息包括如下内容。</p>
<ul>
<li>登录用户名</li>
<li>用户密码</li>
<li>用户账户的UID(数字形式)</li>
<li>用户账户的组ID(GID)(数字形式) </li>
<li>用户账户的文本描述(称为备注字段) </li>
<li>用户HOME目录的位置</li>
<li>用户的默认shell</li>
</ul>
<h4 id="29-账户默认信息？添加账户？删除用户？"><a href="#29-账户默认信息？添加账户？删除用户？" class="headerlink" title="29.账户默认信息？添加账户？删除用户？"></a>29.账户默认信息？添加账户？删除用户？</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# useradd -D//查看系统默认创建用户信息</span><br><span class="line">GROUP=100</span><br><span class="line">HOME=/home</span><br><span class="line">INACTIVE=-1</span><br><span class="line">EXPIRE=</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">SKEL=/etc/skel</span><br><span class="line">CREATE_MAIL_SPOOL=yes</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# useradd xiaoka//添加用户</span><br><span class="line"></span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz /]# userdel xiaoka//删除用户</span><br></pre></td></tr></table></figure>

<h4 id="30-查看组信息？如何创建组？删除组？"><a href="#30-查看组信息？如何创建组？删除组？" class="headerlink" title="30.查看组信息？如何创建组？删除组？"></a>30.查看组信息？如何创建组？删除组？</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# cat /etc/group</span><br><span class="line">root:x:0:</span><br><span class="line">bin:x:1:</span><br><span class="line">daemon:x:2:</span><br><span class="line">sys:x:3:</span><br><span class="line">adm:x:4:</span><br><span class="line">tty:x:5:</span><br><span class="line">disk:x:6:</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# groupadd java //创建组</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# groupdel java //创建组</span><br></pre></td></tr></table></figure>

<h4 id="31-文件描述符-每个描述符的含义"><a href="#31-文件描述符-每个描述符的含义" class="headerlink" title="31.文件描述符?每个描述符的含义?"></a>31.文件描述符?每个描述符的含义?</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz xiaoka]# ls -l</span><br><span class="line">总用量 0</span><br><span class="line">-rw-r—r— 1 root root 0 4月  21 13:17 a</span><br><span class="line">-rw-r—r— 1 root root 0 4月  21 13:17 b</span><br><span class="line">-rw-r—r— 1 root root 0 4月  21 13:17 c</span><br><span class="line">-rw-r—r— 1 root root 0 4月  21 13:17 d</span><br><span class="line">-rw-r—r— 1 root root 0 4月  21 13:17 e</span><br></pre></td></tr></table></figure>

<p>1、文件类型:</p>
<ul>
<li>-代表文件</li>
<li>d代表目录</li>
<li>l代表链接</li>
<li>c代表字符型设备</li>
<li>b代表块设备</li>
<li>n代表网络设备</li>
</ul>
<p>2、访问权限符号:</p>
<ul>
<li>r代表对象是可读的 </li>
<li>w代表对象是可写的</li>
<li>x代表对象是可执行的</li>
</ul>
<p>若没有某种权限，在该权限位会出现单破折线。</p>
<p>3、这3组权限分别对应对象的3个安全级别:</p>
<ul>
<li>对象的属主</li>
<li>对象的属组</li>
<li>系统其他用户</li>
</ul>
<h4 id="31-修改权限"><a href="#31-修改权限" class="headerlink" title="31.修改权限?"></a>31.修改权限?</h4><p>chmod options mode file</p>
<p>比如给文件附加可以执行权限:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@xiaoka ~]# chmod +x filename</span><br></pre></td></tr></table></figure>

<h4 id="32-如何执行可以执行文件"><a href="#32-如何执行可以执行文件" class="headerlink" title="32.如何执行可以执行文件?"></a>32.如何执行可以执行文件?</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@xiaoka ~]# sh sleep.sh</span><br><span class="line">hello,xiaoka</span><br><span class="line">[root@xiaoka ~]# ./sleep.sh</span><br><span class="line">hello,xiaoka</span><br></pre></td></tr></table></figure>

<h4 id="33-列出已经安装的包？安装软件？更新软件？卸载"><a href="#33-列出已经安装的包？安装软件？更新软件？卸载" class="headerlink" title="33.列出已经安装的包？安装软件？更新软件？卸载?"></a>33.列出已经安装的包？安装软件？更新软件？卸载?</h4><p>列出已经安装的包: yum list installed</p>
<p>安装软件: yum install package_name</p>
<p>更新软件: yum update package_name</p>
<p>卸载软件:yum remove package_name &#x2F;&#x2F;只删除软件包保留数据文件和配置文件</p>
<p>如果不希望保留数据文件和配置文件</p>
<p>可以执行:yum erase package_name</p>
<h4 id="34-源码安装通常的路子"><a href="#34-源码安装通常的路子" class="headerlink" title="34.源码安装通常的路子?"></a>34.源码安装通常的路子?</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -zxvf xx.gz //解包</span><br><span class="line">cd xx</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<h4 id="35-vim编辑器几种操作模式？基本操作"><a href="#35-vim编辑器几种操作模式？基本操作" class="headerlink" title="35.vim编辑器几种操作模式？基本操作?"></a>35.vim编辑器几种操作模式？基本操作?</h4><p>操作模式: </p>
<ul>
<li>普通模式</li>
<li>插入模式</li>
</ul>
<p> 基础操作:</p>
<ul>
<li>h:左移一个字符。</li>
<li>j:下移一行(文本中的下一行)。 </li>
<li>k:上移一行(文本中的上一行)。 </li>
<li>l:右移一个字符。</li>
</ul>
<p>vim提供了一些能够提高移动速度的命令:</p>
<ul>
<li>PageDown(或Ctrl+F):下翻一屏</li>
<li>PageUp(或Ctrl+B):上翻一屏。</li>
<li>G:移到缓冲区的最后一行。</li>
<li>num G:移动到缓冲区中的第num行。 </li>
<li>gg:移到缓冲区的第一行。</li>
</ul>
<p>退出vim:</p>
<ul>
<li>q:如果未修改缓冲区数据，退出。</li>
<li>q!:取消所有对缓冲区数据的修改并退出。</li>
<li>w filename:将文件保存到另一个文件中。</li>
<li>wq:将缓冲区数据保存到文件中并退出。</li>
</ul>
<h4 id="36-查看设备还有多少磁盘空间"><a href="#36-查看设备还有多少磁盘空间" class="headerlink" title="36.查看设备还有多少磁盘空间?"></a>36.查看设备还有多少磁盘空间?</h4><p>df 可以查看所有已挂在磁盘的使用情况。</p>
<p>-m 用兆字节，G代替g字节</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# df</span><br><span class="line">文件系统          1K-块    已用     可用 已用% 挂载点</span><br><span class="line">devtmpfs        1931568       0  1931568    0% /dev</span><br><span class="line">tmpfs           1940960       0  1940960    0% /dev/shm</span><br><span class="line">tmpfs           1940960     720  1940240    1% /run</span><br><span class="line">tmpfs           1940960       0  1940960    0% /sys/fs/cgroup</span><br><span class="line">/dev/vda1      41152812 9068544 30180560   24% /</span><br><span class="line">tmpfs            388192       0   388192    0% /run/user/0</span><br></pre></td></tr></table></figure>

<h6 id="快速判断某个特定目录是否有超大文件？"><a href="#快速判断某个特定目录是否有超大文件？" class="headerlink" title="快速判断某个特定目录是否有超大文件？"></a>快速判断某个特定目录是否有超大文件？</h6><p>默认情况，du会显示当前目录的所有文件、目录、子目录的磁盘使用情况。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz src]# du</span><br><span class="line">4 ./debug</span><br><span class="line">4 ./kernels</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h4 id="37-默认进程信息显示"><a href="#37-默认进程信息显示" class="headerlink" title="37.默认进程信息显示?"></a>37.默认进程信息显示?</h4><p>ps它能输出运行在系统上的所有程序的许多信息。</p>
<p>默认情况下ps值显示运行在当前控制台下的当前用户的进程。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">10102 pts/0    00:00:00 bash</span><br><span class="line">10131 pts/0    00:00:00 ps</span><br></pre></td></tr></table></figure>

<h4 id="38-实时监测进程"><a href="#38-实时监测进程" class="headerlink" title="38.实时监测进程"></a>38.实时监测进程</h4><p>与ps相比，top可以实时监控进程信息。</p>
<p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/image-20200421114633852.png" alt="image-20200421114633852"></p>
<p>平均负载有3个值:最近1分钟的、最近5分钟的和最近15分钟的平均负载。值越大说明系统 的负载越高。由于进程短期的突发性活动，出现最近1分钟的高负载值也很常见，但如果近15分 钟内的平均负载都很高，就说明系统可能有问题。</p>
<h4 id="39-如何中断一个进程"><a href="#39-如何中断一个进程" class="headerlink" title="39.如何中断一个进程?"></a>39.如何中断一个进程?</h4><p>在一个终端中， Ctrl + c</p>
<p>通过这个命令许多（不是全部）命令行程序都可以被中断。</p>
<h4 id="40-如何把一个进程放到后台运行？"><a href="#40-如何把一个进程放到后台运行？" class="headerlink" title="40.如何把一个进程放到后台运行？"></a>40.如何把一个进程放到后台运行？</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# ./sleep.sh &amp;</span><br></pre></td></tr></table></figure>

<p>此时，进程并不能被Ctrl + c 中断。</p>
<h4 id="41-如何停止一个进程"><a href="#41-如何停止一个进程" class="headerlink" title="41.如何停止一个进程?"></a>41.如何停止一个进程?</h4><p>kill命令被用来给程序发送信号。如果没有指定信号，默认发送TERM(终止）信号。</p>
<p>语法 : kill [-signal] PID …</p>
<p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/image-20200421141556974.png" alt="image-20200421141556974"></p>
<p>#### </p>
<h4 id="42-验证网络可链接命令是什么？什么原理？"><a href="#42-验证网络可链接命令是什么？什么原理？" class="headerlink" title="42.验证网络可链接命令是什么？什么原理？"></a>42.验证网络可链接命令是什么？什么原理？</h4><p> ping。这个 ping 命令发送一个特殊的网络数据包(叫做 IMCP ECHO REQUEST)到一台指定的主机。大多数接收这个包的网络设备将会回复它，来允许网络连接验证。</p>
<p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/image-20200421142307602.png" alt="image-20200421142307602"></p>
<p>一旦启动，ping会持续在特定时间（默认1秒）发送数据包。</p>
<h4 id="43-查看某端口是否被占用"><a href="#43-查看某端口是否被占用" class="headerlink" title="43.查看某端口是否被占用?"></a>43.查看某端口是否被占用?</h4><p>netstat -ntulp|grep 8080</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# netstat -ntulp|grep 8080</span><br><span class="line">tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      4517/java</span><br></pre></td></tr></table></figure>

<p>参数说明:</p>
<ul>
<li>-t (tcp) 仅显示tcp相关选项</li>
<li>-u (udp)仅显示udp相关选项</li>
<li>-n 拒绝显示别名，能显示数字的全部转化为数字</li>
<li>-l 仅列出在Listen(监听)的服务状态</li>
<li>-p 显示建立相关链接的程序名</li>
</ul>
<h4 id="44-如何查找匹配的文件？基于文件属性？"><a href="#44-如何查找匹配的文件？基于文件属性？" class="headerlink" title="44.如何查找匹配的文件？基于文件属性？"></a>44.如何查找匹配的文件？基于文件属性？</h4><p> find 程序能基于各种各样的属性，搜索一个给 定目录(以及它的子目录)，来查找文件。</p>
<p>find 命令的最简单使用是，搜索一个或多个目录。</p>
<p>普通查找，按照name查找:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# find -name xiaoka</span><br><span class="line">./xiaoka</span><br></pre></td></tr></table></figure>

<p>文件类型查找:</p>
<p>比如,输出我们的家目录文件数量</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# find ~|wc -l</span><br><span class="line">17130</span><br></pre></td></tr></table></figure>

<p>根据文件类型查:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]#  find ~ -type d | wc -l</span><br><span class="line">7340</span><br></pre></td></tr></table></figure>

<p>find支持的类型: b 块设备文件、 c 字符设备文件、d 目录、f 普通文件、l 符号链接</p>
<h4 id="45-如何查看当前主机名？如何修改？如何重启后生效？"><a href="#45-如何查看当前主机名？如何修改？如何重启后生效？" class="headerlink" title="45.如何查看当前主机名？如何修改？如何重启后生效？"></a>45.如何查看当前主机名？如何修改？如何重启后生效？</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# hostname//查看当前主机名</span><br><span class="line">iz2ze76ybn73dvwmdij06zz</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# hostname xiaoka//修改当前主机名</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# hostname</span><br><span class="line">xiaoka</span><br></pre></td></tr></table></figure>

<p>大家知道一般来讲命令重启就会失效，目前基本上用的centos7的比较多，两种方式可以支持重启生效。</p>
<p>一、命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# hostnamectl set-hostname xiaoka</span><br><span class="line">[root@iz2ze76ybn73dvwmdij06zz ~]# hostname</span><br><span class="line">xiaoka</span><br><span class="line">[root@xiaoka ~]#</span><br></pre></td></tr></table></figure>

<p> 二、修改配置文件:&#x2F;etc&#x2F;hostname</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@xiaoka ~]# vim /etc/hostname</span><br></pre></td></tr></table></figure>

<h4 id="46-如何写一条规则，拒绝某个ip访问本机8080端口"><a href="#46-如何写一条规则，拒绝某个ip访问本机8080端口" class="headerlink" title="46.如何写一条规则，拒绝某个ip访问本机8080端口?"></a>46.如何写一条规则，拒绝某个ip访问本机8080端口?</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iptables -I INPUT -s ip -p tcp —dport 8080 -j REJECT</span><br></pre></td></tr></table></figure>

<h4 id="47-哪个文件包含了主机名和ip的映射关系"><a href="#47-哪个文件包含了主机名和ip的映射关系" class="headerlink" title="47.哪个文件包含了主机名和ip的映射关系?"></a>47.哪个文件包含了主机名和ip的映射关系?</h4><p>&#x2F;etc&#x2F;hosts</p>
<h4 id="48-如何用sed只打印第5行-删除第一行？替换字符串"><a href="#48-如何用sed只打印第5行-删除第一行？替换字符串" class="headerlink" title="48.如何用sed只打印第5行?删除第一行？替换字符串?"></a>48.如何用sed只打印第5行?删除第一行？替换字符串?</h4><p> 只打印第5行:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache sed -n &quot;5p&quot; tomcat</span><br><span class="line">stop</span><br></pre></td></tr></table></figure>

<p>删除第一行:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@xiaoka ~]# cat story</span><br><span class="line">Long ago a lion and a bear saw a kid.</span><br><span class="line">They sprang upon it at the same time.</span><br><span class="line">The lion said to the bear, “I caught this kid first, and so this is mine.”</span><br><span class="line">[root@xiaoka ~]# cat story</span><br><span class="line">They sprang upon it at the same time.</span><br><span class="line">The lion said to the bear, “I caught this kid first, and so this is mine.”</span><br></pre></td></tr></table></figure>

<p>替换字符串:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache cat story</span><br><span class="line">Long ago a lion and a bear saw a kid.</span><br><span class="line">They sprang upon it at the same time.</span><br><span class="line">The lion said to the bear, “I caught this kid first, and so this is mine.”</span><br><span class="line">➜  apache sed &#x27;s#this#that#g&#x27; story</span><br><span class="line">Long ago a lion and a bear saw a kid.</span><br><span class="line">They sprang upon it at the same time.</span><br><span class="line">The lion said to the bear, “I caught that kid first, and so that is mine.”</span><br></pre></td></tr></table></figure>

<h4 id="49-打印文件第一行到第三行"><a href="#49-打印文件第一行到第三行" class="headerlink" title="49.打印文件第一行到第三行?"></a>49.打印文件第一行到第三行?</h4><p>​    文件tomcat中内容:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache cat tomcat</span><br><span class="line">text21</span><br><span class="line">text22</span><br><span class="line">text23</span><br><span class="line">start</span><br><span class="line">stop</span><br><span class="line">restart</span><br><span class="line">end</span><br><span class="line">➜ apache head -3 tomcat</span><br><span class="line">text21</span><br><span class="line">text22</span><br><span class="line">text23</span><br><span class="line">➜ apache sed -n &#x27;1,3p&#x27; tomcat</span><br><span class="line">text21</span><br><span class="line">text22</span><br><span class="line">text23</span><br><span class="line">➜ apache awk &#x27;NR&gt;=1&amp;&amp;NR&lt;=3&#x27; tomcat</span><br><span class="line">text21</span><br><span class="line">text22</span><br><span class="line">text23</span><br></pre></td></tr></table></figure>

<h4 id="50-如何用awk查看第2行倒数第3个字段"><a href="#50-如何用awk查看第2行倒数第3个字段" class="headerlink" title="50.如何用awk查看第2行倒数第3个字段?"></a>50.如何用awk查看第2行倒数第3个字段?</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  apache awk &#x27;NR==3&#123;print $(NF-2)&#125;&#x27; story</span><br><span class="line">this</span><br><span class="line">➜  apache cat story</span><br><span class="line">Long ago a lion and a bear saw a kid.</span><br><span class="line">They sprang upon it at the same time.</span><br><span class="line">The lion said to the bear, “I caught this kid first, and so this is mine.”</span><br></pre></td></tr></table></figure>

<p>参考:</p>
<ul>
<li><p>《鸟哥Linux私房菜》</p>
</li>
<li><p>《快乐的命令行》</p>
</li>
<li><p>《Linux命令行与shell脚本编程大全(第3版）》</p>
</li>
<li><p>《Linux从入门到精通》</p>
</li>
<li><p>百度百科</p>
<p><img src="https://gitee.com/yizhibuerdai/Imagetools/raw/master/images/common1.png" alt="WechatIMG360"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>git</title>
    <url>/2023/04/16/git/</url>
    <content><![CDATA[<h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><blockquote>
<p>之前学的，没整理</p>
</blockquote>
<h2 id="Git-简介"><a href="#Git-简介" class="headerlink" title="Git 简介"></a>Git 简介</h2><p>Git 是一个开源的分布式版本控制系统。</p>
<p>什么是版本控制？ 版本控制是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统。</p>
<h3 id="什么是分布式版本控制系统？"><a href="#什么是分布式版本控制系统？" class="headerlink" title="什么是分布式版本控制系统？"></a>什么是分布式版本控制系统？</h3><p>介绍分布式版本控制系统前，有必要先了解一下传统的集中式版本控制系统。</p>
<p>集中化的版本控制系统，诸如 CVS，Subversion 等，都有一个单一的集中管理的服务器，保存所有文件的修订版本，而协同工作的人们都通过客户端连到这台服务器，取出最新的文件或者提交更新。</p>
<p>这么做最显而易见的缺点是中央服务器的单点故障。如果宕机一小时，那么在这一小时内，谁都无法提交更新，也就无法协同工作。要是中央服务器的磁盘发生故障，碰巧没做备份，或者备份不够及时，就会有丢失数据的风险。最坏的情况是彻底丢失整个项目的所有历史更改记录。</p>
<p><img src="https://static001.geekbang.org/infoq/ba/bad1467f92a056810239cad9a2501c45.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p>分布式版本控制系统的客户端并不只提取最新版本的文件快照，而是把代码仓库完整地镜像下来。这么一来，任何一处协同工作用的服务器发生故障，事后都可以用任何一个镜像出来的本地仓库恢复。因为每一次的提取操作，实际上都是一次对代码仓库的完整备份。</p>
<p><img src="https://static001.geekbang.org/infoq/f6/f65d9fcd054ca0198631ff88c7507571.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<h2 id="Git-vs-SVN"><a href="#Git-vs-SVN" class="headerlink" title="Git vs SVN"></a>Git vs SVN</h2><p>Git 和 SVN 孰优孰好，每个人有不同的体验。</p>
<p>Git 是分布式的，SVN 是集中式的</p>
<p>这是 Git 和 SVN 最大的区别。若能掌握这个概念，两者区别基本搞懂大半。因为 Git 是分布式的，所以 Git 支持离线工作，在本地可以进行很多操作，包括接下来将要重磅推出的分支功能。而 SVN 必须联网才能正常工作。</p>
<ul>
<li>Git 复杂概念多，SVN 简单易上手</li>
</ul>
<p>所有同时掌握 Git 和 SVN 的开发者都必须承认，Git 的命令实在太多了，日常工作需要掌握 add,commit,status,fetch,push,rebase 等，若要熟练掌握，还必须掌握 rebase 和 merge<br>的区别，fetch 和 pull 的区别等，除此之外，还有 cherry-pick，submodule，stash 等功能，仅是这些名词听着都很绕。</p>
<p>在易用性这方面，SVN 对于新手来说会更有好一些。但是从另外一方面看，Git 命令多意味着功能多，若我们能掌握大部分 Git 的功能，体会到其中的奥妙，会发现再也回不去 SVN 的时代了。</p>
<ul>
<li>Git 分支廉价，SVN 分支昂贵</li>
</ul>
<p>在版本管理里，分支是很常使用的功能。在发布版本前，需要发布分支，进行大需求开发，需要 feature 分支，大团队还会有开发分支，稳定分支等。在大团队开发过程中，常常存在创建分支，切换分支的求。</p>
<p>Git 分支是指针指向某次提交，而 SVN 分支是拷贝的目录。这个特性使 Git 的分支切换非常迅速，并且创建成本非常低。</p>
<p>而且 Git 有本地分支，SVN 无本地分支。在实际开发过程中，经常会遇到有些代码没写完，但是需紧急处理其他问题，若我们使用 Git，便可以创建本地分支存储没写完的代码，待问题处理完后，再回到本地分支继续完成代码。</p>
<h2 id="Git-基本概念"><a href="#Git-基本概念" class="headerlink" title="Git 基本概念"></a>Git 基本概念</h2><ul>
<li>版本库</li>
</ul>
<p>当你一个项目到本地或创建一个 git 项目，项目目录下会有一个隐藏的 .git 子目录。这个目录是 git 用来跟踪管理版本库的，千万不要手动修改。</p>
<ul>
<li>哈希值</li>
</ul>
<p>Git 中所有数据在存储前都计算校验和，然后以校验和来引用。这意味着不可能在 Git 不知情时更改任何文件内容或目录内容。这个功能建构在 Git 底层，是构成 Git 哲学不可或缺的部分。若你在传送过程中丢失信息或损坏文件，Git<br>就能发现。</p>
<p>Git 用以计算校验和的机制叫做 SHA-1 散列（hash，哈希）。这是一个由 40 个十六进制字符（0-9 和 a-f）组成字符串，基于 Git 中文件的内容或目录结构计算出来。SHA-1 哈希看起来是这样：</p>
<p>24b9da6552252987aa493b52f8696cd6d3b00373 Git 中使用这种哈希值的情况很多，你将经常看到这种哈希值。实际上，Git 数据库中保存的信息都是以文件内容的哈希值来索引，而不是文件名。</p>
<ul>
<li>文件状态</li>
</ul>
<p>在 GIt 中，你的文件可能会处于三种状态之一：</p>
<ul>
<li><p><strong>已修改（modified）</strong> - 已修改表示修改了文件，但还没保存到数据库中。</p>
</li>
<li><p><strong>已暂存（staged）</strong> - 已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。</p>
</li>
<li><p><strong>已提交（committed）</strong> - 已提交表示数据已经安全的保存在本地数据库中。</p>
</li>
<li><p>工作区域</p>
</li>
</ul>
<p>与文件状态对应的，不同状态的文件在 Git 中处于不同的工作区域。</p>
<ul>
<li><strong>工作区（working</strong>） - 当你 git clone 一个项目到本地，相当于在本地克隆了项目的一个副本。工作区是对项目的某个版本独立提取出来的内容。这些从 Git 仓库的压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。</li>
<li><strong>暂存区（staging）</strong>- 暂存区是一个文件，保存了下次将提交的文件列表信息，一般在 Git 仓库目录中。有时候也被称作 &#96;‘索引’’，不过一般说法还是叫暂存区。</li>
<li><strong>本地仓库（local）</strong> - 提交更新，找到暂存区域的文件，将快照永久性存储到 Git 本地仓库。</li>
<li><strong>远程仓库（remote）</strong> - 以上几个工作区都是在本地。为了让别人可以看到你的修改，你需要将你的更新推送到远程仓库。同理，如果你想同步别人的修改，你需要从远程仓库拉取更新。</li>
</ul>
<p><img src="https://static001.geekbang.org/infoq/cd/cdefe604f19c6f3b4e8b484a5d7eb4ea.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
  </entry>
  <entry>
    <title>Linux1</title>
    <url>/2023/04/19/linux1/</url>
    <content><![CDATA[<h1 id="linux安装"><a href="#linux安装" class="headerlink" title="linux安装"></a>linux安装</h1><p>第一章<br>硬件和软件<br>硬件：计算机系统中由电子，机械和光电元件等组成的各种物理装置的总称。</p>
<p>软件：是用户和计算机硬件之间的接口和桥梁，用户通过软件与计算机进行交流。而操作系统，就是软件的一类。</p>
<p>操作系统<br>操作系统可分为：个人桌面操作系统（win11和macOS）和服务器操作系统(Linux)。</p>
<p>操作系统是计算机软件的一种，它主要负责：</p>
<p>作为用户和计算机硬件之间的桥梁，调度和管理计算机硬件进行工作。</p>
<p>操作系统可以：</p>
<p>•调度CPU进行工作</p>
<p>•调度内存进行工作</p>
<p>•调度硬盘进行数据存储</p>
<p>•调度键盘进行文字输入</p>
<p>•调度显示屏显示内容</p>
<p>•调度网卡进行网络通讯</p>
<p>•调度音响发出声音</p>
<p>•调度打印机打印内容 …</p>
<p>Q%S：常见的操作系统有哪些？</p>
<p>PC端：Windows、Linux、MacOS</p>
<p>移动端：Android、IOS、鸿蒙系统</p>
<p>Linux的诞生<br>Linux创始人: 林纳斯 托瓦兹</p>
<p>Linux 诞生于1991年，作者上大学期间</p>
<p>因为创始人在上大学期间经常需要浏览新闻和处理邮件，发现现有的操作系统不好用, 于是他决心自己写一个保护模式下的操作系统，这就是Linux的原型， 当时他21岁，后来经过全世界网友的支持, 现在能够兼容多种硬件，成为最为流行的服务器操作系统之一。</p>
<p>Linux内核<br>Linux系统的组成如下：</p>
<p>•Linux系统内核</p>
<p>•系统级应用程序 两部分组成。</p>
<p>•内核提供系统最核心的功能，如：调度CPU、调度内存、调度文件系统、调度网络通讯、调度IO等。</p>
<p>•系统级应用程序，可以理解为出厂自带程序，可供用户快速上手操作系统，如：文件管理器、任务管理器、图片查看、音乐播放等。</p>
<p>•比如，播放音乐，无论用户使用自带音乐播放器或是自行安装的第三方播放器均是由播放器程序，调用内核提供的相关功能，由内核调度CPU解码、音响发声等</p>
<p>Linux发行版<br>内核是免费、开源的，这也就代表了：</p>
<p>•任何人都可以获得并修改内核，并且自行集成系统级程序</p>
<p>提供了内核+系统级程序的完整封装，称之为Linux发行版</p>
<p>任何人都可以封装Linux，目前市面上由非常多的Linux发行版，常用的、知名的如下：</p>
<p>不论用什么发行版，都是Linux，学到的东西都是通用的。</p>
<p>虚拟机</p>
<p>借助虚拟化技术，我们可以在系统中：通过虚拟化的软件——模拟计算机硬件——并给虚拟硬件安装真实的操作系统。</p>
<p>这样，就可以在电脑中，虚拟出一个完整的电脑，以供我们学习Linux系统。</p>
<p>图形化、命令行<br>对于操作系统的使用，有2种使用形式：</p>
<p>•图形化页面使用操作系统</p>
<p>•以命令的形式使用操作系统</p>
<p>不论是Windows还是Linux亦或是MacOS系统，都是支持这两种使用形式。</p>
<p>•图形化：使用操作系统提供的图形化页面，以获得图形化反馈的形式去使用操作系统。</p>
<p>•命令行：使用操作系统提供的各类命令，以获得字符反馈的形式去使用操作系统。</p>
<p>•Linux操作系统的图形化页面不好用且不稳定</p>
<p>•使用命令行的形式操作更加高效且稳定资源占用低</p>
<p>企业和开发者都选择命令行，所以我们也学习命令行</p>
<p>FinalShell<br>如何查看Linux的IP地址并远程连接：</p>
<p>•在Linux操作系统中，桌面空白右键点击：open in terminal</p>
<p>•输入 ifconfig ，即可看到IP地址</p>
<p>•在FinalShell中配置好IP地址，账号密码后即可连接成功</p>
<p>WSL（Windows Subsystem for Linux）<br>这部分作为扩展，暂不提及。</p>
<p>虚拟机快照<br>在学习阶段我们无法避免的可能损坏Linux操作系统。</p>
<p>如果损坏的话，重新安装一个Linux操作系统就会十分麻烦。</p>
<p>VMware虚拟机（Workstation和Funsion）支持为虚拟机制作快照。</p>
<p>通过快照将当前虚拟机的状态保存下来，在以后可以通过快照恢复虚拟机到保存的状态。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>自动装配的原理</title>
    <url>/2023/04/06/spring%20boot%20web%E5%BC%80%E5%8F%91/</url>
    <content><![CDATA[<p>自动配置的精髓：</p>
<ol>
<li>spring boot启动会加载大量的自动配置类</li>
<li>我们看我们需要的功能有没有在springboot默认写好的自动配置类</li>
<li>只要我们要用的配置类在其中，就不需要手动配置了</li>
<li>给容器中自动配置类添加组件时，会从properites类中获取某些元素，我们只需要在配置文件中指定所给这些属性的值</li>
<li>xxxxAutoCOnfiguration : 自动配置类</li>
<li>xxxxProperities: 封装配置文件中的相关属性。</li>
</ol>
<h1 id="spring-boot-web开发"><a href="#spring-boot-web开发" class="headerlink" title="spring boot web开发"></a>spring boot web开发</h1><p>jar：webapp！</p>
<p>自动装配：</p>
<blockquote>
<p>spring boot到底帮我配置了什么？能不能修改和扩展</p>
<ol>
<li>xxxxAutoCOnfiguration : 自动配置类</li>
<li>xxxxProperities: 封装配置文件中的相关属性。</li>
</ol>
</blockquote>
<ol>
<li>创建应用，选择模版</li>
<li>面向过程</li>
</ol>
<p>要解决的问题：</p>
<ul>
<li>导入静态资源</li>
<li>首页</li>
<li>jsp，模版引擎 Thymleaf</li>
<li>装配扩展SpringMVC</li>
<li>增删改查</li>
<li>拦截器</li>
<li>国际化！</li>
</ul>
<h2 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">        logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    addResourceHandler(registry, <span class="string">&quot;/webjars/**&quot;</span>, <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getStaticPathPattern(), (registration) -&gt; &#123;</span><br><span class="line">        registration.addResourceLocations(<span class="built_in">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.servletContext != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ServletContextResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextResource</span>(<span class="built_in">this</span>.servletContext, SERVLET_LOCATION);</span><br><span class="line">            registration.addResourceLocations(resource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>什么是webjars’:<br>WebJars是将web前端资源（js，css等）打成jar包文件，然后借助Maven工具，以jar包形式对web前端资源进行统一依赖管理，保证这些Web资源版本唯一性。WebJars的jar包部署在Maven中央仓库上。</p>
<p>拿到静态资源的第一种方式</p>
<blockquote>
<p><a href="http://localhost:8080/webjars/github-com-jquery-jquery/3.4.1/jquery.js">http://localhost:8080/webjars/github-com-jquery-jquery/3.4.1/jquery.js</a></p>
</blockquote>
<p>使用&#x2F;**&#x2F;static或者&#x2F;resources或者&#x2F;public来访问静态资源</p>
<blockquote>
<p>localhost：8080&#x2F;**&#x2F;</p>
</blockquote>
<blockquote>
<p>优先级：resources&gt;static（默认）&gt;puiblic</p>
</blockquote>
<p>很少使用webjars</p>
<p>为什么在chrome浏览器按 ctrl + F5 就能生效呢？</p>
<blockquote>
<p>当你的项目从没有favicon.ico图标文件到有favicon.ico图标后的状态下，在浏览器中按 F5 刷新后，在缓存的机制下，它并不会去请求服务器去下载这个favicon.ico文件（即便你设置了静态资源的热部署），所以这个图标自然无法显示在浏览器上；那么按 ctrl + F5 之后，会强制浏览器重新去服务器下载静态资源，所以就会把新加载到项目的favicon.ico文件下载下来，那么浏览器自然而然就能显示这个图标了！</p>
</blockquote>
]]></content>
      <categories>
        <category>spring boot</category>
      </categories>
  </entry>
  <entry>
    <title>interview_day1</title>
    <url>/2023/05/11/interview-day1/</url>
    <content><![CDATA[<ol>
<li><p>面向对象的特点</p>
<p>封装：将对象的属性和方法封装到一个整体，并尽可能的隐藏内部实现的细节，将不想告诉不能告诉的东西隐藏起来，将可以告诉的公开，别人在调用对象时只能使用公开的部分，无法了解是否实现的。</p>
<p>继承：就是子类继承父类的属性和方法，同时针对自己的需求扩展出新的东西。提高代码的复用率</p>
<p>多态：针对不同的对象，对于同一消息有不同的实现方式。指允许不同的对象对同一消息做出相应。发送消息就是函数复用。</p>
<p>抽象：表示对问题领域进行分析，设计中得出的抽象的概念。是指一系列看上去不同的，但本质相同的具体概念的抽象。</p>
</li>
<li><p>java的基本类型</p>
<p><img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230511112841857.png" alt="image-20230511112841857"></p>
</li>
<li><p>JDK JRE jvm的区别</p>
<p><img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230511112938065.png" alt="image-20230511112938065"></p>
<p>jdk：是整个java的核心，是java开发的工具包。包括java运行环境jre，jav基础类库。</p>
<p>jre：是java运行时所必须环境的组合，包含java运行的虚拟机和java程序的核心类库</p>
<p>jvm（java虚拟机）：是java实现跨平台的关键，能够运行java语言写作的软件程序。</p>
</li>
<li><p>重载和重写的区别</p>
<p>重载：是指在同一个类中，方法名必须相同，参数类型，参数个数，顺序不同，方法返回可以不同。</p>
<p>重写：是指子类在继承父类方法时，对其进行修改，方法名，参数必须相同，返回值范围小于等于父类，抛出的异常范围小于等于父类， 访问修饰符范围大于等于父类；如果父类方法访问修饰符为 private 则子类就不能 重写该方法</p>
</li>
<li><p>Java 中&#x3D;&#x3D;和 equals 的区别（必会）</p>
<p>&#x3D;&#x3D;比较两个对象在内存里是不是同一个对象，就是说在内存里的存储位置一致。两个String对象存储的值是一样的，但有可能在内存里存储在不同的地方 。</p>
<p>&#x3D;&#x3D;比较的是引用而equals方法比较的是内容。public boolean equals(Object obj) 这个方法是由Object对象提供的，可以由子类进行重写。默认的实现只有当对象和自身进行比较时才会返回true,这个时候和&#x3D;&#x3D;是等价的。String, BitSet, Date, 和File都对equals方法进行了重写，对两个String对象 而言，值相等意味着它们包含同样的字符序列。对于基本类型的包装类来说，值相等意味着对应的基本类型的值一样。</p>
<p>&#x3D;&#x3D; 的作用： </p>
<p>基本类型：比较的就是值是否相同 （基本数据类型的变量是存放在栈里面的）</p>
<p>引用类型：比较的就是地址值是否相同</p>
<p>equals的作用：</p>
<p>引用类型：默认情况下，比较的是地址值。 特：String、Integer、Date 这些类库中 equals 被重写，比较的是内容而不是地址！</p>
<p><strong>面试题：请解释字符串比较之中 “ &#x3D;&#x3D; ” 和 equals() 的区别？</strong></p>
<p> 答： &#x3D;&#x3D;：比较的是两个字符串内存地址（堆内存）的数值是否相等，属于数值比较； equals()：比较的是两个字符串的内容，属于内容比较</p>
</li>
<li><p>String StringBuilder，StringBuffer 三者之间的区别</p>
<p>String存储的是不可变的对象，也就是常量，是线程安全。</p>
<p>String Builder存储的也是字符串常量，但是集成了string类的诸多方法，同时是非线程安全的</p>
<p>StringBuffer加了同步锁，是线程安全的。</p>
</li>
<li><p>接口和抽象类的区别：</p>
<p>在实现方式上讲，接口实现类需要通过implements,抽象类是用extends</p>
<p>在方法上，抽象类可以有构造函数main函数，借口不能有。</p>
<p>在实现上，只能继承一个抽象类，但是可以继承多个接口。</p>
<p>访问修饰符，接口默认pubic，抽象类可以是任意的。</p>
</li>
<li><p>什么是单例模式，有几种</p>
<ol>
<li>饿汉模式，线程安全，一开始就初始化</li>
<li>懒汉模式  非线程安全，延迟初始化</li>
<li>双检索 线程安全 ，延迟初始化</li>
</ol>
</li>
<li><h4 id="amp-和-amp-amp-的区别？"><a href="#amp-和-amp-amp-的区别？" class="headerlink" title="&amp;和&amp;&amp;的区别？"></a><strong>&amp;和&amp;&amp;的区别？</strong></h4><ol>
<li>&amp;：(1)按位与；(2)逻辑与。</li>
</ol>
<p>按位与: 0 &amp; 1 &#x3D; 0 ; 0 &amp; 0 &#x3D; 0; 1 &amp; 1 &#x3D; 1</p>
<p>逻辑与: a &#x3D;&#x3D; b &amp; b &#x3D;&#x3D;c （即使a&#x3D;&#x3D;b已经是 false了，程序还会继续判断b是否等于c)</p>
<p>2.&amp;&amp;: 短路与</p>
<p> a&#x3D;&#x3D; b &amp;&amp; b&#x3D;&#x3D; c （当a&#x3D;&#x3D;b 为false则不会继续判断b是否等与c)</p>
<p>比如判断某对象中的属性是否等于某值，则必须用&amp;&amp;,否则会出现空指针问题。</p>
</li>
<li><p>反射</p>
<p>在java中是指在运行环境中，一个任意类都知道这类所有的属性和方法；并且对其任意的一个对象，都可以调用他的任意方法；</p>
</li>
<li><p>java8的新特性</p>
<ol>
<li>lambda表达式：可以将方法作为参数传递到一个对象</li>
<li>方法引用： 直接引用java类中对象的方法或者构造方法</li>
<li>StreamApi  处理元素集看作流，接着在管道的结点上进行处理，比如筛选，去重等</li>
<li>接口允许定义默认方法和静态方法。</li>
<li>日期时间类的改进</li>
<li>内置了Base64编码器。</li>
</ol>
</li>
<li><h4 id="深拷贝和浅拷贝的区别是什么"><a href="#深拷贝和浅拷贝的区别是什么" class="headerlink" title="深拷贝和浅拷贝的区别是什么?"></a>深拷贝和浅拷贝的区别是什么?</h4><p>浅拷贝</p>
<p><strong>（1）、定义</strong></p>
<p>被复制对象的所有变量都含有与原来的对象相同的值，而所有的对其他对象的引用仍然指向原来的对象。即对象的浅拷贝会对“主”对象进行拷贝，但不会复制主对象里面的对象。”里面的对象“会在原来的对象和它的副本之间共享。</p>
<p>简而言之，浅拷贝仅仅复制所考虑的对象，而不复制它所引用的对象 <strong>（2）、浅拷贝实例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">package com.test;</span><br><span class="line"></span><br><span class="line">public class ShallowCopy &#123;</span><br><span class="line">    public static void main(String[] args) throws CloneNotSupportedException &#123;</span><br><span class="line">        Teacher teacher = new Teacher();</span><br><span class="line">        teacher.setName(&quot;riemann&quot;);</span><br><span class="line">        teacher.setAge(27);</span><br><span class="line"></span><br><span class="line">        Student2 student1 = new Student2();</span><br><span class="line">        student1.setName(&quot;edgar&quot;);</span><br><span class="line">        student1.setAge(18);</span><br><span class="line">        student1.setTeacher(teacher);</span><br><span class="line"></span><br><span class="line">        Student2 student2 = (Student2) student1.clone();</span><br><span class="line">        System.out.println(&quot;拷贝后&quot;);</span><br><span class="line">        System.out.println(student2.getName());</span><br><span class="line">        System.out.println(student2.getAge());</span><br><span class="line">        System.out.println(student2.getTeacher().getName());</span><br><span class="line">        System.out.println(student2.getTeacher().getAge());</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;修改老师的信息后——————&quot;);</span><br><span class="line">        // 修改老师的信息</span><br><span class="line">        teacher.setName(&quot;Games&quot;);</span><br><span class="line">        System.out.println(student1.getTeacher().getName());</span><br><span class="line">        System.out.println(student2.getTeacher().getName());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Teacher implements Cloneable &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Student2 implements Cloneable &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    private Teacher teacher;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Teacher getTeacher() &#123;</span><br><span class="line">        return teacher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setTeacher(Teacher teacher) &#123;</span><br><span class="line">        this.teacher = teacher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">        Object object = super.clone();</span><br><span class="line">        return object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>输出结果:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">拷贝后</span><br><span class="line">edgar</span><br><span class="line">18</span><br><span class="line">riemann</span><br><span class="line">27</span><br><span class="line">修改老师的信息后——————</span><br><span class="line">Games</span><br><span class="line">Games</span><br></pre></td></tr></table></figure>



<p>结果分析： 两个引用student1和student2指向不同的两个对象，但是两个引用student1和student2中的两个teacher引用指向的是同一个对象，所以说明是浅拷贝。</p>
<p><a href="https://camo.githubusercontent.com/2c726e60d94f9108328fd062b0a8a859afe2c28bd0c995a45fee8b3bcf6ff192/68747470733a2f2f67697465652e636f6d2f79697a6869627565726461692f496d616765746f6f6c732f7261772f6d61737465722f696d616765732f696d6167652d32303230303431333231303931303634392e706e67"><img src="https://camo.githubusercontent.com/2c726e60d94f9108328fd062b0a8a859afe2c28bd0c995a45fee8b3bcf6ff192/68747470733a2f2f67697465652e636f6d2f79697a6869627565726461692f496d616765746f6f6c732f7261772f6d61737465722f696d616765732f696d6167652d32303230303431333231303931303634392e706e67" alt="image-20200413210910649"></a></p>
<p>深拷贝</p>
<p><strong>（1）、定义</strong></p>
<p>深拷贝是一个整个独立的对象拷贝，深拷贝会拷贝所有的属性,并拷贝属性指向的动态分配的内存。当对象和它所引用的对象一起拷贝时即发生深拷贝。深拷贝相比于浅拷贝速度较慢并且花销较大。</p>
<p>简而言之，深拷贝把要复制的对象所引用的对象都复制了一遍。</p>
<p><strong>（2）、深拷贝实例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">package com.test;</span><br><span class="line"></span><br><span class="line">public class DeepCopy &#123;</span><br><span class="line">    public static void main(String[] args) throws CloneNotSupportedException &#123;</span><br><span class="line">        Teacher2 teacher = new Teacher2();</span><br><span class="line">        teacher.setName(&quot;riemann&quot;);</span><br><span class="line">        teacher.setAge(27);</span><br><span class="line"></span><br><span class="line">        Student3 student1 = new Student3();</span><br><span class="line">        student1.setName(&quot;edgar&quot;);</span><br><span class="line">        student1.setAge(18);</span><br><span class="line">        student1.setTeacher(teacher);</span><br><span class="line"></span><br><span class="line">        Student3 student2 = (Student3) student1.clone();</span><br><span class="line">        System.out.println(&quot;拷贝后&quot;);</span><br><span class="line">        System.out.println(student2.getName());</span><br><span class="line">        System.out.println(student2.getAge());</span><br><span class="line">        System.out.println(student2.getTeacher().getName());</span><br><span class="line">        System.out.println(student2.getTeacher().getAge());</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;修改老师的信息后——————&quot;);</span><br><span class="line">        // 修改老师的信息</span><br><span class="line">        teacher.setName(&quot;Games&quot;);</span><br><span class="line">        System.out.println(student1.getTeacher().getName());</span><br><span class="line">        System.out.println(student2.getTeacher().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Teacher2 implements Cloneable &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">        return super.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Student3 implements Cloneable &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    private Teacher2 teacher;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Teacher2 getTeacher() &#123;</span><br><span class="line">        return teacher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setTeacher(Teacher2 teacher) &#123;</span><br><span class="line">        this.teacher = teacher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">        // 浅复制时：</span><br><span class="line">        // Object object = super.clone();</span><br><span class="line">        // return object;</span><br><span class="line"></span><br><span class="line">        // 改为深复制：</span><br><span class="line">        Student3 student = (Student3) super.clone();</span><br><span class="line">        // 本来是浅复制，现在将Teacher对象复制一份并重新set进来</span><br><span class="line">        student.setTeacher((Teacher2) student.getTeacher().clone());</span><br><span class="line">        return student;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">拷贝后</span><br><span class="line">edgar</span><br><span class="line">18</span><br><span class="line">riemann</span><br><span class="line">27</span><br><span class="line">修改老师的信息后——————</span><br><span class="line">Games</span><br><span class="line">riemann</span><br></pre></td></tr></table></figure>



<p>结果分析： 两个引用student1和student2指向不同的两个对象，两个引用student1和student2中的两个teacher引用指向的是两个对象，但对teacher对象的修改只能影响student1对象,所以说是深拷贝。</p>
<p><a href="https://camo.githubusercontent.com/ccc7b8ce5b54b1c8ca7511b7d07cb556c2d4eeed5dc4f8b804137908dd1a3047/68747470733a2f2f67697465652e636f6d2f79697a6869627565726461692f496d616765746f6f6c732f7261772f6d61737465722f696d616765732f696d6167652d32303230303431333231313232383833322e706e67"><img src="https://camo.githubusercontent.com/ccc7b8ce5b54b1c8ca7511b7d07cb556c2d4eeed5dc4f8b804137908dd1a3047/68747470733a2f2f67697465652e636f6d2f79697a6869627565726461692f496d616765746f6f6c732f7261772f6d61737465722f696d616765732f696d6167652d32303230303431333231313232383833322e706e67" alt="image-20200413211228832"></a></p>
</li>
<li><p>基本类型和引用类型</p>
<p><img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230516201102214.png" alt="image-20230516201102214"></p>
</li>
<li><h4 id="重载（Overload）和重写（Override）的区别。重载的方法能否根据返回类型进行区分？"><a href="#重载（Overload）和重写（Override）的区别。重载的方法能否根据返回类型进行区分？" class="headerlink" title="重载（Overload）和重写（Override）的区别。重载的方法能否根据返回类型进行区分？"></a>重载（Overload）和重写（Override）的区别。重载的方法能否根据返回类型进行区分？</h4><p>方法的重载和重写都是实现多态的方式，区别在于前者实现的是编译时的多态性，而后者实现的是运行时的多态性。重载发生在一个类中，同名的方法如果有不同的参数列表（参数类型不同、参数个数不同或者二者都不同）则视为重载；重写发生在子类与父类之间，重写要求子类被重写方法与父类被重写方法有相同的参数列表，有兼容的返回类型，比父类被重写方法更好访问，不能比父类被重写方法声明更多的异常（里氏代换原则）。重载对返回类型没有特殊的要求，不能根据返回类型进行区分。</p>
</li>
<li><h4 id="Java的四种引用"><a href="#Java的四种引用" class="headerlink" title="Java的四种引用"></a>Java的四种引用</h4><p><strong>1、强引用</strong></p>
<p>最普遍的一种引用方式，如String s &#x3D; “abc”，变量s就是字符串“abc”的强引用，只要强引用存在，则垃圾回收器就不会回收这个对象。</p>
<p><strong>2、软引用（SoftReference）</strong></p>
<p>用于描述还有用但非必须的对象，如果内存足够，不回收，如果内存不足，则回收。一般用于实现内存敏感的高速缓存，软引用可以和引用队列ReferenceQueue联合使用，如果软引用的对象被垃圾回收，JVM就会把这个软引用加入到与之关联的引用队列中。</p>
<p><strong>3、弱引用（WeakReference）</strong></p>
<p>弱引用和软引用大致相同，弱引用与软引用的区别在于：只具有弱引用的对象拥有更短暂的生命周期。在垃圾回收器线程扫描它所管辖的内存区域的过程中，一旦发现了只具有弱引用的对象，不管当前内存空间足够与否，都会回收它的内存。</p>
<p><strong>4、虚引用（PhantomReference）</strong></p>
<p>就是形同虚设，与其他几种引用都不同，虚引用并不会决定对象的生命周期。如果一个对象仅持有虚引用，那么它就和没有任何引用一样，在任何时候都可能被垃圾回收器回收。 虚引用主要用来跟踪对象被垃圾回收器回收的活动。</p>
</li>
<li><h4 id="Java-序列化-反序列化"><a href="#Java-序列化-反序列化" class="headerlink" title="Java 序列化,反序列化?"></a>Java 序列化,反序列化?</h4><p>Java 序列化就是指将对象转换为字节序列的过程，反序列化是指将字节序列转换成目标对象的过程。</p>
</li>
<li><h4 id="什么情况需要Java序列化"><a href="#什么情况需要Java序列化" class="headerlink" title="什么情况需要Java序列化?"></a>什么情况需要Java序列化?</h4><p>当 Java 对象需要在网络上传输 或者 持久化存储到文件中时。</p>
</li>
<li><h4 id="序列化的实现"><a href="#序列化的实现" class="headerlink" title=".序列化的实现?"></a>.序列化的实现?</h4><p>让类实现Serializable接口,标注该类对象是可被序列。</p>
</li>
<li><h4 id="如果某些数据不想序列化，如何处理"><a href="#如果某些数据不想序列化，如何处理" class="headerlink" title="如果某些数据不想序列化，如何处理?"></a>如果某些数据不想序列化，如何处理?</h4><p>在字段面前加 transient 关键字</p>
</li>
<li><p>BIO,NIO,AIO的区别</p>
<p>BIO：同步阻塞式</p>
<ol>
<li>服务器端在监听客户端连接时(serverSocket.accept())，服务器端处于阻塞状态，不能处理其他事务</li>
<li>服务器端需要为每个客户端建立一个线程，虽然可以用线程池来优化，但在并发较大时，线程开销依旧很大</li>
<li>当连接的客户端没有发送数据时，服务器端会阻塞在read操作上，等待客户端输入，造成线程资源浪费</li>
</ol>
<p>NIO：同步非阻塞</p>
<p>​        NIO是面向缓冲区, 或者说是面向块编程的。在NIO的IO传输中，数据会先读入到缓冲区，当需要时再从缓冲区写出，这样减少了直接读写磁盘的次数，提高了IO传输的效率。</p>
<p>缓冲区(buffer)本质上是一个可以读写数据的内存块，即在内存空间中预留了一定的存储空间，这些存储空间用来缓冲输入和输出的数据，这部分预留的存储空间就叫缓冲区。</p>
<p>在NIO程序中，通道channel虽然负责数据的传输，但是输入和输出的数据都必须经过缓冲区buffer。</p>
<p>AIO： 基于回调的非阻塞</p>
</li>
<li><p>synoronize底层实现同步</p>
<p>都是面向对象的语言，都支持封装、继承和多态</p>
<p>Java 不提供指针来直接访问内存，程序内存更加安全</p>
<p>Java 的类是单继承的，C++ 支持多重继承；虽然 Java 的类不可以多继承，但是接口可以多继承。</p>
<p>Java 有自动内存管理机制，不需要程序员手动释放无用内存</p>
</li>
<li><h4 id="Java和C-的区别"><a href="#Java和C-的区别" class="headerlink" title="Java和C++的区别?"></a>Java和C++的区别?</h4><p>Java 不提供指针来直接访问内存，程序内存更加安全</p>
<p>Java 的类是单继承的，C++ 支持多重继承；虽然 Java 的类不可以多继承，但是接口可以多继承。</p>
<p>Java 有自动内存管理机制，不需要程序员手动释放无用内存</p>
</li>
<li><h4 id="请问EJB与JAVA-BEAN的区别是什么？"><a href="#请问EJB与JAVA-BEAN的区别是什么？" class="headerlink" title="请问EJB与JAVA BEAN的区别是什么？"></a>请问EJB与JAVA BEAN的区别是什么？</h4><p>Java Bean 是可复用的组件，对Java Bean并没有严格的规范，理论上讲，任何一个Java类都可以是一个Bean。但通常情况下，由于Java Bean是被容器所创建（如Tomcat）的，所以Java Bean应具有一个无参的构造器，另外，通常Java Bean还要实现Serializable接口用于实现Bean的持久性。Java Bean实际上相当于微软COM模型中的本地进程内COM组件，它是不能被跨进程访问的。EnterpriseJava Bean 相当于DCOM，即分布式组件。它是基于Java的远程方法调用（RMI）技术的，所以EJB可以被远程访问（跨进程、跨计算机）。但EJB必须被布署在诸如Webspere、WebLogic这样的容器中，EJB客户从不直接访问真正的EJB组件，而是通过其容器访问。EJB容器是EJB组件的代理， EJB组件由容器所创建和管理。客户通过容器来访问真正的EJB组件。</p>
</li>
<li><h4 id="请你谈谈Java中是如何支持正则表达式操作的？"><a href="#请你谈谈Java中是如何支持正则表达式操作的？" class="headerlink" title="请你谈谈Java中是如何支持正则表达式操作的？"></a>请你谈谈Java中是如何支持正则表达式操作的？</h4><p>Java中的String类提供了支持正则表达式操作的方法，包括：matches()、replaceAll()、replaceFirst()、split()。此外，Java中可以用Pattern类表示正则表达式对象，它提供了丰富的API进行各种正则表达式操作，如：</p>
</li>
<li><h4 id="在Java中如何跳出当前的多重嵌套循环？"><a href="#在Java中如何跳出当前的多重嵌套循环？" class="headerlink" title="在Java中如何跳出当前的多重嵌套循环？"></a>在Java中如何跳出当前的多重嵌套循环？</h4><p>在最外层循环前加一个标记如A，然后用break A;可以跳出多重循环。</p>
</li>
<li><h4 id="什么是-JavaConfig？"><a href="#什么是-JavaConfig？" class="headerlink" title="什么是 JavaConfig？"></a>什么是 JavaConfig？</h4><p>（1）面向对象的配置。由于配置被定义为 JavaConfig 中的类，因此用户可以充分利用 Java 中的面向对象功能。一个配置类可以继承另一个，重写它的@Bean 方法等。</p>
<p>（2）减少或消除 XML 配置。基于依赖注入原则的外化配置的好处已被证明。但是，许多开发人员不希望在 XML 和 Java 之间来回切换。JavaConfig 为开发人员提供了一种纯 Java 方法来配置与 XML 配置概念相似的 Spring 容器。从技术角度来讲，只使用 JavaConfig 配置类来配置容器是可行的，但实际上很多人认为将JavaConfig 与 XML 混合匹配是理想的。</p>
<p>（3）类型安全和重构友好。JavaConfig 提供了一种类型安全的方法来配置 Spring容器。由于 Java 5.0 对泛型的支持，现在可以按类型而不是按名称检索 bean，不需要任何强制转换或基于字符串的查找。</p>
</li>
<li><h4 id="什么是进程"><a href="#什么是进程" class="headerlink" title="什么是进程?"></a><strong>什么是进程</strong>?</h4><p>进程是系统中正在运行的一个程序，程序一旦运行就是进程。</p>
<p>进程可以看成程序执行的一个实例。进程是系统资源分配的独立实体，每个进程都拥有独立的地址空间。一个进程无法访问另一个进程的变量和数据结构，如果想让一个进程访问另一个进程的资源，需要使用进程间通信，比如管道，文件，套接字等。</p>
</li>
<li><h4 id="什么是线程？"><a href="#什么是线程？" class="headerlink" title="什么是线程？"></a>什么是线程？</h4><p>是操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中的实际运作单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务</p>
</li>
<li><h4 id="线程的实现方式"><a href="#线程的实现方式" class="headerlink" title="线程的实现方式?"></a>线程的实现方式?</h4><p>1.继承Thread类</p>
<p>2.实现Runnable接口</p>
<p>3.使用Callable和Future</p>
</li>
<li><h4 id="Thread-类中的start-和-run-方法有什么区别"><a href="#Thread-类中的start-和-run-方法有什么区别" class="headerlink" title="Thread 类中的start() 和 run() 方法有什么区别?"></a><strong>Thread 类中的start() 和 run() 方法有什么区别</strong>?</h4><p>1.start（）方法来启动线程，真正实现了多线程运行。这时无需等待run方法体代码执行完毕，可以直接继续执行下面的代码；通过调用Thread类的start()方法来启动一个线程， 这时此线程是处于就绪状态， 并没有运行。 然后通过此Thread类调用方法run()来完成其运行操作的， 这里方法run()称为线程体，它包含了要执行的这个线程的内容， Run方法运行结束， 此线程终止。然后CPU再调度其它线程。 2.run（）方法当作普通方法的方式调用。程序还是要顺序执行，要等待run方法体执行完毕后，才可继续执行下面的代码； 程序中只有主线程——这一个线程， 其程序执行路径还是只有一条， 这样就没有达到写线程的目的。</p>
</li>
<li><h4 id="线程NEW状态"><a href="#线程NEW状态" class="headerlink" title="线程NEW状态"></a>线程NEW状态</h4><p>new创建一个Thread对象时，并没处于执行状态，因为没有调用start方法启动改线程，那么此时的状态就是新建状态。</p>
</li>
<li><h4 id="线程RUNNABLE状态"><a href="#线程RUNNABLE状态" class="headerlink" title="线程RUNNABLE状态"></a>线程RUNNABLE状态</h4><p>线程对象通过start方法进入runnable状态，启动的线程不一定会立即得到执行，线程的运行与否要看cpu的调度，我们把这个中间状态叫可执行状态（RUNNABLE)。</p>
</li>
<li><h4 id="线程的BLOCKED状态"><a href="#线程的BLOCKED状态" class="headerlink" title="线程的BLOCKED状态"></a>线程的BLOCKED状态</h4><p>线程正在等待获取锁。</p>
<ul>
<li>进入BLOCKED状态，比如调用了sleep,或者wait方法</li>
<li>进行某个阻塞的io操作，比如因网络数据的读写进入BLOCKED状态</li>
<li>获取某个锁资源，从而加入到该锁的阻塞队列中而进入BLOCKED状态</li>
</ul>
</li>
<li><p><img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230516204238724.png" alt="image-20230516204238724"></p>
</li>
<li><h4 id="守护线程的特点"><a href="#守护线程的特点" class="headerlink" title="守护线程的特点"></a>守护线程的特点</h4><p>守护线程是一个比较特殊的线程，主要被用做程序中后台调度以及支持性工作。当Java虚拟机中不存在非守护线程时，守护线程才会随着JVM一同结束工作。</p>
</li>
<li><h4 id="join"><a href="#join" class="headerlink" title=".join"></a>.join</h4><p>join是指把指定的线程加入到当前线程，比如join某个线程a,会让当前线程b进入等待,直到a的生命周期结束，此期间b线程是处于blocked状态。</p>
</li>
<li><h4 id="什么是synchronized"><a href="#什么是synchronized" class="headerlink" title="什么是synchronized?"></a>什么是synchronized?</h4><p>synchronized关键字可以时间一个简单的策略来防止线程干扰和内存一致性错误，如果一个对象是对多个线程可见的，那么对该对想的所有读写都将通过同步的方式来进行。</p>
</li>
<li><h4 id="synchronized锁的是什么"><a href="#synchronized锁的是什么" class="headerlink" title="synchronized锁的是什么?"></a>synchronized锁的是什么?</h4><p>普通同步方法 —————&gt; 锁的是当前实力对象。</p>
<p>静态同步方法—————&gt; 锁的是当前类的Class对象。</p>
<p>同步方法快 —————&gt; 锁的是synchonized括号里配置的对象。</p>
</li>
<li><h4 id="volatile关键字"><a href="#volatile关键字" class="headerlink" title="volatile关键字"></a>volatile关键字</h4><p>volatile 是轻量级的synchronized,它在多处理器开发中保证了共享变量的“可见性“。</p>
<p>Java语言规范第3版对volatile定义如下，Java允许线程访问共享变量，为了保证共享变量能准确和一致的更新，线程应该确保排它锁单独获得这个变量。如果一个字段被声明为volatile,Java线程内存模型所有线程看到这个变量的值是一致的。</p>
</li>
<li><p>synchronized和voliatile的区别</p>
<p>v的本质是告诉变量在寄存器中是不确定的，需要从主存中读取。</p>
<p>v仅能在变量级别使用，s可以使用在变量，方法，类</p>
<p>v不会造成线程的阻塞，s会</p>
<p>v只能保证变量的修改可见性，不能保证原子性。</p>
</li>
<li><p>synchronized 和 Lock 有什么区别？ </p>
<p>（高薪常问） 首先 synchronized 是 java 内置关键字，在 jvm 层面，Lock 是个 java 类； synchronized 无法判断是否获取锁的状态，Lock 可以判断是否获取到锁； synchronized 会自动释放锁(a 线程执行完同步代码会释放锁 ；b 线程执行过程中发 生异常会释放锁)，Lock 需在 finally 中手工释放锁（unlock()方法释放锁），否则容易造成 线程死锁； 用 synchronized 关键字的两个线程 1 和线程 2，如果当前线程 1 获得锁，线程 2 线程 等待。如果线程 1 阻塞，线程 2 则会一直等待下去，而 Lock 锁就不一定会等待下去，如果 尝试获取不到锁，线程可以不用一直等待就结束了； synchronized 的锁可重入、不可中断、非公平，而 Lock 锁可重入、可判断、可公平 （两者皆可）； Lock 锁适合大量同步的代码的同步问题，synchronized 锁适合代码少量的同步问题。</p>
</li>
</ol>
]]></content>
      <categories>
        <category>面试</category>
      </categories>
  </entry>
  <entry>
    <title>spring技术详解</title>
    <url>/2023/04/16/spring1/</url>
    <content><![CDATA[<h1 id="Spring核心技术详解-一"><a href="#Spring核心技术详解-一" class="headerlink" title="Spring核心技术详解(一)"></a>Spring核心技术详解(一)</h1><p><a href="https://www.zhihu.com/people/tobetopjavaer"><img src="https://picx.zhimg.com/v2-3d74e4bbe6676c63522dbf5e29b0f81a_l.jpg?source=32738c0c" alt="java架构师"></a></p>
<p><a href="https://www.zhihu.com/people/tobetopjavaer">java架构师</a></p>
<p>35 人赞同了该文章</p>
<h2 id="一、Sring简介"><a href="#一、Sring简介" class="headerlink" title="一、Sring简介"></a>一、Sring简介</h2><p>Spring是一个分层的Java SE&#x2F;EE应用一站式的<code>轻量级开源框架</code>。Spring核心是<code>IOC</code>和<code>AOP</code>。 Spring主要优点包括：</p>
<ul>
<li><strong>方便解耦，简化开发，通过Spring提供的IoC容器，我们可以将对象之间的依赖关系交由Spring进行控制，避免硬编码造成的程序耦合度高。</strong></li>
<li><strong>AOP编程的支持，通过Spring提供的AOP功能，方便进行面向切面编程。</strong></li>
<li><strong>声明式事务的支持，在Spring中，我们可以从单调烦闷的事务管理代码中解脱出来，通过声明式方式灵活地进行事务的管理，提高开发效率和质量。</strong></li>
<li><strong>方便程序的测试，可以用非容器依赖的编程方式进行几乎所有的测试工作。</strong></li>
<li><strong>方便集成各种优秀框架，Spring提供了对各种优秀框架的直接支持。</strong></li>
</ul>
<h2 id="二、Spring体系结构"><a href="#二、Spring体系结构" class="headerlink" title="二、Spring体系结构"></a>二、Spring体系结构</h2><p>如下图所示，整个spring框架按其所属功能可以划分为五个主要模块，这五个模块几乎为企业应用提供了所需的一切，从持久层、业务层到表现层都拥有相应的支持，这就是为什么称Spring是一站式框架的原因。</p>
<p><img src="https://pic4.zhimg.com/80/v2-9c65f4004a1ed6727faa9f024ce8ba6b_720w.webp" alt="img"></p>
<h3 id="核心模块-Core-Container"><a href="#核心模块-Core-Container" class="headerlink" title="核心模块(Core Container)"></a>核心模块(Core Container)</h3><p>Spring的核心模块实现了IoC的功能，它将类和类之间的依赖从代码中脱离出来，用配置的方式进行依赖关系描述。由IoC容器负责类的创建，管理，获取等。BeanFactory接口是Spring框架的核心接口，实现了容器很多核心的功能。</p>
<p>Context模块构建于核心模块之上，扩展了BeanFactory的功能，包括国际化，资源加载，邮件服务，任务调度等多项功能。ApplicationContext是Context模块的核心接口。</p>
<p>表达式语言(Expression Language)是统一表达式语言(EL)的一个扩展，支持设置和获取对象属性，调用对象方法，操作数组、集合等。使用它可以很方便的通过表达式和Spring IoC容器进行交互。</p>
<h3 id="AOP模块"><a href="#AOP模块" class="headerlink" title="AOP模块"></a>AOP模块</h3><p>Spring AOP模块提供了满足AOP Alliance规范的实现，还整合了AspectJ这种AOP语言级的框架。通过AOP能降低耦合。</p>
<h3 id="数据访问集成模块（Data-Access-x2F-Integration-）"><a href="#数据访问集成模块（Data-Access-x2F-Integration-）" class="headerlink" title="数据访问集成模块（Data Access&#x2F;Integration ）"></a>数据访问集成模块（Data Access&#x2F;Integration ）</h3><p>该模块包括了JDBC、ORM、OXM、JMS和事务管理：</p>
<ul>
<li>事务模块：该模块用于Spring管理事务，只要是Spring管理对象都能得到Spring管理事务的好处，无需在代码中进行事务控制了，而且支持编程和声明性的事务管理。</li>
<li>JDBC模块：提供了一个JBDC的样例模板，使用这些模板能消除传统冗长的JDBC编码还有必须的事务控制，而且能享受到Spring管理事务的好处。</li>
<li>ORM模块：提供与流行的“对象-关系”映射框架的无缝集成，包括hibernate、JPA、MyBatis等。而且可以使用Spring事务管理，无需额外控制事务。</li>
<li>OXM模块：提供了一个对Object&#x2F;XML映射实现，将Java对象映射成XML数据，或者将XML数据映射成java对象，Object&#x2F;XML映射实现包括JAXB、Castor、XMLBeans和XStream。</li>
<li>JMS模块：用于JMS(Java Messaging Service)，提供一套“消息生产者、消息消费者”模板用于更加简单的使用JMS，JMS用于在两个应用程序之间，或分布式系统中发送消息，进行异步通信。</li>
</ul>
<h3 id="Web模块"><a href="#Web模块" class="headerlink" title="Web模块"></a>Web模块</h3><p>该模块建立在ApplicationContext模块之上，提供了Web应用的功能，如文件上传、FreeMarker等。Spring可以整合Struts2等MVC框架。此外，Spring自己提供了MVC框架Spring MVC。</p>
<h3 id="测试模块"><a href="#测试模块" class="headerlink" title="测试模块"></a>测试模块</h3><p>Spring可以用非容器依赖的编程方式进行几乎所有的测试工作，支持JUnit和TestNG等测试框架。</p>
<h2 id="三、初识Ioc与DI"><a href="#三、初识Ioc与DI" class="headerlink" title="三、初识Ioc与DI"></a>三、初识Ioc与DI</h2><p>我们首先来讲解一下IoC的概念。IoC(控制反转:Inverse of Control)是Spring容器的核心，但是IoC这个概念却比较晦涩，让人不太容易望文生义。</p>
<h3 id="1、IoC控制反转和DI依赖注入"><a href="#1、IoC控制反转和DI依赖注入" class="headerlink" title="1、IoC控制反转和DI依赖注入"></a>1、IoC控制反转和DI依赖注入</h3><p>传统程序设计中，我们需要使用某个对象的方法，需要先通过new创建一个该对象，我们这时是主动行为；而IoC是我们将创建对象的控制权交给IoC容器，这时是由容器帮忙创建及注入依赖对象，我们的<code>程序被动的接受IoC容器创建的对象</code><br>，控制权反转，所以叫控制反转。</p>
<p>由于IoC确实不够开门见山，所以提出了DI（依赖注入：Dependency<br>Injection）的概念，即让第三方来实现注入，以移除我们类与需要使用的类之间的依赖关系。总的来说，IoC是目的，DI是手段，创建对象的过程往往意味着依赖的注入。我们为了实现IoC，让生成对象的方式由传统方式(new)<br>反转过来，需要创建相关对象时由IoC容器帮我们注入(DI)。</p>
<p>简单的说，就是我们类里需要另一个类，只需要让Spring帮我们创建 ，这叫做<code>控制反转</code>；然后Spring帮我们将需要的对象设置到我们的类中，这叫做<code>依赖注入</code>。</p>
<h3 id="2、常见的几种注入方法"><a href="#2、常见的几种注入方法" class="headerlink" title="2、常见的几种注入方法"></a>2、常见的几种注入方法</h3><ul>
<li><strong>使用有参构造方法注入</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span>  <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">    User user=<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;tom&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>使用属性注入</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span>  <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">     User user=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">     user.setName(<span class="string">&quot;jack&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>使用接口注入</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 将调用类所有依赖注入的方法抽取到接口中，调用类通过实现该接口提供相应的注入方法。 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Dao</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String name)</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DapIml</span> <span class="keyword">implements</span> <span class="title class_">Dao</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>通过容器完成依赖关系的注入</strong></p>
<p>上面的注入方式都需要我们手动的进行注入，如果有一个<code>第三方容器能帮助我们完成类的实例化</code><br>，以及依赖关系的装配，那么我们只需要专注于业务逻辑的开发即可。Spring就是这样的容器，它通过配置文件或注解描述类和类之间的依赖关系，自动完成类的初始化和依赖注入的工作。</p>
<h3 id="3、Spring的IoC例子"><a href="#3、Spring的IoC例子" class="headerlink" title="3、Spring的IoC例子"></a>3、Spring的IoC例子</h3><p>(1) 创建工程，导入jar包</p>
<p>这里我们只是做IoC的操作，所以只需要导入核心模块里的jar包，beans、core、context、expression等。因为spring中并没有日志相关的jar包，所以我们还需要导入log4j和commons-logging。</p>
<p>(2) 创建一个类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(3) 创建一个xml配置文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">    xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">    xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">                        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt; </span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置要创建的类  </span></span><br><span class="line">    &lt;bean id=<span class="string">&quot;user&quot;</span> class=<span class="string">&quot;com.cad.domain.User&quot;</span>/&gt;        </span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>(4) 进行测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//这只是用来测试的代码，后期不会这么写</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@org</span>.junit.Test</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//加载配置文件</span></span><br><span class="line">        ApplicationContext context=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//获取对象</span></span><br><span class="line">        User user=(User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="comment">//调用方法</span></span><br><span class="line">        user.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在容器启动时，Spring会根据配置文件的描述信息，自动实例化Bean并完成依赖关系的装配，从容器中即可获得Bean实例，就可以直接使用。Spring为什么仅凭一个简单的配置文件，就能神奇的实例化并配置好程序使用的Bean呢？答案是通过 <code>Java的反射技术</code><br>。</p>
<h3 id="4、Spring的DI例子"><a href="#4、Spring的DI例子" class="headerlink" title="4、Spring的DI例子"></a>4、Spring的DI例子</h3><p>我们的service层总是用到dao层，以前我们总是在Service层new出dao对象，现在我们使用依赖注入的方式向Service层注入dao层。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// UserDao</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dao.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    UserDao userdao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserdao</span><span class="params">(UserDao userdao)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.userdao=userdao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service.......&quot;</span>);</span><br><span class="line">        userdao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------分割线--------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置文件</span></span><br><span class="line">&lt;bean id=<span class="string">&quot;userdao&quot;</span> class=<span class="string">&quot;com.cad.domain.UserDao&quot;</span>&gt;&lt;/bean&gt; </span><br><span class="line"><span class="comment">//这样在实例化service的时候，同时装配了dao对象，实现了依赖注入</span></span><br><span class="line">&lt;bean id=<span class="string">&quot;userservice&quot;</span> class=<span class="string">&quot;com.cad.domain.UserService&quot;</span>&gt;</span><br><span class="line">    <span class="comment">//ref为dao的id值</span></span><br><span class="line">    &lt;property name=<span class="string">&quot;userdao&quot;</span> ref=<span class="string">&quot;userdao&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h2 id="四、Spring资源访问神器——Resource接口"><a href="#四、Spring资源访问神器——Resource接口" class="headerlink" title="四、Spring资源访问神器——Resource接口"></a>四、Spring资源访问神器——Resource接口</h2><p>JDK提供的访问资源的类(如java.NET.URL,File)等并不能很好很方便的满足各种底层资源的访问需求。Spring设计了一个Resource接口，为应用提供了更强的访问底层资源的能力，该接口拥有对应不同资源类型的实现类。</p>
<h3 id="1、Resource接口的主要方法"><a href="#1、Resource接口的主要方法" class="headerlink" title="1、Resource接口的主要方法"></a>1、Resource接口的主要方法</h3><ul>
<li>***boolean exists()***：资源是否存在</li>
<li>***boolean isOpen()***：资源是否打开</li>
<li>***URL getURL()***：返回对应资源的URL</li>
<li>***File getFile()***：返回对应的文件对象</li>
<li>***InputStream getInputStream()***：返回对应资源的输入流</li>
</ul>
<p>Resource在Spring框架中起着不可或缺的作用，Spring框架使用Resource装载各种资源，包括配置文件资源，国际化属性资源等。</p>
<h3 id="2、Resource接口的具体实现类"><a href="#2、Resource接口的具体实现类" class="headerlink" title="2、Resource接口的具体实现类"></a>2、Resource接口的具体实现类</h3><ul>
<li>***ByteArrayResource***：二进制数组表示的资源</li>
<li>***ClassPathResource***：类路径下的资源 ，资源以相对于类路径的方式表示</li>
<li>***FileSystemResource***：文件系统资源，资源以文件系统路径方式表示，如d:&#x2F;a&#x2F;b.txt</li>
<li>***InputStreamResource***：对应一个InputStream的资源</li>
<li>***ServletContextResource***：为访问容器上下文中的资源而设计的类。负责以相对于web应用根目录的路径加载资源</li>
<li>***UrlResource***：封装了java.net.URL。用户能够访问任何可以通过URL表示的资源，如Http资源，Ftp资源等</li>
</ul>
<h3 id="3、Spring的资源加载机制"><a href="#3、Spring的资源加载机制" class="headerlink" title="3、Spring的资源加载机制"></a>3、Spring的资源加载机制</h3><p>为了访问不同类型的资源，必须使用相应的Resource实现类，这是比较麻烦的。Spring提供了一个强大的加载资源的机制，仅通过资源地址的特殊标识就可以加载相应的资源。首先，我们了解一下Spring<code>支持哪些资源类型的地址前缀</code>:</p>
<ul>
<li>***classpath***：例如classpath:com&#x2F;cad&#x2F;domain&#x2F;bean.xml。从类路径中加载资源</li>
<li>***file***：例如 file:com&#x2F;cad&#x2F;domain&#x2F;bean.xml.使用UrlResource从文件系统目录中加载资源。</li>
<li>***http***：&#x2F;&#x2F;<br>例如<a href="https://link.zhihu.com/?target=http://www.baidu.com/resource/bean.xml">http://www.baidu.com/resource/bean.xml</a><br>使用UrlResource从web服务器加载资源</li>
<li>***ftp***：&#x2F;&#x2F; 例如frp:&#x2F;&#x2F;10.22.10.11&#x2F;bean.xml 使用UrlResource从ftp服务器加载资源</li>
</ul>
<p>Spring定义了一套资源加载的接口。ResourceLoader接口仅有一个getResource(String location)<br>的方法，可以根据资源地址加载文件资源。资源地址仅支持带资源类型前缀的地址，不支持Ant风格的资源路径表达式。ResourcePatternResolver扩展ResourceLoader接口，定义新的接口方法getResources(<br>String locationPattern)，该方法支持带资源类型前缀以及Ant风格的资源路径的表达式。PathMatchingResourcePatternResolver是Spring提供的标准实现类。</p>
<h3 id="4、例子"><a href="#4、例子" class="headerlink" title="4、例子"></a>4、例子</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ResourceLoader</span> <span class="variable">resloLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultResourceLoader</span>();</span><br><span class="line">        <span class="type">Resource</span> <span class="variable">res</span> <span class="operator">=</span> resloLoader.getResource(<span class="string">&quot;https://www.baidu.com/&quot;</span>);</span><br><span class="line">        System.out.println(res <span class="keyword">instanceof</span> UrlResource); <span class="comment">// true</span></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(res.getInputStream()));</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ((temp = bf.readLine())!= <span class="literal">null</span>) &#123;</span><br><span class="line">            sb.append(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n-----------------------------\n&quot;</span>);</span><br><span class="line">        res = resloLoader.getResource(<span class="string">&quot;classpath:test.txt&quot;</span>);</span><br><span class="line">        bf = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(res.getInputStream()));</span><br><span class="line">        sb = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        temp = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ((temp = bf.readLine())!= <span class="literal">null</span>) &#123;</span><br><span class="line">            sb.append(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n-----------------------------\n&quot;</span>);</span><br><span class="line">        res = resloLoader.getResource(<span class="string">&quot;file:C:\\Users\\ricco\\Desktop\\test\\test.txt&quot;</span>);</span><br><span class="line">        bf = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(res.getInputStream()));</span><br><span class="line">        sb = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        temp = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ((temp = bf.readLine())!= <span class="literal">null</span>) &#123;</span><br><span class="line">            sb.append(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="五、Spring的Ioc容器详解"><a href="#五、Spring的Ioc容器详解" class="headerlink" title="五、Spring的Ioc容器详解"></a>五、Spring的Ioc容器详解</h2><h3 id="1、BeanFactory"><a href="#1、BeanFactory" class="headerlink" title="1、BeanFactory"></a>1、BeanFactory</h3><p>BeanFactory是一个类工厂，和传统的类工厂不同，传统的类工厂仅负责构造一个类或几个类的实例；而BeanFactory可以创建并管理各种类的对象，Spring称这些被创建和管理的Java对象为Bean。</p>
<p>BeanFactory是一个接口，Spring为BeanFactory提供了多种实现，最常用的就是XmlBeanFactory。其中，BeanFactory接口最主要的方法就是getBean(String beanName)<br>，该方法从容器中返回指定名称的Bean。此外，BeanFactory接口的功能可以通过实现它的接口进行扩展(比如ApplicationContext)。看下面的示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//我们使用Spring配置文件为User类提供配置信息，然后通过BeanFactory装载配置文件，启动Spring IoC容器。 </span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">    xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">    xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;user&quot;</span> class=<span class="string">&quot;com.cad.domain.User&quot;</span>&gt;&lt;/bean&gt;   </span><br><span class="line">&lt;/beans&gt;</span><br><span class="line"><span class="comment">// 我们通过XmlBeanFactory实现类启动Spring IoC容器 </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="meta">@org</span>.junit.Test</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123; </span><br><span class="line">        <span class="comment">//获取配置文件</span></span><br><span class="line">        ResourcePatternResolver  resolver=<span class="keyword">new</span> <span class="title class_">PathMatchingResourcePatternResolver</span>(); </span><br><span class="line">        Resource rs=resolver.getResource(<span class="string">&quot;classpath:bean.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//加载配置文件并启动IoC容器</span></span><br><span class="line">        BeanFactory bf=<span class="keyword">new</span> <span class="title class_">XmlBeanFactory</span>(rs);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//从容器中获取Bean对象</span></span><br><span class="line">        User user=(User) bf.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        user.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>XmlBeanFactory装载Spring配置文件并启动IoC容器，通过BeanFactory启动IoC容器时，并不会初始化配置文件中定义的Bean，初始化创建动作在第一个调用时。在初始化BeanFactory，必须提供一种日志框架，我们使用Log4J。</p>
<h3 id="2、ApplicationContext"><a href="#2、ApplicationContext" class="headerlink" title="2、ApplicationContext"></a>2、ApplicationContext</h3><p>ApplicationContext由BeanFactory派生而来，提供了更多面向实际应用的功能。在BeanFactory中，很多功能需要编程方式来实现，而ApplicationContext中可以通过配置的方式来实现。ApplicationContext的主要实现类是<code>ClassPathXmlApplicationContext</code><br>和<code>FileSystemXmlApplicationContext</code>，前者默认从类路径加载配置文件，后者默认从文件系统中加载配置文件，如下所示：</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">// 和BeanFactory初始化相似，ApplicationContext初始化也很简单</span><br><span class="line">ApplicationContext ac=new ClassPathXmlApplicationContext(&quot;bean.xml&quot;);</span><br></pre></td></tr></table></figure>

<p>ApplicationContext的初始化和BeanFactory初始化有一个重大的区别，<code>BeanFactory初始化容器时并未初始化Bean，只有第一次访问Bean时才创建；而ApplicationContext则在初始化时就实例化所有的单实例的Bean</code><br>。因此，ApplicationContext的初始化时间会稍长一点。</p>
<h3 id="3、WebApplicationContext"><a href="#3、WebApplicationContext" class="headerlink" title="3、WebApplicationContext"></a>3、WebApplicationContext</h3><p>WebApplicationContext是专门为Web应用准备的，它允许以相对于Web根目录的路径中加载配置文件完成初始化工作。从WebApplicationContext中可以获取ServletContext的引用，整个WebApplicationContext对象作为属性放置到ServletContext中，以便Web应用环境中可以访问Spring应用上下文。<code>ConfigurableWebApplicationContext</code><br>扩展了WebApplicationContext,允许通过配置方式实例化WebApplicationContext，定义了两个重要方法。</p>
<ul>
<li>***setServletContext(ServletContext servletcontext)***：为Spring设置ServletContext</li>
<li>***setConfigLocation(String[] configLocations)***：设置Spring配置文件地址。</li>
</ul>
<p>WebApplicationContext<code>初始化的时机和方式</code><br>是：利用Spring提供的ContextLoaderListener监听器去监听ServletContext对象的创建，当ServletContext对象创建时，创建并初始化WebApplicationContext对象。因此，我们只需要在web.xml配置监听器即可。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!-- 利用Spring提供的ContextLoaderListener监听器去监听ServletContext对象的创建，并初始化WebApplicationContext对象 --&gt;</span><br><span class="line">    &lt;listener&gt;</span><br><span class="line">        &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;</span><br><span class="line">    &lt;/listener&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Context Configuration locations <span class="keyword">for</span> Spring XML <span class="title function_">files</span><span class="params">(默认查找/WEB-INF/applicationContext.xml)</span> --&gt;</span><br><span class="line">    &lt;context-param&gt;</span><br><span class="line">        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">        &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;</span><br><span class="line">    &lt;/context-param&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4、BeanFactory、ApplicationContext和WebApplicationContext的联系与区别"><a href="#4、BeanFactory、ApplicationContext和WebApplicationContext的联系与区别" class="headerlink" title="4、BeanFactory、ApplicationContext和WebApplicationContext的联系与区别"></a>4、BeanFactory、ApplicationContext和WebApplicationContext的联系与区别</h3><p>Spring通过一个配置文件描述Bean与Bean之间的依赖关系，通过Java语言的反射技术能实例化Bean并建立Bean之间的依赖关系。Spring的IoC容器在完成这些底层工作的基础上，还提供了bean实例缓存、生命周期管理、事件发布，资源装载等高级服务。</p>
<p>BeanFactory是Spring最核心的接口，提供了高级IoC的配置机制。ApplicationContext建立在BeanFactory的基础上，是BeanFactory的子接口，提供了更多面向应用的功能。我们一般称BeanFactory为<code>IoC容器</code><br>，ApplicationContext为<code>应用上下文</code>，也称为<code>Spring容器</code>。WebApplicationContext是专门为<code>Web应用准备</code><br>的，它允许以相对于Web根目录的路径中加载配置文件完成初始化工作，是ApplicationContext接口的子接口。</p>
<p>BeanFactory是Spring框架的基础，面向Spring本身；ApplicationContext面向使用Spring框架的开发者，几乎所有的应用我们都直接使用ApplicationContext而非底层的BeanFactory；WebApplicationContext是专门用于Web应用。</p>
<h3 id="5、父子容器"><a href="#5、父子容器" class="headerlink" title="5、父子容器"></a>5、父子容器</h3><p>通过HierarchicalBeanFactory接口，Spring的IoC容器可以建立父子层级关联的体系：<code>子容器可以访问父容器的Bean，父容器不能访问子容器的Bean。</code></p>
<p>Spring使用父子容器实现了很多功能，比如在Spring MVC中，控制器Bean位于子容器中，业务层和持久层Bean位于父容器中。但即使这样，控制器Bean也可以引用持久层和业务层的Bean，而业务层和持久层就看不到控制器Bean。</p>
]]></content>
      <categories>
        <category>spring</category>
      </categories>
      <tags>
        <tag>spring</tag>
        <tag>IOC和DI</tag>
        <tag>表单验证</tag>
      </tags>
  </entry>
  <entry>
    <title>shiro</title>
    <url>/2023/04/16/shrio/</url>
    <content><![CDATA[<h2 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h2><h3 id="什么是Shiro"><a href="#什么是Shiro" class="headerlink" title="什么是Shiro?"></a>什么是Shiro?</h3><ul>
<li>Apache Shiro是一个Java 的<code>安全(权限)框架</code>。</li>
<li>Shiro可以非常容易的开发出足够好的应用，其不仅可以用在JavaSE环境，也可以用在JavaEE环境。</li>
<li>Shiro可以完成，<code>认证</code>，<code>授权</code>，<code>加密</code>，<code>会话管理</code>，<code>Web集成</code>，<code>缓存</code>等.</li>
<li><h2 id="官网-shiro-apache-org-x2F"><a href="#官网-shiro-apache-org-x2F" class="headerlink" title="官网: shiro.apache.org&#x2F;"></a>官网: <a href="https://link.juejin.cn/?target=http://shiro.apache.org/">shiro.apache.org&#x2F;</a></h2></li>
</ul>
<p>官方文档十分钟快速入门：<a href="https://link.juejin.cn/?target=http://shiro.apache.org/10-minute-tutorial.html">shiro.apache.org&#x2F;10-minute-t…</a></p>
<ul>
<li>下载地址:<a href="https://link.juejin.cn/?target=https://github.com/apache/shiro.git">github.com&#x2F;apache&#x2F;shir…</a></li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c3258b9e39b47be9614b0b113055af0~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="在这里插入图片描述"></p>
<h3 id="Shiro的三大功能"><a href="#Shiro的三大功能" class="headerlink" title="Shiro的三大功能"></a>Shiro的三大功能</h3><p>Shiro有三大核心组件，即<code>Subject</code>、<code>SecurityManager</code> 和 <code>Realm</code></p>
<ul>
<li>Subject: 为<code>认证主体</code>。应用代码直接交互的对象是Subject,Subject代表了当前的用户。包含<code>Principals</code>和<code>Credentials</code>两个信息。</li>
<li>SecurityManager:为<code>安全管理员</code>。是Shiro架构的核心。与Subject的所有交互都会委托给SecurityManager,<br>Subject相当于是一个门面，而SecurityManager才是真正的执行者。它负责与Shiro 的其他组件进行交互。</li>
<li>Realm：是<code>一个域</code><br>。充当了Shiro与应用安全数据间的“桥梁”。Shiro从Realm中获取安全数据（如用户、角色、权限），就是说SecurityManager要验证用户身份，那么它需要从Realm中获取相应的用户进行比较，来确定用户的身份是否合法；也需要从Realm得到用户相应的角色、权限，进行验证用户的操作是否能过进行，可以把Realm看成DataSource，即安全数据源。</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f1df3b80052a40ecb8482475e35e127f~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="在这里插入图片描述"></p>
<ul>
<li><code>Authentication</code>: 身份认证、登录，验证用户是不是拥有相应的身份;</li>
<li><code>Authorization</code>:授权,即权限验证，验证某个已认证的用户是否拥有某个权限，即判断用户能否进行什么操作，如:验证某个用户是否拥有某个角色，或者细粒度的验证某个用户对某个资源是否具有某个权限!</li>
<li><code>Session Manager</code>: 会话管理，即用户登录后就是第-次会话，在没有退出之前，它的所有信息都在会话中;会话可以是普通的JavaSE环境，也可以是Web环境;</li>
<li><code>Cryptography</code>: 加密,保护数据的安全性，如密码加密存储到数据库中，而不是明文存储;</li>
<li><code>Web Support</code>: Web支持，可以非常容易的集成到Web环境;</li>
<li><code>Caching</code>: 缓存，比如用户登录后，其用户信息，拥有的角色、权限不必每次去查,这样可以提高效率</li>
<li><code>Concurrency</code>: Shiro支持多线程应用的并发验证，即，如在一个线程中开启另一个线程,能把权限自动的传播过去</li>
<li><code>Testing</code>:提供测试支持;</li>
<li><code>RunAs</code>:允许一个用户假装为另-一个用户(如果他们允许)的身份进行访问;</li>
<li><code>Remember Me</code>:记住我，这个是非常常见的功能，即一-次登录后， 下次再来的话不用登录了</li>
</ul>
<h3 id="shiro架构（外部）"><a href="#shiro架构（外部）" class="headerlink" title="shiro架构（外部）"></a>shiro架构（外部）</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b00b0b78d68943feae4aa9832b82bb98~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="在这里插入图片描述"></p>
<p>从外部来看Shiro,即从应用程序角度来观察如何使用shiro完成工作: Subject 用户，SecurityManager管理所有用户 Realm连接数据</p>
<ul>
<li><code>subject</code>: 应用代码直接交互的对象是Subject, 也就是说<code>Shiro</code>的对外API核心就是<code>Subject</code>,<br>Subject代表了当前的用户，这个用户不一定是一个具体的人，与当前应用交互的任何东西都是Subject,如网络爬虫，机器人等，与Subject的所有交互都会委托给SecurityManager; Subject其实是一一个门面，<br>SecurityManageer 才是实际的执行者。</li>
<li><code>SecurityManager</code>: 安全管理器，即所有与安全有关的操作都会与<code>SercurityManager</code>交互,<br>并且它管理着所有的Subject,可以看出它是Shiro的核心，它负责与Shiro的其他组件进行交互，它相当于SpringMVC的DispatcherServlet的角色</li>
<li><code>Realm</code>: Shiro从Realm获取安全数据 (如用户,角色，权限)，就是说SecurityManager要验证用户身份，那么它需要从Realm获取相应的用户进行比较，来确定用户的身份是否合法;也需要从<code>Realm</code><br>得到用户相应的角色、权限，进行验证用户的操作是否能够进行，可以把Realm看DataSource;</li>
</ul>
<h3 id="Shiro架构-内部"><a href="#Shiro架构-内部" class="headerlink" title="Shiro架构(内部)"></a>Shiro架构(内部)</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8991ce3120e94c9baccc4aae76666875~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="在这里插入图片描述"></p>
<ul>
<li><code>Subject</code>: 任何可以与应用交互的用户;</li>
<li><code>Security Manager</code>:相当于SpringMVC中的<code>DispatcherSerlet</code>; 是Shiro的<code>心脏</code>， 所有具体的交互都通过<code>Security Manager</code>进行控制，它管理者所有的Subject,<br>且负责进行认证,授权，会话，及缓存的管理。</li>
<li><code>Authenticator</code>:负责<code>Subject</code>认证， 是-一个扩展点，可以自定义实现;可以使用<code>认证策略</code>(Authentication Strategy)，即什么情况下算用户认证通过了;</li>
<li><code>Authorizer</code>:授权器，即访问控制器，用来决定主体是否有权限进行相应的操作;即控制着用户能访问应用中 的那些功能;</li>
<li><code>Realm</code>: 可以有-一个或者多个的realm, 可以认为是安全实体数据源，即用于获取安全实体的，可以用JDBC实现，也可以是内存实现等等，由用户提供;所以- -般在应用中都需要实现自己的realm</li>
<li><code>SessionManager</code>:管理Session生 命周期的组件,而Shiro并不仅仅可以用在Web环境，也可以用在普通的JavaSE环境中</li>
<li><code>CacheManager</code>: 缓存控制器，来管理如用户，角色，权限等缓存的;因为这些数据基本上很少改变,放到缓存中后可以提高访问的性能;</li>
<li><code>Cryptography</code>:密码模块，Shiro 提高了一些常见的加密组件用于密码加密， 解密等</li>
</ul>
<h2 id="Shiro快速入门"><a href="#Shiro快速入门" class="headerlink" title="Shiro快速入门"></a>Shiro快速入门</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>下载：GitHub资源</p>
<p>创建一个普通maven项目springboot-08-shiro，然后删除src目录和没用的文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- configure logging --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>更改增加版本号：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.30<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.30<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>复制 <a href="https://link.juejin.cn/?target=https://github.com/apache/shiro/tree/master/samples/quickstart/src/main/resources">github.com&#x2F;apache&#x2F;shir…</a></p>
<p>recourse下面的log4j.properties</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">log4j.rootLogger=INFO, stdout</span><br><span class="line"></span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d %p [%c] - %m %n</span><br><span class="line"></span><br><span class="line"># General Apache libraries</span><br><span class="line">log4j.logger.org.apache=WARN</span><br><span class="line"></span><br><span class="line"># Spring</span><br><span class="line">log4j.logger.org.springframework=WARN</span><br><span class="line"></span><br><span class="line"># Default Shiro logging</span><br><span class="line">log4j.logger.org.apache.shiro=INFO</span><br><span class="line"></span><br><span class="line"># Disable verbose logging</span><br><span class="line">log4j.logger.org.apache.shiro.util.ThreadContext=WARN</span><br><span class="line">log4j.logger.org.apache.shiro.cache.ehcache.EhCache=WARN</span><br></pre></td></tr></table></figure>

<p>以及shrio.ini</p>
<p>下载插件，下载完成之后，重启IDEA plugins –&gt; Action Tracker</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[users]</span><br><span class="line"># user <span class="string">&#x27;root&#x27;</span> with password <span class="string">&#x27;secret&#x27;</span> and the <span class="string">&#x27;admin&#x27;</span> <span class="type">role</span></span><br><span class="line"><span class="variable">root</span> <span class="operator">=</span> secret, admin</span><br><span class="line"># user <span class="string">&#x27;guest&#x27;</span> with the password <span class="string">&#x27;guest&#x27;</span> and the <span class="string">&#x27;guest&#x27;</span> <span class="type">role</span></span><br><span class="line"><span class="variable">guest</span> <span class="operator">=</span> guest, guest</span><br><span class="line"># user <span class="string">&#x27;presidentskroob&#x27;</span> with password <span class="string">&#x27;12345&#x27;</span> (<span class="string">&quot;That&#x27;s the same combination on</span></span><br><span class="line"><span class="string"># my luggage!!!&quot;</span> ;)), and role <span class="string">&#x27;president&#x27;</span></span><br><span class="line">presidentskroob = <span class="number">12345</span>, president</span><br><span class="line"># user <span class="string">&#x27;darkhelmet&#x27;</span> with password <span class="string">&#x27;ludicrousspeed&#x27;</span> and roles <span class="string">&#x27;darklord&#x27;</span> and <span class="string">&#x27;schwartz&#x27;</span></span><br><span class="line">darkhelmet = ludicrousspeed, darklord, schwartz</span><br><span class="line"># user <span class="string">&#x27;lonestarr&#x27;</span> with password <span class="string">&#x27;vespa&#x27;</span> and roles <span class="string">&#x27;goodguy&#x27;</span> and <span class="string">&#x27;schwartz&#x27;</span></span><br><span class="line">lonestarr = vespa, goodguy, schwartz</span><br><span class="line"></span><br><span class="line"># -----------------------------------------------------------------------------</span><br><span class="line"># Roles with assigned permissions</span><br><span class="line"># </span><br><span class="line"># Each line conforms to the format defined in the</span><br><span class="line"># org.apache.shiro.realm.text.TextConfigurationRealm#setRoleDefinitions JavaDoc</span><br><span class="line"># -----------------------------------------------------------------------------</span><br><span class="line">[roles]</span><br><span class="line"># <span class="string">&#x27;admin&#x27;</span> role has all permissions, indicated by the wildcard <span class="string">&#x27;*&#x27;</span></span><br><span class="line">admin = *</span><br><span class="line"># The <span class="string">&#x27;schwartz&#x27;</span> role can <span class="keyword">do</span> <span class="title function_">anything</span> <span class="params">(*)</span> with any lightsaber:</span><br><span class="line">schwartz = lightsaber:*</span><br><span class="line"># The <span class="string">&#x27;goodguy&#x27;</span> role is allowed to <span class="string">&#x27;drive&#x27;</span> (action) the <span class="title function_">winnebago</span> <span class="params">(type)</span> with</span><br><span class="line"># license plate <span class="string">&#x27;eagle5&#x27;</span> (instance specific id)</span><br><span class="line">goodguy = winnebago:drive:eagle5</span><br></pre></td></tr></table></figure>

<p>继续复制quickstart</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.text.IniRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.session.Session;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Quickstart</span> &#123;</span><br><span class="line">    <span class="comment">//使用日志输出</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">transient</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(Quickstart.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">DefaultSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultSecurityManager</span>();</span><br><span class="line">        <span class="type">IniRealm</span> <span class="variable">iniRealm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IniRealm</span>(<span class="string">&quot;classpath:shiro.ini&quot;</span>);</span><br><span class="line">        securityManager.setRealm(iniRealm);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Now that a simple Shiro environment is set up, let&#x27;s see what you can do:</span></span><br><span class="line">        <span class="comment">//现在设置了一个简单的Shiro环境，让我们看看您可以做什么：</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// get the currently executing user:</span></span><br><span class="line">        <span class="comment">//获取当前正在执行的用户：getSubject</span></span><br><span class="line">        <span class="type">Subject</span> <span class="variable">currentUser</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过当前用户拿到Session</span></span><br><span class="line">        <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> currentUser.getSession();</span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">&quot;someKey&quot;</span>, <span class="string">&quot;aValue&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;someKey&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (value.equals(<span class="string">&quot;aValue&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Securit=&gt;Session! [&quot;</span> + value + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 这段if 就是判断当前的用户是否被认证</span></span><br><span class="line">        <span class="keyword">if</span> (!currentUser.isAuthenticated()) &#123;</span><br><span class="line">            <span class="comment">//如果认证成功，就拿到账号密码生成一个Token令牌，没有获取，随机生成</span></span><br><span class="line">            <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;lonestarr&quot;</span>, <span class="string">&quot;vespa&quot;</span>);</span><br><span class="line">            <span class="comment">//设置记住我</span></span><br><span class="line">            token.setRememberMe(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//执行了登录操作！</span></span><br><span class="line">                currentUser.login(token);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnknownAccountException uae) &#123; <span class="comment">//未知的账户</span></span><br><span class="line">                log.info(<span class="string">&quot;There is no user with username of &quot;</span> + token.getPrincipal());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IncorrectCredentialsException ice) &#123;<span class="comment">//密码不正常，然后输出</span></span><br><span class="line">                log.info(<span class="string">&quot;Password for account &quot;</span> + token.getPrincipal() + <span class="string">&quot; was incorrect!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (LockedAccountException lae) &#123;<span class="comment">//用户被锁定，比如说输入5次失败，锁定账户</span></span><br><span class="line">                log.info(<span class="string">&quot;The account for username &quot;</span> + token.getPrincipal() + <span class="string">&quot; is locked.  &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;Please contact your administrator to unlock it.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ... catch more exceptions here (maybe custom ones specific to your application?</span></span><br><span class="line">            <span class="keyword">catch</span> (AuthenticationException ae) &#123;</span><br><span class="line">                <span class="comment">//unexpected condition?  error?</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取当前用户的验证码</span></span><br><span class="line">        log.info(<span class="string">&quot;User [&quot;</span> + currentUser.getPrincipal() + <span class="string">&quot;] logged in successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//测试角色，比如之前的vip1，vip2</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;schwartz&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;May the Schwartz be with you!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Hello, mere mortal.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//检查是否有什么权限，粗粒度！</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;lightsaber:wield&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;You may use a lightsaber ring.  Use it wisely.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//如果全选不满足就输出</span></span><br><span class="line">            log.info(<span class="string">&quot;Sorry, lightsaber rings are for schwartz masters only.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//是否拥有更高级权限，细粒度！</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;winnebago:drive:eagle5&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;You are permitted to &#x27;drive&#x27; the winnebago with license plate (id) &#x27;eagle5&#x27;.  &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;Here are the keys - have fun!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Sorry, you aren&#x27;t allowed to drive the &#x27;eagle5&#x27; winnebago!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//注销</span></span><br><span class="line">        currentUser.logout();</span><br><span class="line">        <span class="comment">//结束系统</span></span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动测试</p>
]]></content>
      <categories>
        <category>spring</category>
      </categories>
  </entry>
  <entry>
    <title>springSecurity</title>
    <url>/2023/04/06/springSecurity(%E5%AE%89%E5%85%A8)/</url>
    <content><![CDATA[<h2 id="springSecurity-安全"><a href="#springSecurity-安全" class="headerlink" title="springSecurity(安全)"></a>springSecurity(安全)</h2><p>在web开发中，安全第一位！ 过滤性，拦截器</p>
<p>做网站：安全应该在什么时候考虑？设计之初</p>
<p>在 Web<br>开发中，安全一直是非常重要的一个方面。安全虽然属于应用的非功能性需求，但是应该在应用开发的初期就考虑进来。如果在应用开发的后期才考虑安全的问题，就可能陷入一个两难的境地：一方面，应用存在严重的安全漏洞，无法满足用户的要求，并可能造成用户的隐私数据被攻击者窃取；另一方面，应用的基本架构已经确定，要修复安全漏洞，可能需要对系统的架构做出比较重大的调整，因而需要更多的开发时间，影响应用的发布进程。因此，从应用开发的第一天就应该把安全相关的因素考虑进来，并在整个应用的开发过程中。<br>市面上存在比较有名的：Shiro，Spring Security ！ 这里需要阐述一下的是，每一个框架的出现都是为了解决某一问题而产生了，那么Spring Security框架的出现是为了解决什么问题呢？<br>首先我们看下它的官网介绍：Spring Security官网地址 Spring Security is a powerful and highly customizable authentication and access-control<br>framework. It is the de-facto standard for securing Spring-based applications. Spring Security is a framework that<br>focuses on providing both authentication and authorization to Java applications. Like all Spring projects, the real<br>power of Spring Security is found in how easily it can be extended to meet custom requirements Spring<br>Security是一个功能强大且高度可定制的身份验证和访问控制框架。它实际上是保护基于spring的应用程序的标准。 Spring<br>Security是一个框架，侧重于为Java应用程序提供身份验证和授权。与所有Spring项目一样，Spring安全性的真正强大之处在于它可以轻松地扩展以满足定制需求<br>从官网的介绍中可以知道这是一个权限框架。想我们之前做项目是没有使用框架是怎么控制权限的？对于权限 一般会细分为功能权限，访问权限，和菜单权限。代码会写的非常的繁琐，冗余。<br>怎么解决之前写权限代码繁琐，冗余的问题，一些主流框架就应运而生而Spring Scecurity就是其中的一种。 Spring 是一个非常流行和成功的 Java 应用开发框架。Spring Security 基于 Spring<br>框架，提供了一套 Web 应用安全性的完整解决方案。一般来说，Web 应用的安全性包括用户认证（Authentication）和用户授权（Authorization）两个部分。<br>用户认证指的是验证某个用户是否为系统中的合法主体，也就是说用户能否访问该系统。用户认证一般要求用户提供用户名和密码。系统通过校验用户名和密码来完成认证过程。<br>用户授权指的是验证某个用户是否有权限执行某个操作。在一个系统中，不同用户所具有的权限是不同的。比如对一个文件来说，有的用户只能进行读取，而有的用户可以进行修改。一般来说，系统会为不同的用户分配不同的角色，而每个角色则对应一系列的权限。<br>对于上面提到的两种应用情景，Spring Security 框架都有很好的支持。 在用户认证方面，Spring Security 框架支持主流的认证方式，包括 HTTP 基本认证、HTTP 表单验证、HTTP 摘要认证、OpenID 和<br>LDAP 等。 在用户授权方面，Spring Security 提供了基于角色的访问控制和访问控制列表（Access Control List，ACL），可以对应用中的领域对象进行细粒度的控制。 2、环境搭建 3、认证和授权<br>3.1、认识SpringSecurity Spring Security 是针对Spring项目的安全框架，也是Spring Boot底层安全模块默认的技术选型，他可以实现强大的Web安全控制，对于安全控制，我们仅需要引入<br>spring-boot-starter-security 模块，进行少量的配置，即可实现强大的安全管理！</p>
<p>记住几个类：</p>
<p>WebSecurityConfigurerAdapter：自定义Security策略 AuthenticationManagerBuilder：自定义认证策略 @EnableWebSecurity：开启WebSecurity模式<br>Spring Security的两个主要目标是 “认证” 和 “授权”（访问控制）。</p>
<p>“认证”（Authentication）</p>
<p>身份验证是关于验证您的凭据，如用户名&#x2F;用户ID和密码，以验证您的身份。</p>
<p>身份验证通常通过用户名和密码完成，有时与身份验证因素结合使用。</p>
<p>“授权” （Authorization）</p>
<p>授权发生在系统成功验证您的身份后，最终会授予您访问资源（如信息，文件，数据库，资金，位置，几乎任何内容）的完全权限。</p>
<p>这个概念是通用的，而不是只在Spring Security 中存在。</p>
<p>3.2、配置 使用 Spring Security 增加上认证和授权的功能</p>
<p>1、引入 Spring Security 模块</p>
<h3 id="1-认证"><a href="#1-认证" class="headerlink" title="1.认证"></a>1.认证</h3><h3 id="2-授权"><a href="#2-授权" class="headerlink" title="2.授权"></a>2.授权</h3><p>两个方面：晚上总结</p>
]]></content>
      <categories>
        <category>spring boot</category>
      </categories>
  </entry>
  <entry>
    <title>swagger</title>
    <url>/2023/04/17/swagger/</url>
    <content><![CDATA[<h1 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h1><p>学习目标</p>
<ol>
<li>了解swagger的作用和概念</li>
<li>了解前后端分离</li>
<li>在springboot集成swagger</li>
</ol>
<p>Swagger简介</p>
<p><strong>前后端分离</strong></p>
<p>Vue+spring boot</p>
<p>后端时代：前端只用管理静态页面；html&#x3D;&#x3D;》后端。模版引擎：jsp&#x3D;&#x3D;》后端是主力</p>
<p>前后端分离时代：</p>
<ul>
<li>后端：后端控制层：controller，service，dao【后端团队】</li>
<li>前端： 前端控制层，视图层 【前端团队】<ul>
<li>伪造后端数据，json</li>
</ul>
</li>
<li>前后端如何交互？&#x3D;&#x3D;》api</li>
<li>前后端相互独立</li>
<li>前后端相对独立</li>
<li>前后端可以布置到不同服务器</li>
</ul>
<p>产生一个问题</p>
<ul>
<li>前后端集成联调，前后端无法做到“几时联动，尽早解决”最终导致问题集中爆发；解决方案。</li>
<li>首先指定schema【计划的提纲】，实时更新最新的api。降低继承的风险。</li>
<li>早些年：指定word的计划文档</li>
<li>前后端分离<ul>
<li>前端测试后端测试：postman</li>
<li>后端提供接口：需要实时更新及改动</li>
</ul>
</li>
</ul>
<p>Swagger</p>
<ul>
<li>号称世界上最流行的api框架</li>
<li>restful api文档自动生成工具-api与api定义同时更新</li>
<li>直接运行</li>
</ul>
<p>在项目中使用swagger需要springbox：</p>
<ul>
<li>swagger2</li>
<li>ui</li>
</ul>
<h2 id="springboot集成swagger"><a href="#springboot集成swagger" class="headerlink" title="springboot集成swagger"></a>springboot集成swagger</h2><ol>
<li><p>新建一个spring boot-web项目</p>
</li>
<li><p>导入依赖</p>
<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 -->
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger2</artifactId>
    <version>2.9.1</version>
</dependency>

<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui -->
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger-ui</artifactId>
    <version>2.9.2</version>
</dependency>
</li>
<li><p>编写一个hello工程</p>
</li>
<li><p>配置swagger</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CorsConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 这里主要为了解决跨域问题,所以重写addCorsMappings方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;HEAD&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .exposedHeaders(<span class="string">&quot;access-control-allow-headers&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;access-control-allow-methods&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;access-control-allow-origin&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;access-control-max-age&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;X-Frame-Options&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">false</span>).maxAge(<span class="number">3600</span>);</span><br><span class="line">        <span class="built_in">super</span>.addCorsMappings(registry);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//解决swagger映射</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/static/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/swagger-ui.html&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">        <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a> 点击此页面出现这类error情况，是因为</p>
<blockquote>
<h2 id="swagger-ui-html-404问题解决"><a href="#swagger-ui-html-404问题解决" class="headerlink" title="swagger-ui.html 404问题解决"></a>swagger-ui.html 404问题解决</h2><p><a href="https://dev-tang.com/"> 唐际忠的博客 </a><em>2020-01-06 16:35:00</em></p>
<p><a href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAYAAAA+VemSAAAAAXNSR0IArs4c6QAAFjlJREFUeF7t3dt2HLcOBFD5/z/aZ42cvCRkH+9WIeyxKo8OhAYLVQDIvsyPj4+Pnx8P/u/nTwvvx48ftJqd/50fjWcVjMZIC0JjXY/icmKtuqYdZCdix/R9vNhuCtErfNFek6GgV8CW/gr4i4QO/3kFvOnwSlTJixYZ8a22qQKphVDjFHtdUzuwoIu2mgwVhxJP4+kIbVsapMfSPJGjl2PlUiJ29dEO3A5MnNHJ5IQIvr2AUwAQMzYVTzukXlPtT2EjnfxJMQq+Whx09FVcVvGoD1n/le0Om2UHflKQFfA+rSnCp0j2VT+p9Uz6eZI2Psf81Sn0k4KsgCtg5WMFjPdev1p5//57GVlO7K1ecSqZUth0hP59JCvgCnjLlgr494WklpPCu1N8paHoWtW+e2BFbGNfAYeAXLipgH27RHvg1Ngq+1oVjJIgtaYV9LLOqw6RiFFj2VFJ/Yi92CbxkuuK7Z1Sp/4rYHx2WpKiyVD7yVgq4PWDHJM5ulOUKuAKWOrA9hAvMfmoONQ+UZRS10zEwreREqOcVpmO0JlH+lLEUz9iL7bKo6sqJdcVW6qMfxmr/3bgdmDimRJM7MW2Av6Vtgq4Aq6A4Xl4LTIE7sVzBpHbSO88Qk8DKafQu1h0HylrUt+a6wSx1ceJ7ZXGKDm6M1V8mw48DWQFvP4wgBQCFUcF/I1G6Ap4/V6uiiZ1eioFT6eH1IQjT2JJoUodqH2rPXAFXAFrIaiAN6qRqp8akyrgCrgCDp3YVsDrcqIEk6KkvnUklJymxvBUcZfYxVby87et+u8hFk4JK/MU2TXhKkr1L/aKgeyBU3taWc/n/nLRsFRgek31XwFXwMqxpX0FnPl4XwU8POa3A9v4L9VheiSWWNqBL9CSKpNKqiZPrqvdR3xfxd0R2g7mlAMdoXE8FcB0X6TJE5FVwLMvXGiuJXdaIKX5KOde9uq/e2AsMh2hO0InOLAT96iA71QU+RvpwKe63mTyUkkVzFO2qa6XiCe1tRA+JuLWaeBzn/5dPis7STAtJppsrcrqP2E/ia/GVwH/gV+lnCRYBfxnfm63HRhLpwCmoqmAMRloPokvhrL9UTKNUfioMar9ju8doRXJhb0WE71kR2hDrCN0R2hiTAXcEZoIc8OYOvAN/2N/ot3nhL1W/BP2J3D5PCXdPBm3ikds1XfSfozsNxy/7e8DPynZT4plR9QK2IrJleBv6GzsTypg+KDZKwvv2jkq4Ap4rIpcOS7xMsQrjhkcj4jg4qLtwO3AS3qcEPw7bEUeJ+CfenPsISvQZKfClnuDejp9IhWKY8o+kQ8tMrtrnsA9sf7PfXoFbFBWwPYKnxYxyUYFXAELXz5tK+AKmEkz+AftwAhuBVwBI2VGzStghLcCroCRMqPmFTDCWwFXwEiZUfNRAZ84wBhFa+N8+mQ2cUo6mYs79/ElT4rvzrf6EcwSOdqdsbz+fXtgN3kKLQBIQq8WpH4S9pPESK11MhcVcO5lDuZSBfx1CTPo+OnbRHWvgGefxErkqB3461q85aEC3sOWILbi2xH6Fo3//UeTVT9BjNAy6ZW5qyq7iyex1slcdITuCM1aSpCaL9pDLIYskad24ItDrNVXKTlLmz+YTJ7GmHrsbnVdXad2Q/Wv2KzsVTQpe8FXr6mjdQJHnaqUG6NvIyWIpwuaBkwIliJMAkclo4ojZS/46jVT+VAsE2vaxt4O/PVflVOBaVFS/wmCqThS9gmyK16ajwS+qYmwHRhv6QjBUhVfCZkgWEqQCaKqD8WrAu4emDSjhFFCUjDDB3MqPimQWmRSBTWBbwKXVxztwO3ASz6qOFL2FbBt6ejD7tOdY+Vfu4/GqNVU4tFYxLfGrQJL+Vc/ImD1PYlByrdypgJGFojINBniG8Pmh01S/tVPBdwOnODM1oeIrALOpEIwv7piqkuurpHyrZxpB0aOCZk0GeIbw24Hxl+JOIWvcqYCxkyJyDQZ4hvDroAr4P3rWDsyKSF7iPVTdfnb9qkR78StGOWRxpjwn8JXiz59kSMV5G+z7sJQF5oqMif2P3rPUAiZwjGRU11n4ppXPiZxFN+vGHd5qoADP6WaKmzqR+2l+EyLQ06bTxUZEZnGKL4r4As2KpAiAvWtglR7ib0Ctnd8K2BkjALWEXqNQApHTN/SvCP0HsWO0BtstEtKF1Pf2lHVXmJPCFJ9VMAVsHJm+7lOcZQQ0tU+R4kthaMdeJ/pSRzF9+UeePU+cIowSuzEbSQR3h3RqH+xnxST5lTivmO7ikfXnxLB5PZKsVEMIg9yKDnEXpOUAmz6uv/1OCuYK4Z37CvgzJlEBbx5nbACviPL3/+bCrgC/n22XFjqmB+56MaJjk8SSzvw/JOEko+drXKgHbgdOME79tEO3A7MpJF9Z0foCLxbJxXwGwtYTv2mR1wdWVaxq9hTaxI/Yps8ndfrzpYN8z7JDcVl+yDHidtIFbD9xq7ul6S76d74VLEy6WWsK2D8YFyCeJq6ySQlhHe1HqniYtsO/Av1SW6k8nHkEKsduB1YO7kW5oR9BdwOvOSRVt9EJ9drqn0ixoTokj7eQsDyA9+ppEqyT1VqWavYpkazlx/ZvyqOSl6JRSaw1BYihXtindEiUwHbcX5in67iUMInninXGBPEThWZRCwJzJNC3Ta9CrgCXiFQAa95MVkc7gj+UZ/USXSOOyAIgduB54jdDuzsrYA3mMm+VmxTe7Hugfe3eSa75KRvl+/HRwVcAdNJ+eTesB3YJUz3gdW9dqavjrIa31U3fFKl1VhUCE/C/U4O//k374yXnj1UwPg2kgL83Qm5PT3FZwQExwo48K3kO93tSZ1ASSAEU1uNpR14/QsXiYlQC5LmQhtEO3A7MO2BlZBKeC1uK/t3LngVMDJAq7ICjOEszd+ZkBWw/d6V8qsduB24HTiwZdRGkCpsy9tIqWC0+yQe5NDYteKdeJAjMbaewEXPQRK5uOKcYpA4k0lc83JNq0cppy8q1UfJq7EnSHPimoni+PKh4/nuuupHCqFeU/h1hUEFjCxrB14DpkVskngqJiluiWLaDjz8S+YKsJJXCHM14glRT1wTa+P26xLaOQWXjtD+uCfntSP0+usYQtQK2EfxjtB2Or3dFlTAFbCM3FLY2oH/gw6c+Cqltn0lQYJgek3Zj+mYnzpkkc4v69GDnTtbkRRnVn40H4qNxK6xKDfoPvDkQpU0qVgSe8DpJGmMTxpPhewpW81HikuJYlIBIwtUHCeSpDFWwLa/rIBRNDrOdoT++sP5StIndTGl15Ni11jagTHb2t3agdcAa4HANJG5imYydo2lAqZU++2PCrgCFoodEXBixL06mUx0PQFRD8juxJ4Y8yeTrb5TXUlynYpRrqnckJP/Kx6pxnbXXZ5Cq3Nt+wqwijXRJTVRFfA6S5LrCtgnwgp4Ux0qYHvARYv+k557l8KhvNBJRgreZ4dfPcihyWgHzuwLhUhXU8mkOHQaEkLq+lNikuumrqka6wiNL21rojpCd4Se5EAFXAFT89TRL9FRpBPeOWicLMoyaVwlQv086oscwjAlmJJDYtEtRILsqdPTE7HsxHciR7oVUbyUR1pkKmBFGOxTRUaTemKUU/El9umQilumkj9dvxb9bWd+0uuEgrKAq91K4khV8KsYK+BURsyPcKwCNmy3X5iYHnEkTCFABby/ByqYJ20lfxUwIi/gtgPvXyzXgpeYBroH3pNd8e0eGAuHmKeKjCa1e2DJkotp9RfHOrB8kUM33qnqngAsIYKndQ4pEHp7YtpeJKbiEFxOTWcpLdEXOVIXVXJUwGvkhaiK+bR9Bfz1nH42lHbgr3+9QTuEkPfKtgLOiOBU/hJbnQo48ITWKQJUwBVwBVwBL1XQETo1J5kfKco8QutBkNrbUjPVN3HNabInOrzmQok0iaOevSTw0gPLFL7KJerA00EmSPAk4j0Jr1QsiRzp3YkKeH8fvwIOMFKrZspeQq+ABa1ftvK8dgpf5UYF7Hn9118o6Cl7CT1FMLmm2uroq2vSeCrgH+vPsmiiBPiO0HY2oMVEcqG2yosKGO8DK2Bqrwlf2VfAFbAWAtlja8GbtqcROiGw3d5i+mAjFXvCjxJMi5L6l0KohEzgpT50/YrvKh69pq5pF2MFrEgG7DXZSjD1XwF//QucCcyvqFUBB4SXcqHJroAN+Wl824E3h1sJYJTsRo2M9TTB1H87cDswMVtEpmQU3xR00Hh6Teq/Aq6Aid4iMiWj+Kagg8bTa1L/FfAfJmA9EZ68XaS+U/aCQapoJIS3i/sELlrz3gFHXVPKng6xhLwvWyWHLEp9p+wFg3cg3glcJM9XPFI/k4VQY0nZV8Cb1wZVfCtyqA8pDtMESN3XTYjmHXBM5UP9VMAV8JIzFbBK6Yx9BVwBV8BntBe5agVcAVfAESmdcbIV8OqnVVInmepnZa97Kz2sScSoKZ1eU2IvqTEqBit7jTs1/p84k1DebddaAa+hVDIJgVUcWpQSsWuMsn4lrwossf7XNZ+EQQUc+HhdgqR3iFEBr5FvB/74WP60ilZIrVRSIVO+U34SIk7FMklgjTGBi/DiqhCqH+3wibWmNFYBb5BMkeDEvj4RewXcEXpbqIRgSiQdN7USJqrv9JoE33foPhpjYv13tjoJbih/6dcJFcjEglIC03FTRMagw+uUVxg+KUaJ5bUmEZn6TnFGpqcUB5SnFXDgw3up5GnBE2JPxyixVMD+/gDdB5bq+LRRQ6cEJfbKv/pQfHVNJ2KsgO0LrCnOtAO3Ay/rgxaZCrgCpgkyRTCthCe6Wzuw/QRs98B4yKLVl5Qaus2jhwOyJi0CWnwq4Ap4uwde/cC3EkYJqWJKCF7XlKjiUgSSa5R8aIzi++p8ZOUnxYtpP8lc/dOX4rv8LrSSXS+aAjgB5CSB1XdiPdMnvJO5TvFi2k8qT7Id2zaUdmAbz4TAFfD+aaZ24LUkhV+fxboCroCloyjBpBuK7VXM034EL7VVfCvgwbeU2oHbgStgRQDtVWRSIdU3hr41n4xRfPcQyzOq+NKPm03fLlkRXhekokn4Vx+e1vVf6Frluqk1yTgrtlocZO13bFOx692PCjhwzztFdiVOBbw+vziRjwp48wkTTYaSOuFffahQ9bZewn9qTUJssW0H/pXlduB24KXeK2Arg6ni0xF68FR5V/VTZDfKzH4xIrUmIbbYtgP/1YEnv0qZIoEQW0nwpPFUY1d7wVFxSeQ6tZ5pPwkc1ccO39FvYiWSqgt9h+SlTvNTaxWMJ6+Z8j3tR/BK2VbAgb3udDKUeGqfiH/yminf034SOKqPCrgCVs4s7VPiWDlP+Z72EwESnVTAFTBSZm2eEkcFbOmogCtgY8zGugKOwMhOtgKWt5H4qvgH8hCGHpCdIB4uf/upVY1dcNQYd/aJfEwf7qViF8w0F4ojvY0kgd+xlcXqQlUEEr/EfeX3FIFlrSkRrDA7tX7lkuCl3NBYKmAcrWXvJol+2Z4isMa5slfiVcBr1BXHCrgCTuiXfmnhdcEKuAIm4nWEJrjYWDtHBVwBE8kqYIKLjSvgNWTje+DEs9C7bE+KRq+pjJT9aIK8Gp/umWU96vuOfWIfneKAYiOxT2sg8iy0AqmEF3JrxdNTVRn9FBdZp4pGSTptLyJQXJQDulaJvQLG7GnyKmD7qoUSUvKRKuxyTS2ECb5cXRPp/tEOvEFMqrISTwmWII2s5w6p1b90MSW14jsZuxY8XWsFXAEvEVBSq30FvP41wwoYv8gx2d26B7avhugkk8J3svi8RQfWkUWrzKT9k5KXwlGEoARL2UtOZT0vvxqjFALly7h94jZSiniS1JStAiyjnxIphaMQPhVjAkedhkR4dw6O5I7DKRwje+AU8VKiFD8J4qkPtZf1KFFPEU/WJAWpHfgC2WniSVJTtok1qQ+117UK4SvgPbrtwMq8A/YJMakPtVdYKmC7ty2juOZu3L574PVxvmwLppNUAdstF50q3lrA8kWOFDBKyJW9xqL2EmPKtxQN3esKSWXt/8/2SdPA/4v1v/z/muvtAV8FbNU9UUxSYhJxpK6pJJcYtRCqvcY+aV8Bbx7YSI2zkrwUkTSpIo4KWDI6b6u5bgdGwUsKK+A9WlJkFEe1l5xO21bAKMjJZKd8a1JFHO3A05I0/5rrdmAUvKSjAm4HFr68bGMClttIGuSkve51txUMP2qXAD7ROa9IsPKvcafwFdw1RvF9xcXEdU/k9LUmepRyUpDqO0UwBf5dk61xp/AVkWmM4rsCVoUN26cIVgGvE5XCV0RWAfubVO3AHaGXGquArQNpI9BDxZ3/CrgCroADH4GogK3g8c+QyCj3J+6XdDxtBzZCHhOwPEppS8pYp27RpEYWEcKppK7WKnF/nm4OTybqX9akvoVjYhu9XbTJx6N+G2kySRXw+hW7U5OJimySGyJKsa2Ag983qoAr4AQHKmCcrBUwdM8fQJNRNNFlrqq4+Je4O0L/YpE8EHPizOAzxu6B7esNIgQR2J2DM/EvcVfAby5gTbZ2Pdl3aQdO2cuaREh3hCp47Tq2dojUmmRsnb6mxCL5vyp4KS1t7wOvOnDqogkQUoJUAkvsKeIp7rImsb3TgQUvLTLqW+0V95V/xVdjrIA3x/CTydMkaSxCGrGtgDVz+9tumlOdtpZ74NRFFYbJQwMlsMTeDixo/bJdcSyFo0aT4Pskv64KagX8Bo/RaVUWcegWRcUh+84KeI9uR+iO0Et2VMCZl+vfogOnKqSQRmyvuoOOSdMJmTwISWxFpHOmurJinuJjKv6VH+WdxkIjdAowEaXYVsC/EKiAVQZz9hVw6FtWCqR2gwQFUtesgBPZyPhQ3ulV24E3iKXEJAlJXbMCFtRnbSvgdmD+gmEFPCtK8V4BV8AVcIgDIryUbQUcuE97lQwdW6W7KQn0kFDIob71FDrhX9aj2KbsE3xJxfJ5YCnPQieS9LqonCxPJzWRkFSMiq9cV31XwGsEEnypgIMIJBIiQrozDaiYVvYVcIY0Cb5kIvnlpR0Yn9DqCG3vTwtZU4VQrqm2FXBH6C1ntEsK4dW3dv2Ef1mPCi9lXwFXwBXwBoEK2MvMtx+hd5BJR5FDuasUTRJYO4dTyQ59Vta6fsmRHp5e2aewSZxVVMCbbAg5KuA9pRM4JopsBXzjY9+JfZRW5VR1TBBPfExX/HZgu305nY9UUWoHbgdO1bylHyliWqzFdztwO/CW6B2hO0KnqqAWpXbgduAU99qBA0iOCjgQ36WLxEMSutdTwGTMS/nWNcnpZmp60PMO4ZKuP4V7AkdZ58tWY6cOrMGofQVsTzklikkFbN/E0mKS0MCVjwp48Gc0tZqqmCpgK3iJKaECvign7cBGyArY8KqAdR5A+wrYCFkBG14VMApSzStgI2QFbHh9GwGr8CbthaR3TvESseveNXHNlw/BRvduaq9rkmI9fZagsYu95OiKv1uOvevvA+9A1GRLMrSCT8ci5FBBqr3iWAGvEVPc3/YHvivgduCnFdRVPFJk24Fv3AjXziFJagfeo9sO3A68RGBaNBXw+uBIC2EFXAFXwPDJXd5b4bfCKuA1AtMj9P8AahQsEi7FhtAAAAAASUVORK5CYII="> 手机阅读 </a><a href="https://dev-tang.com/wechat_zan.jpg"> 微信赞赏</a></p>
<p>Spring boot整合swagger2（版本号：2.9.2）出现404错误。这个实在没啥说的直接上错误和解决方法。</p>
<h4 id="错误提示"><a href="#错误提示" class="headerlink" title="错误提示"></a>错误提示</h4><p>页面出现这个错误：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Whitelabel Error Page</span><br><span class="line">This application has no explicit mapping for /error, so you are seeing this as a fallback.</span><br><span class="line"></span><br><span class="line">Mon Jan 06 16:38:25 CST 2020</span><br><span class="line">There was an unexpected error (type=Not Found, status=404).</span><br><span class="line">No message available </span><br></pre></td></tr></table></figure>

<p>java控制台出现这样的日志：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">o.s.web.servlet.DispatcherServlet - GET &quot;/swagger-ui.html&quot;, parameters=&#123;&#125;</span><br><span class="line">o.s.web.servlet.PageNotFound - No mapping for GET /swagger-ui.html</span><br><span class="line">o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND</span><br><span class="line">o.s.web.servlet.DispatcherServlet - &quot;ERROR&quot; dispatch for GET &quot;/error&quot;, parameters=&#123;&#125;</span><br><span class="line">o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController.errorHtml(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)</span><br><span class="line">o.s.web.servlet.DispatcherServlet - Exiting from &quot;ERROR&quot; dispatch, status 404</span><br></pre></td></tr></table></figure>

<p>但是&#x2F;v2&#x2F;api-docs又是可以访问的。</p>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>办法1、检查是否有地方加了这个注解<code>@EnableWebMvc</code>，有的话删掉就可以了。</p>
<p>办法2、检查是否有类继承了<code>WebMvcConfigurationSupport</code>，有的话删掉就可以了。</p>
<p>因为上面两个会覆盖spring mvc原本的配置，比如覆盖yml里面的配置。</p>
<p>办法3、另外一种解决办法，就是继承<code>WebMvcConfigurationSupport</code>后，重写下面的方法，重新配置静态资源：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line"> registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(</span><br><span class="line">         <span class="string">&quot;classpath:/static/&quot;</span>);</span><br><span class="line"> registry.addResourceHandler(<span class="string">&quot;swagger-ui.html&quot;</span>).addResourceLocations(</span><br><span class="line">         <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line"> registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>).addResourceLocations(</span><br><span class="line">         <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line"> <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>按上面三种方法排查，404错误基本可以得到解决了。 重新启动服务器，你会发现那个绿黄绿黄的swagger页面又出现了。</p>
<p>404错误github参考：<a href="https://github.com/springfox/springfox/issues/776">https://github.com/springfox/springfox/issues/776</a></p>
<h4 id="补充（2020-05-13）"><a href="#补充（2020-05-13）" class="headerlink" title="补充（2020-05-13）"></a>补充（2020-05-13）</h4><p>笔者正在做的一个项目，引入了springfox-swagger2后，按照上面三个步骤检测了，swagger-ui.html页面依然404，后来排查发现，springfox-swagger-ui这个包没有被依赖引入。 在pom.xml里面加上这个swagger ui的jar包引用就可以了。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>Swagger配置接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//配置了swagger的bean实例</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//RequestHandlerSelectors 指定要扫描的包</span></span><br><span class="line">                <span class="comment">//withMethodAnnotation:扫描方法上的注解</span></span><br><span class="line">                <span class="comment">// basePackage: 扫描指定的包</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.lin.controller&quot;</span>))</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//只能搜索到localhost；8080：/lin下面的</span></span><br><span class="line">                .paths(PathSelectors.ant(<span class="string">&quot;/lin/**&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>我只希望我的swagger在生产环境中使用，在发布的时候不使用。</p>
<ul>
<li>判断是不是生产环境 flag&#x3D;false</li>
<li>注入enable</li>
</ul>
<p>配置api分组</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.groupName(&quot;lin y&quot;)</span><br></pre></td></tr></table></figure>

<p>如何配置多个分组</p>
]]></content>
      <categories>
        <category>spring</category>
      </categories>
  </entry>
  <entry>
    <title>vue_1.5</title>
    <url>/2023/04/17/vue_1.5/</url>
    <content><![CDATA[<h1 id="事件机制和事件-x2F-按键修饰符和过滤器及监听属性"><a href="#事件机制和事件-x2F-按键修饰符和过滤器及监听属性" class="headerlink" title="事件机制和事件&#x2F;按键修饰符和过滤器及监听属性"></a>事件机制和事件&#x2F;按键修饰符和过滤器及监听属性</h1><p>绑定事件监听器。事件类型由参数指定。表达式可以是一个方法的名字或一个内联语句，如果没有修饰符也可以省略。</p>
<p>用在普通元素上时，只能监听原生DOM事件。用在自定义元素组件上时，也可以监听子组件触发的自定义事件。</p>
<h3 id="绑定事件机制"><a href="#绑定事件机制" class="headerlink" title="绑定事件机制"></a>绑定事件机制</h3><p>Vue中提供了v-on：绑定事件机制（冒号后面跟着事件名称）</p>
<img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230417174347502.png" alt="image-20230417174347502" style="zoom: 67%;" />

<h4 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.stop - 调用 event.stopPropagation()。 <span class="comment">// 阻止冒泡</span></span><br><span class="line">.prevent - 调用 event.preventDefault()。<span class="comment">// 组织默认事件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//capture添加事件侦听器时使用事件捕获模式 //事件触发顺序从外往里</span></span><br><span class="line">.capture - 添加事件侦听器时使用 capture 模式。 </span><br><span class="line"></span><br><span class="line"><span class="comment">// 只会组织自己身上冒泡行为的触发, 并不会真正阻止冒泡的行为</span></span><br><span class="line"><span class="comment">// self实现只有点击当前元素时候,才会触发事件处理函数</span></span><br><span class="line">.self - 只当事件是从侦听器绑定的元素本身触发时才触发回调。 </span><br><span class="line"></span><br><span class="line">.&#123;keyCode | keyAlias&#125; - 只当事件是从特定键触发时才触发回调。</span><br><span class="line">.<span class="keyword">native</span> - 监听组件根元素的原生事件。</span><br><span class="line">.once - 只触发一次回调。</span><br><span class="line">.left - (<span class="number">2.2</span><span class="number">.0</span>) 只当点击鼠标左键时触发。</span><br><span class="line">.right - (<span class="number">2.2</span><span class="number">.0</span>) 只当点击鼠标右键时触发。</span><br><span class="line">.middle - (<span class="number">2.2</span><span class="number">.0</span>) 只当点击鼠标中键时触发。</span><br><span class="line">.passive - (<span class="number">2.3</span><span class="number">.0</span>) 以 &#123; passive: <span class="literal">true</span> &#125; 模式添加侦听器</span><br><span class="line">使用方式: </span><br><span class="line">&lt;p <span class="meta">@click</span>.stop=<span class="string">&quot;add&quot;</span>&gt;&lt;/p&gt; <span class="comment">// @事件.事件修饰符</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h4><ul>
<li>自定义全局按键修饰符</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 全局按键修饰符(所有的Vue实例都能调用)定义语法</span></span><br><span class="line">创建方式：</span><br><span class="line"><span class="comment">// F2是定义键盘上的按键名称，等于号后面是对应的键盘码码值</span></span><br><span class="line">Vue.config.keycodes.F2 = <span class="number">113</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>Vue官方提供的按键修饰符</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 为了在必要的情况下支持旧浏览器，Vue 提供了绝大多数常用的按键码的别名：</span></span><br><span class="line">.enter <span class="comment">// 回车键抬起</span></span><br><span class="line">.tab <span class="comment">// tab切换键抬起</span></span><br><span class="line">.delete (捕获“删除”和“退格”键)</span><br><span class="line">.esc <span class="comment">//退出键抬起</span></span><br><span class="line">.space <span class="comment">// 空格键抬起</span></span><br><span class="line">.up <span class="comment">// 上</span></span><br><span class="line">.down <span class="comment">// 下</span></span><br><span class="line">.left <span class="comment">// 左</span></span><br><span class="line">.right <span class="comment">// 右</span></span><br><span class="line">.对应键盘码 <span class="comment">// 使用键盘码是要注意如果不是以上对应的键盘修饰符，需要创建按键修饰符</span></span><br><span class="line">使用方式:</span><br><span class="line">&lt;p <span class="meta">@keyup</span>.enter=<span class="string">&quot;add&quot;</span>&gt;&lt;/p&gt; <span class="comment">// @click.按键修饰符</span></span><br><span class="line">&lt;p <span class="meta">@keyup</span><span class="number">.13</span>=<span class="string">&quot;add&quot;</span>&gt;&lt;/p&gt; <span class="comment">// @click.对应键盘码</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="Vue中的过滤器"><a href="#Vue中的过滤器" class="headerlink" title="Vue中的过滤器"></a>Vue中的过滤器</h3><p>自定义过滤器,可被用作于常见的文本格式化,用在两个地方,mustachc插值和v-bind表达式,过滤器添加在JS表达式尾部,由”管道”符指示</p>
<p>过滤器调用的时候,采用就近原则,如果私有过滤器和全局过滤器名称一致,优先调用私有过滤器</p>
<p>过滤器调用时的格式</p>
<ul>
<li>自定义全局过滤器</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 注意: 函数内部第一个参数一定是你要过滤的这个msg</span></span><br><span class="line"><span class="comment">// 注意: 过滤器myFilter也可以进行传参</span></span><br><span class="line"><span class="comment">// 注意: 过滤器可以多次调用</span></span><br><span class="line">创建方式:  <span class="comment">// myFilter是过滤器的名字</span></span><br><span class="line">Vue.filter(<span class="string">&quot;myFilter&quot;</span>, function( msg )&#123;</span><br><span class="line">    <span class="keyword">return</span> msg.toUpperCase()</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>自定义局部过滤器</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">app</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    filters: &#123;</span><br><span class="line">        myFilter: function (val) &#123;</span><br><span class="line">            <span class="keyword">return</span> val.toUpperCase()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="Vue中的监听属性"><a href="#Vue中的监听属性" class="headerlink" title="Vue中的监听属性"></a>Vue中的监听属性</h3><h4 id="watch属性"><a href="#watch属性" class="headerlink" title="watch属性"></a>watch属性</h4><p>使用这个属性,可以监听data中数据的变化,然后触发这个watch中对应的属性处理函数</p>
<ul>
<li>监听属性</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// watch可以用来监视一些非DOM元素的改变, 这就是他的优势</span></span><br><span class="line"><span class="comment">// watch是一个对象, 键是需要观察的表达式, 值是对应的回调函数</span></span><br><span class="line"><span class="comment">// 主要用来监听某些特定数据的变化,从而进行某也具体的业务逻辑操作,可以看做是computed和methods的结合体</span></span><br><span class="line">使用方式:</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">app</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        count: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        <span class="comment">// 函数中有两个参数,一个是newVal, 一个是oldVal具体怎么用去看下官网 很简单</span></span><br><span class="line">        count: function () &#123;</span><br><span class="line">            console.log(<span class="string">&quot;当data中的count属性的值发生变化时被我监听到了&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 使用双向数据绑定count</span></span><br><span class="line">&lt;input &gt;&#123;&#123; count &#125;&#125;&lt;/input&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>监听路由 watch监视路由变化</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 路由身上有一个this.$router.path属性, 指向当前路由的地址</span></span><br><span class="line">使用方式: </span><br><span class="line"><span class="keyword">new</span> <span class="title class_">app</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        count: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        <span class="comment">// 函数中有两个参数,一个是newVal, 一个是oldVal具体怎么用去看下官网 很简单</span></span><br><span class="line">        <span class="string">&quot;$route.path&quot;</span>: function(newVal, oldVal)&#123;</span><br><span class="line">            <span class="comment">// 在这里我们就可根据路由的变化去做一些认证, 跳转页面等等的操作</span></span><br><span class="line">            console.log(`路由新地址$&#123;newVale&#125;---路由旧地址$&#123;oldVal&#125;`)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="computed属性"><a href="#computed属性" class="headerlink" title="computed属性"></a>computed属性</h4><p>在 computed 中,可以定一些属性, 这些属性叫做计算属性</p>
<p>计算属性的本质就是一个方法, 只不过我们在使用这些计算属性的时候是吧它们的名称直接当做属性来使用的, 并不会把计算属性当做方法去调用</p>
<p>computed属性的结果会被缓存, 除非依赖的响应式属性变化才会重新计算, 主要当做属性来使用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">使用方式:</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">app</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        count: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        countComputed () &#123;</span><br><span class="line">            <span class="keyword">return</span> count + <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        add () &#123;</span><br><span class="line">            count++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;button <span class="meta">@click</span>=add&gt;自增&lt;/button&gt; <span class="comment">// 点击按钮的的时候count自增加1 </span></span><br><span class="line">&lt;input&gt;&#123;&#123; countComputed &#125;&#125;&lt;/input&gt; <span class="comment">// countComputed属性的值永远依赖于count, 并且比它大1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意 : 计算属性在引用的时候一定不要加()去调用,直接把它当做普通属性去引用就好</span></span><br><span class="line"><span class="comment">// 注意 : 计算属性这个function内部所用到的任何data中的数据发生了变化,就会立即重新计算这个计算属性的值</span></span><br><span class="line"><span class="comment">// 注意 : 计算属性的求值结果会被缓存起来, 方便下次直接使用</span></span><br><span class="line"><span class="comment">// 注意 : 如果计算属性方法中, 所依赖的任何数据,都没有发生任何变化,则不会重新对计算属性求值</span></span><br></pre></td></tr></table></figure>

<h1 id="Vue实例的生命周期"><a href="#Vue实例的生命周期" class="headerlink" title="Vue实例的生命周期"></a>Vue实例的生命周期</h1><p>生命周期钩子 &#x3D; 生命周期函数 &#x3D; 生命周期事件</p>
<h3 id="实例创建期间的生命周期函数"><a href="#实例创建期间的生命周期函数" class="headerlink" title="实例创建期间的生命周期函数"></a>实例创建期间的生命周期函数</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 刚初始化了一个空的实例对象, 这时候只有默认的一些生命周期函数和默认事件, 其他都未创建。</span></span><br><span class="line"><span class="comment">// 如果要调用 methods 中的方法, 或者操作 data 中的数据, 最早只能在 created 生命周期函数中操作</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="comment">// 在这个生命周期函数执行的时候,data和methods中的数据都还没有初始化</span></span><br><span class="line">    beforeCreate () &#123;&#125;, <span class="comment">// 表示实例完全被创建之前, 会执行这个函数</span></span><br><span class="line">    <span class="comment">// 在这个生命周期函数执行的时候,data和methods中的数据都已经初始化好了</span></span><br><span class="line">    created () &#123;&#125; <span class="comment">// 表示实例被创建之后, 会执行这个函数</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>查看Vue生命周期图例, 这里表示Vue开始编译模板, 把Vue代码中的那些指令进行执行, 最终在内存中生成一个编译好的最终模板字符串, 然后把这个字符串渲染为内存中的DOM,此时, 只是在内存中渲染好了模板, 并没有把模板挂载到真正的页面中。</p>
<h3 id="运行期间的生命周期函数"><a href="#运行期间的生命周期函数" class="headerlink" title="运行期间的生命周期函数"></a>运行期间的生命周期函数</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="comment">// 在这个生命周期函数执行的时候,页面中的元素还没有被真正的替换过来,只是之前写的一些模板字符串</span></span><br><span class="line">    beforeMounted () &#123;&#125;, <span class="comment">// 表示模板已经编译完成,但是还没有把模板渲染到页面中</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 表示模板已经编译完成,内存中的模板已经真实的渲染到了页面中去,已经可以看到渲染好的页面了</span></span><br><span class="line">    <span class="comment">// 注意: mounted是实例创建期间的最后一个生命周期函数,当执行完mounted生命周期函数就表示,</span></span><br><span class="line">    <span class="comment">// 实例已经被完全创建好了,此时如果没有其他操作的话,这个实例就在内存中一动不动</span></span><br><span class="line">    <span class="comment">// 注意: 如果要通过某些插件操作页面上的DOM节点,最早要在mounted生命周期中操作</span></span><br><span class="line">    mounted () &#123;&#125; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 上面的是组件的创建阶段,接下来进入组件的运行阶段</span></span><br><span class="line">    <span class="comment">// 在这个生命周期函数执行的时候,页面中显示的数据还是旧的,但是data中的数据是最新的,</span></span><br><span class="line">    <span class="comment">// 页面尚未和最新的数据保持同步</span></span><br><span class="line">    beforeUpdate () &#123;&#125; <span class="comment">// 表示当前界面还没有被更新,数据肯定被更新了</span></span><br><span class="line">    <span class="comment">// 查看Vue生命周期图例,这里表示先根据data中最新的数据在内存中重新渲染出一份最新的内存DOM树当最新的</span></span><br><span class="line">    <span class="comment">// 内存DOM树更新之后会把最新的内存DOM树重新渲染到真实的页面中去这时候就完成了数据从data(model层)</span></span><br><span class="line">    <span class="comment">// 到view(视图层)的更新</span></span><br><span class="line">    updated () &#123;&#125; <span class="comment">// 表示当前页面和数据保持同步了,都是最新的</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="销毁期间的生命周期函数"><a href="#销毁期间的生命周期函数" class="headerlink" title="销毁期间的生命周期函数"></a>销毁期间的生命周期函数</h3><p>走到这里已经进入组件的销毁阶段了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="comment">// 在这个生命周期函数执行的时候.实例身上所有的data和methods以及过滤器、指令等等都是可用状态,还没有</span></span><br><span class="line">    真正的执行销毁的过程</span><br><span class="line">    beforeDestroy () &#123;&#125;, <span class="comment">// 表示Vue实例已经从运行阶段进入到销毁阶段</span></span><br><span class="line">    <span class="comment">// 在这个生命周期函执行的时候,组件中的data和methods以及过滤器、指令等等都已经不可用了</span></span><br><span class="line">    destroyed()&#123;&#125; <span class="comment">// 表示组件已经完全被销毁了</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h1 id="Vue中的动画"><a href="#Vue中的动画" class="headerlink" title="Vue中的动画"></a>Vue中的动画</h1><p>Vue 在插入、更新或者移除 DOM 时，提供多种不同方式的应用过渡效果。 包括以下工具：</p>
<ul>
<li>在 CSS 过渡和动画中自动应用 class</li>
<li>可以配合使用第三方 CSS 动画库，如 Animate.css</li>
<li>在过渡钩子函数中使用 JavaScript 直接操作 DOM</li>
<li>可以配合使用第三方 JavaScript 动画库，如 Velocity.js</li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue_1</title>
    <url>/2023/04/17/vue-1/</url>
    <content><![CDATA[<blockquote>
<p>Vue (读音 &#x2F;vjuː&#x2F;，类似于 <strong>view</strong>) 是一套用于构建用户界面的<strong>渐进式框架</strong>。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与<a href="https://v2.cn.vuejs.org/v2/guide/single-file-components.html">现代化的工具链</a>以及各种<a href="https://github.com/vuejs/awesome-vue#libraries--plugins">支持类库</a>结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。</p>
</blockquote>
<h2 id="什么是vue"><a href="#什么是vue" class="headerlink" title="什么是vue"></a>什么是vue</h2><p>vue中文文档<a href="https://v2.cn.vuejs.org/v2/guide/">介绍 — Vue.js (vuejs.org)</a></p>
<h3 id="什么是MVVM模式"><a href="#什么是MVVM模式" class="headerlink" title="什么是MVVM模式"></a>什么是MVVM模式</h3><p>MVVM 是Model-View-ViewModel 的缩写，它是一种基于前端开发的架构模式，其核心是提供对View 和 ViewModel 的双向数据绑定，这使得ViewModel 的状态改变可以自动传递给 View，即所谓的数据双向绑定。</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">其中 M 层 是vue中的data, V层是el绑定的HTML元素, VM是<span class="keyword">new</span>实例的vue</span><br></pre></td></tr></table></figure>

<h3 id="导入-vue-创建一个VM-实例-传入配置对象-了解配置对象中的各个属性"><a href="#导入-vue-创建一个VM-实例-传入配置对象-了解配置对象中的各个属性" class="headerlink" title="导入 vue 创建一个VM 实例, 传入配置对象, 了解配置对象中的各个属性"></a>导入 vue 创建一个VM 实例, 传入配置对象, 了解配置对象中的各个属性</h3><p>我们在页面中通过script标签引入我们需要的vue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">  &#123;&#123; message &#125;&#125;  // 通过差值表达式的方式将数据渲染到页面</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">var VM = new Vue(&#123;</span><br><span class="line">  el: &#x27;#app&#x27;, // 表示当我们new的这个Vue实例, 要控制页面上的那个区域</span><br><span class="line">  data: &#123; // data属性中，存放的是el中要用到的数据,这里的data就是MVVM中的M专门用来保存每个页面的数据</span><br><span class="line">    message: &#x27;Hello Vue!&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods : &#123;&#125;, // 这个methods属性中定义了当前Vue实例所有可用的方法,主要写业务逻辑</span><br><span class="line">  computed: &#123;&#125;, // 在computed中,可以定一些属性, 这些属性叫做计算属性,计算属性的本质就是一个方法,只不过我们在使用这些计算属性的时候是吧它们的名称直接当做属性来使用的,并不会把计算属性当做方法去调用</span><br><span class="line">  filters : &#123;&#125;, // 这个filters属性中定义了当前Vue实例中所有可用的过滤的方法 </span><br><span class="line">  watch: &#123;&#125;, // 使用这个属性,可以监听data中数据的变化,然后触发这个watch中对应的function处理函数</span><br><span class="line">  router, // 挂载路由对象</span><br><span class="line">  directives：&#123;&#125;, // 这个directives属性定义了当前Vue实例中所有可用的自定义指令</span><br><span class="line">  beforeCreate () &#123;&#125;, // 生命周期函数: 表示实例完全被创建之前,会执行这个函数</span><br><span class="line">  created () &#123;&#125;, // 生命周期函数: 表示实例被创建之后</span><br><span class="line">  beforeMounted () &#123;&#125;, // 生命周期函数: 表示模板已经编译完成,但是还没有把模板渲染到页面中</span><br><span class="line">  mounted () &#123;&#125;, // 生命周期函数:表示模板已经编译完成,内存中的模板已经真实的渲染到了页面中去,已经可以看到渲染好的页面了</span><br><span class="line">  beforeUpdate () &#123;&#125;, // 生命周期函数: 表示当前界面还没有被更新,数据肯定被更新了</span><br><span class="line">  update () &#123;&#125;, // 生命周期函数: 表示当前页面和数据保持同步了,都是最新的</span><br><span class="line">  beforeDestroy () &#123;&#125;, // 生命周期函数: 表示Vue实例已经从运行阶段进入到销毁阶段</span><br><span class="line">  destroyed () &#123;&#125; // 生命周期函数: 表示组件已经完全被销毁了</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="自定义全局和局部指令"><a href="#自定义全局和局部指令" class="headerlink" title="自定义全局和局部指令"></a>自定义全局和局部指令</h2><h2 id="第二章-学习vue中的自定义指令"><a href="#第二章-学习vue中的自定义指令" class="headerlink" title="第二章 学习vue中的自定义指令"></a>第二章 学习vue中的自定义指令</h2><p>自定义指令在我们的项目中很常用, 所以要认真学习。</p>
<h3 id="第一部分-使用Vue-directive-自定义全局的指令"><a href="#第一部分-使用Vue-directive-自定义全局的指令" class="headerlink" title="第一部分: 使用Vue.directive()自定义全局的指令"></a>第一部分: 使用Vue.directive()自定义全局的指令</h3><p><strong>注意 :</strong> 参数 1 是指令的名称, 在自定义指令的时候, 指令的名称前面不需要加 “v-“前缀</p>
<p><strong>注意 :</strong> 参数 2 是一个对象, 对象身上有一些指令的相关函数, 这些函数可以在特定的阶段, 执行相关的操作句号</p>
<p><strong>注意 :</strong> 在参数 2 中的相关函数中,第一个参数，永远是el,表示被绑定了指令的那个元素，这个el参数，是一个原生的js对象</p>
<p><strong>注意 :</strong> 在参数 2 中的相关函数中,都有一个binding参数，是一个对象，它包含以下属性：name&#x2F;指令名，value&#x2F;指令的绑定值（例如v-mydirective&#x3D;”‘red’”）值就为red，剩下的属性去看官网用的少 同样导入vue, 创建VM实例对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  &#123;&#123; message &#125;&#125;  // 通过差值表达式的方式将数据渲染到页面</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">VM</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">// 表示当我们new的这个Vue实例, 要控制页面上的那个区域</span></span><br><span class="line">    <span class="attr">data</span>: &#123; <span class="comment">// data属性中存放的是el中要用到的数据,这里的data就是MVVM中的M专门用来保存每个页面的数据</span></span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Hello Vue!&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 自定义指令方法：</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(“指令名称”，&#123; </span><br><span class="line">    <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;, </span><br><span class="line">    <span class="attr">inserted</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;, </span><br><span class="line">    <span class="attr">updata</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>自定义指令中的bind函数</strong></p>
<p>每当指令绑定到元素上的之后，会立即执行这个bind函数，只执行一次</p>
<p><strong>注意 :</strong> 和样式相关的操作，一般都可以在bind执行，只要通过指令绑定了元素，不管这个元素有没有被插入到页面中去，这个元素肯定有了一个内联样式。</p>
<p>将来元素肯定会显示页面中去，这时候，浏览器的渲染引擎必然会解析样式，应用给这个元素</p>
<p><strong>注意 :</strong> 在元素干绑定了指令的时候，还没有插入到DOM中去，这时候调用例如：el.focus（获取焦点）等js行为相关的操作，需要在inserted方法中去执行，防止js行为不生效</p>
<p>因为一个元素, 只有在插入DOM之后, 才能操作他的js行为</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 举例</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(“color”，&#123; </span><br><span class="line">    <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params">el, binding</span>)&#123;</span><br><span class="line">        <span class="comment">//这个指令绑定的样式颜色是固定死的，我们可以通过指令的绑定值来动态改变样式颜色</span></span><br><span class="line">        el.<span class="property">style</span>.<span class="property">color</span> =<span class="string">&quot;red&quot;</span> </span><br><span class="line">    &#125;, </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 需要注意: 指令绑定的值如果不是字符串而是一个变量，就需要你在data中定义这个变量的值</span></span><br><span class="line"><span class="comment">// 下面展示通过使用指令传入的颜色来来定义绑定标签的颜色</span></span><br><span class="line">&lt;p v-color=<span class="string">&quot; &#x27;red&#x27; &quot;</span>&gt;&lt;/p&gt; </span><br><span class="line">定义指令：<span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&quot; color &quot;</span>,&#123; </span><br><span class="line">    <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params">el, binding</span>)&#123; </span><br><span class="line">        el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span> </span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 在自定义局部指令的时候, 我们也可以通过给v-color绑定一个变量, 通过动态改变变量的值来控制标签的颜色 </span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>自定义指令中的inserted函数</strong></p>
<p>表示元素插入到DOM中的时候会执行inserted函数（触发一次）</p>
<p><strong>注意 :</strong> 和js行为相关的操作，需要在inserted方法中去执行，防止js行为不生效</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 例如: </span></span><br><span class="line">&lt;p v-color=<span class="string">&quot; &#x27;red&#x27; &quot;</span>&gt;&lt;/p&gt; </span><br><span class="line">定义指令：<span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&quot; color &quot;</span>,&#123; </span><br><span class="line">    <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params">el, binding</span>)&#123; </span><br><span class="line">        el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span> <span class="comment">// 设置绑定该指令的标签颜色</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">inserted</span>: <span class="keyword">function</span>(<span class="params">el, binding</span>)&#123; </span><br><span class="line">        el.<span class="title function_">focus</span>()  <span class="comment">// 在这里执行获取焦点才管用</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>自定义指令中的updata函数</strong></p>
<p>当组件更新的时候, 会执行updata函数, 可能会多次触发</p>
<h3 id="第二部分-使用Vue-directive-自定义全局的指令"><a href="#第二部分-使用Vue-directive-自定义全局的指令" class="headerlink" title="第二部分: 使用Vue.directive()自定义全局的指令"></a>第二部分: 使用Vue.directive()自定义全局的指令</h3><p>使用方法和上面的全局指令一样。只是自定义局部指令需要在VM实例中定义</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">例如:</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  &#123;&#123; message &#125;&#125;  // 通过差值表达式的方式将数据渲染到页面</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">VM</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">// 表示当我们new的这个Vue实例, 要控制页面上的那个区域</span></span><br><span class="line">    <span class="attr">data</span>: &#123; <span class="comment">// data属性中存放的是el中要用到的数据,这里的data就是MVVM中的M专门用来保存每个页面的数据</span></span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Hello Vue!&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 自定义局部指令</span></span><br><span class="line">    <span class="attr">directives</span>: &#123;</span><br><span class="line">        <span class="string">&quot;color&quot;</span>:&#123;</span><br><span class="line">           <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;, </span><br><span class="line">           <span class="attr">inserted</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;, </span><br><span class="line">           <span class="attr">updata</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 下面这个是简写方式: 简写的function等同于把代码写到了bind和updata函数中</span></span><br><span class="line">        <span class="attr">color</span>: <span class="keyword">function</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">            el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Vue官方提供的指令"><a href="#Vue官方提供的指令" class="headerlink" title="Vue官方提供的指令"></a>Vue官方提供的指令</h2><h2 id="第三章-学习vue中的指令"><a href="#第三章-学习vue中的指令" class="headerlink" title="第三章 学习vue中的指令"></a>第三章 学习vue中的指令</h2><p>vue官方为我们提供了很多它自己原生的指令, 工作项目中会经常用到,这里我先为大家讲解几个基础的指令</p>
<h3 id="v-cloak指令"><a href="#v-cloak指令" class="headerlink" title="v-cloak指令"></a>v-cloak指令</h3><p>使用v-cloak指令能够解决差值表达式闪烁的问题</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// 需要在样式中设置以下样式</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-attr">[v-cloak]</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 使用方式: 在我们使用差值表达式的标签添加该指令</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-cloak</span>&gt;</span>&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-text指令"><a href="#v-text指令" class="headerlink" title="v-text指令"></a>v-text指令</h3><p>v-text 是没有闪烁的问题 但是 v-text 会覆盖元素中原本的内容，但是差值表达式只会替换自己的这个占位符，不会把整个元素的内容清空</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">使用方式:</span><br><span class="line">&lt;p v-text&gt;&#123;&#123; msg &#125;&#125;&lt;/<span class="selector-tag">p</span>&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-html指令"><a href="#v-html指令" class="headerlink" title="v-html指令"></a>v-html指令</h3><p>v-html 会解析标签，以上两种不会，它也会更改元素中原本的内容</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">使用方式：</span><br><span class="line">new app(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">&quot;&lt;h1&gt;我是一个标签元素&lt;/h1&gt;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;<span class="selector-tag">p</span> v-<span class="selector-tag">html</span>=&quot;msg&quot;&gt;&lt;/<span class="selector-tag">p</span>&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-bind指令"><a href="#v-bind指令" class="headerlink" title="v-bind指令"></a>v-bind指令</h3><ul>
<li>v-bind： 是Vue中，提供的用来绑定属性的指令,只能实现数据的单向绑定,从M自动绑定到V,无法实现数据的双向绑定。</li>
<li>注意：v-bind： 指令可以被简写为 ：要绑定的属性</li>
<li>v-bind 中可以写合法的js表达式</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">// 使用方式:</span><br><span class="line">&lt;p v-bind:<span class="attr">title</span>=<span class="string">&quot;msg&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">简写方式:</span><br><span class="line">&lt;p :<span class="attr">title</span>=<span class="string">&quot;msg&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">// 属性中写js表达式</span><br><span class="line">&lt;p v-bind:<span class="attr">title</span>=<span class="string">&quot;msg+&#x27;合法表达式&#x27;&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="绑定class属性的用法"><a href="#绑定class属性的用法" class="headerlink" title="绑定class属性的用法"></a>绑定class属性的用法</h4><ul>
<li>数组的写法</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 直接传递一个数组, 数组里面的类名要写字符串, 注意:这里的class需要使用v-bind做数据绑定</span></span><br><span class="line">使用方式：</span><br><span class="line">&lt;p :<span class="keyword">class</span>=<span class="string">&quot;[&#x27;thin&#x27;, &#x27;italic&#x27;]&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>数组中嵌套对象</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组中推荐使用这种方式</span></span><br><span class="line">使用方式：</span><br><span class="line">&lt;p :<span class="keyword">class</span>=<span class="string">&quot;[&#x27;thin&#x27;, &#x27;italic&#x27;,&#123;&#x27;active&#x27;:flag&#125;]&quot;</span>&gt;&lt;/p&gt; <span class="comment">// 这里的flag在data中定义, 是一个布尔值</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>数组中使用三元表达式</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">// data中定义一个布尔值类型的flag,在数组中用三元表示来显示这个flag</span></span><br><span class="line">使用方式：</span><br><span class="line">&lt;p :<span class="keyword">class</span>=<span class="string">&quot;[&#x27;thin&#x27;, &#x27;italic&#x27;, flag ? &#x27;active&#x27;:&#x27;noactive&#x27;]&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>直接使用对象</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在为class使用v-bind绑定对象的时候,对象的属性是类型,</span></span><br><span class="line"><span class="comment">// 由于对象的属性可带可不带引号,写法自己决定, 属性的值是一个标识符</span></span><br><span class="line">使用方式: </span><br><span class="line">&lt;p :<span class="class"><span class="keyword">class</span>=&quot;</span>&#123;thin: <span class="literal">true</span>, italic: <span class="literal">true</span>, active: <span class="literal">false</span>&#125;<span class="string">&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">复制代码</span></span><br></pre></td></tr></table></figure>

<h4 id="绑定style属性的用法"><a href="#绑定style属性的用法" class="headerlink" title="绑定style属性的用法"></a>绑定style属性的用法</h4><ul>
<li>直接在标签上通过 :style 的形式书写</li>
</ul>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 对象就是无序键值对的集合</span></span><br><span class="line">使用方式：</span><br><span class="line">&lt;p :style=&quot;&#123;<span class="attribute">color</span>:<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;font-weight&#x27;</span>:<span class="number">200</span>&#125;&quot;&gt;&lt;/<span class="selector-tag">p</span>&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>将样式定义在data中, 在:style绑定的标签中引用</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先将样式定义在data中的一个变量身上</span></span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">styleObject</span>: &#123;<span class="attr">color</span>:<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;font-weight&#x27;</span>:<span class="number">200</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 在标签上,通过属性绑定的形式,将样式对象应用到元素中</span></span><br><span class="line">&lt;p :style=<span class="string">&quot;styleObject&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>在 :style 中通过数组, 引用多个 data 上的样式对象</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先将样式定义在data中的一个变量身上</span></span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">styleObject1</span>: &#123;<span class="attr">color</span>:<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;font-weight&#x27;</span>:<span class="number">200</span>&#125;,</span><br><span class="line">        <span class="attr">styleObject2</span>: &#123;<span class="attr">color</span>:<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;font-weight&#x27;</span>:<span class="number">200</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 在标签上,通过属性绑定的形式,将样式对象应用到元素中</span></span><br><span class="line">使用方式：</span><br><span class="line">&lt;p :style=<span class="string">&quot;[styleObject1, styleObject2]&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-model指令"><a href="#v-model指令" class="headerlink" title="v-model指令"></a>v-model指令</h3><p>Vue中唯一一个实现双向数据绑定的指令, <strong>注意 : 只能运用到表单元素中</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">使用方式:</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;msg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span> <span class="comment">// 修改imput输入框的值, 下面p标签绑定的内容会随之改变</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-for指令"><a href="#v-for指令" class="headerlink" title="v-for指令"></a>v-for指令</h3><ul>
<li>在使用 v-for 指令的时候<strong>要注意加上 key 属性</strong></li>
<li>Vue2.2以后的版本规定,当前组件使用v-for循环的时候, 或者在一些特殊情况中, 如果v-for有问题, 必须在使用v-for的同时, 指定唯一的字符串&#x2F;数组类型 :key值。</li>
<li>v-for&#x3D;”(val, key) in list” &#x2F;&#x2F; <strong>in 后面可以放普通数组, 对象数组, 对象, 还可以放数字</strong></li>
</ul>
<h4 id="迭代数组"><a href="#迭代数组" class="headerlink" title="迭代数组"></a>迭代数组</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先在data上定义一个数组</span></span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">list</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">使用方式：item是循环的每一项,<span class="keyword">list</span>是循环的数组,index是索引值</span><br><span class="line">&lt;li v-<span class="keyword">for</span>=<span class="string">&quot;(item, index)in list&quot;</span> :key=<span class="string">&quot;index&quot;</span>&gt;&#123;&#123;index&#125;&#125;~~~&#123;&#123;item&#125;&#125;&lt;/li&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="迭代对象数组"><a href="#迭代对象数组" class="headerlink" title="迭代对象数组"></a>迭代对象数组</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">list</span>:[&#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">name</span>:<span class="string">&#x27;tank1&#x27;</span>&#125;, &#123;<span class="attr">id</span>:<span class="number">2</span>,<span class="attr">name</span>:<span class="string">&#x27;tank2&#x27;</span>&#125;, &#123;<span class="attr">id</span>:<span class="number">3</span>,<span class="attr">name</span>:<span class="string">&#x27;tank3&#x27;</span>&#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">使用方式：</span><br><span class="line">&lt;li v-<span class="keyword">for</span>=<span class="string">&quot;(item, index)in list&quot;</span> :key=<span class="string">&quot;index&quot;</span>&gt;</span><br><span class="line">  id:&#123;&#123;item.id&#125;&#125; --- 名字:&#123;&#123;item.name&#125;&#125; --- 索引&#123;&#123;index&#125;&#125;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="迭代对象"><a href="#迭代对象" class="headerlink" title="迭代对象"></a>迭代对象</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">list</span>: &#123;</span><br><span class="line">            <span class="attr">name1</span>: <span class="string">&quot;abc1&quot;</span>,</span><br><span class="line">            <span class="attr">name2</span>: <span class="string">&quot;abc2&quot;</span>,</span><br><span class="line">            <span class="attr">name3</span>: <span class="string">&quot;abc3&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">使用方式：在遍历对象身上的键值对的时候.除了有val、key, 在第三个位置还有一个索引index, 索引基本用不到</span><br><span class="line">&lt;li v-<span class="keyword">for</span>=<span class="string">&quot;(val, key, index) in list&quot;</span> :key=<span class="string">&quot;index&quot;</span>&gt;</span><br><span class="line">    值是:&#123;&#123; val &#125;&#125; --- 键是: &#123;&#123;key&#125;&#125; --- 索引&#123;&#123;index&#125;&#125;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h4 id="迭代数字"><a href="#迭代数字" class="headerlink" title="迭代数字"></a>迭代数字</h4><p>如果使用v-for迭代数字,前面的 count 从 1 开始</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">使用方式：</span><br><span class="line">&lt;<span class="selector-tag">li</span> v-for=&quot;(count, index) in <span class="number">10</span>&quot; :key=<span class="string">&quot;index&quot;</span>&gt;这是第 &#123;&#123;count&#125;&#125; 次循环&lt;/<span class="selector-tag">li</span>&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="v-if-和-v-else-和-v-else-if-还有-v-show指令"><a href="#v-if-和-v-else-和-v-else-if-还有-v-show指令" class="headerlink" title="v-if 和 v-else 和 v-else-if 还有 v-show指令"></a>v-if 和 v-else 和 v-else-if 还有 v-show指令</h3><p>如果元素涉及到频繁的切换,最好不要使用 v-if 而推荐使用 v-show</p>
<p>如果元素可能不太频繁被显示出来被用户看,推荐用 v-if 和 v-else</p>
<ul>
<li>v-if 和 v-else</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// v-if 的特点: 每次都会重新删除或创建元素</span></span><br><span class="line"><span class="comment">// v-if 有较高的切换性能消耗</span></span><br><span class="line"><span class="comment">// v-else 元素必须紧跟在带 v-if 或者 v-else-if 的元素的后面，否则它将不会被识别。</span></span><br><span class="line">使用方式：</span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">app</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">flag</span>: <span class="literal">true</span> // 定义一个变量为布尔值类型</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;p v-<span class="keyword">if</span>=<span class="string">&quot;flag&quot;</span>&gt;我在flag为<span class="literal">true</span>的时候显示&lt;/p&gt;  </span><br><span class="line">&lt;p v-<span class="keyword">else</span>&gt;我在flag不为<span class="literal">true</span>的时候显示&lt;/p&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>v-show</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> v<span class="operator">-</span><span class="keyword">show</span>的特点: 每次不会重新进行DOM的删除和创建,只是切换了元素的display:<span class="keyword">none</span>样式</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> v<span class="operator">-</span><span class="keyword">show</span>有较高的初始渲染消耗</span><br><span class="line">使用方式：</span><br><span class="line"><span class="operator">&lt;</span>p v<span class="operator">-</span><span class="keyword">show</span><span class="operator">=</span>&quot;flag&quot;<span class="operator">&gt;</span>我在flag为<span class="literal">true</span>的时候显示<span class="operator">&lt;</span><span class="operator">/</span>p<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vuex</tag>
        <tag>vue router</tag>
        <tag>vue aixos</tag>
      </tags>
  </entry>
  <entry>
    <title>vue_4</title>
    <url>/2023/04/17/vue_4/</url>
    <content><![CDATA[<h1 id="Vue中跨域以及打包部署到nginx跨域设置"><a href="#Vue中跨域以及打包部署到nginx跨域设置" class="headerlink" title="Vue中跨域以及打包部署到nginx跨域设置"></a>Vue中跨域以及打包部署到nginx跨域设置</h1><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>众所周知,我们在做前后端分离项目的时候,经常需要在本地起前端工程,接口希望拉取服务端的实际数据而不是本地的mock数据,而如果本地程序直接访问远程接口， 肯定会遇到跨域问题。</p>
<h3 id="什么是跨域-实现跨域的多种方式"><a href="#什么是跨域-实现跨域的多种方式" class="headerlink" title="什么是跨域?实现跨域的多种方式?"></a>什么是跨域?实现跨域的多种方式?</h3><p>这里我就不详细介绍了,大家自行百度哈</p>
<h3 id="为什么要实现前端跨域"><a href="#为什么要实现前端跨域" class="headerlink" title="为什么要实现前端跨域"></a>为什么要实现前端跨域</h3><p>一般来讲,前后端分离的项目在大公司都会由后台设置允许跨域访问,因为后台设置允许跨域是很简单和方便的,但是某些情况下,一些小公司或者你工作的场所后台不怎么配合的情况下,这就需要前端来配置跨域请求来方便我们使用接口</p>
<h4 id="vue项目中的配置"><a href="#vue项目中的配置" class="headerlink" title="vue项目中的配置"></a>vue项目中的配置</h4><p>以vue-cli搭建的项目为例, 在webpack配置文件 &#x2F;config&#x2F;index.js, 由于我们是在<strong>开发环境</strong>下使用，自然而然是要配置在dev里面,找到 proxyTable属性,配置如下:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">  <span class="symbol">dev:</span> &#123;</span><br><span class="line">    <span class="regexp">//</span> Paths</span><br><span class="line">    <span class="symbol">assetsSubDirectory:</span> <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">    <span class="symbol">assetsPublicPath:</span> <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    &lt;!-- 使用proxyTable进行跨域设置 --&gt;</span><br><span class="line">    <span class="symbol">proxyTable:</span> &#123;</span><br><span class="line">        <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">          <span class="symbol">target:</span> <span class="string">&#x27;http://www.abc.com&#x27;</span>,  <span class="regexp">//</span> 设置你调用的接口域名和端口号, 别忘了加http</span><br><span class="line">          <span class="symbol">changeOrigin:</span> <span class="literal">true</span>,  <span class="regexp">//</span> 是否跨域</span><br><span class="line">          <span class="symbol">pathRewrite:</span> &#123;</span><br><span class="line">              <span class="regexp">//</span> 这里理解成用<span class="string">&#x27;/api&#x27;</span>代替target里面的地址，后面组件中我们掉接口时直接用api代替 </span><br><span class="line">              /<span class="regexp">/ 比如我要调用&#x27;http:/</span><span class="regexp">/www.abc.com/user</span><span class="regexp">/add&#x27;，直接写&#x27;/api</span><span class="regexp">/user/add</span><span class="string">&#x27;即可&#x27;</span></span><br><span class="line">            <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> Various Dev Server settings</span><br><span class="line">    <span class="symbol">host:</span> <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="regexp">//</span> can be overwritten by process.env.<span class="variable constant_">HOST</span></span><br><span class="line">    <span class="symbol">port:</span> <span class="number">8080</span>, <span class="regexp">//</span> can be overwritten by process.env.<span class="variable constant_">PORT</span>, <span class="keyword">if</span> port is <span class="keyword">in</span> use, a free one will be determined</span><br><span class="line">    <span class="symbol">autoOpenBrowser:</span> <span class="literal">false</span>,</span><br><span class="line">    <span class="symbol">errorOverlay:</span> <span class="literal">true</span>,</span><br><span class="line">    <span class="symbol">notifyOnErrors:</span> <span class="literal">true</span>,</span><br><span class="line">    <span class="symbol">poll:</span> <span class="literal">false</span>, <span class="regexp">//</span> <span class="symbol">https:</span>/<span class="regexp">/webpack.js.org/configuration</span><span class="regexp">/dev-server/</span><span class="comment">#devserver-watchoptions-</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * Source Maps</span><br><span class="line">     *<span class="regexp">/</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ https:/</span><span class="regexp">/webpack.js.org/configuration</span><span class="regexp">/devtool/</span><span class="comment">#development</span></span><br><span class="line">    <span class="symbol">devtool:</span> <span class="string">&#x27;cheap-module-eval-source-map&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> If you have problems debugging vue-files <span class="keyword">in</span> devtools,</span><br><span class="line">    <span class="regexp">//</span> set this to <span class="literal">false</span> - it *may* help</span><br><span class="line">    /<span class="regexp">/ https:/</span><span class="regexp">/vue-loader.vuejs.org/en</span><span class="regexp">/options.html#cachebusting</span></span><br><span class="line"><span class="regexp">    cacheBusting: true,</span></span><br><span class="line"><span class="regexp">    cssSourceMap: true</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">复制代码</span></span><br></pre></td></tr></table></figure>

<p>上面proxyTable属性中的配置,效果就是将本地8080端口的一个请求代理到了<a href="https://link.juejin.cn/?target=http://www.abc.com%E8%BF%99%E4%B8%AA%E5%9F%9F%E5%90%8D%E4%B8%8B">www.abc.com这个域名下</a></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">&#x27;http://localhost:8080/api&#x27;</span> ===&gt; <span class="string">&#x27;http://www.abc.com/&#x27;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>注意: 以上设置只能在开发环境下使用,打包后会出现路径问题的</strong></p>
<p><strong>注意: Vue-cli提供的代理功能，只是让你在开发环境下使用的，它(http-server-middleware)依赖于node环境，生产代码应该使用npm run build然后把dist放到nginx服务器上，在nginx上配置代理地址</strong></p>
<h3 id="Vue项目部署到nginx上的跨域设置"><a href="#Vue项目部署到nginx上的跨域设置" class="headerlink" title="Vue项目部署到nginx上的跨域设置"></a>Vue项目部署到nginx上的跨域设置</h3><p>这还没完，现在我们要将项目部署到nginx上，此时原来可以访问的接口又访问不到了，所以这个时候还要对nginx进行设置。</p>
<h4 id="windows系统下载nginx"><a href="#windows系统下载nginx" class="headerlink" title="windows系统下载nginx"></a>windows系统下载nginx</h4><ul>
<li>下载地址: <a href="https://link.juejin.cn/?target=">nginx.org&#x2F;en&#x2F;docs&#x2F;win…</a> <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc6575b720869a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></li>
<li>选择download进去选择下载版本页面</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc659a612b0d6a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>这里选择稳定版下载即可</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc65a41d63927c~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>下载完成后目录如下</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc65b0d7726268~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>进入cong文件,打开nginx.congf文件,找到server对象里面的listen属性查看查看监听的端口号(默认80端口)</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc661d9b733d85~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>在nginx根目下启动nginx.exe,如果出现一个黑窗口一闪而过,说明启动成功,访问localhost:80出现此页面则访问成功</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc6652305c8b94~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"> <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc664a2f725353~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>如果访问不成功有可能是端口被占用,修改上面的端口号,重启nginx即可, 浏览器访问localhost:XXXX</li>
</ul>
<h4 id="Vue项目部署在nginx上的配置"><a href="#Vue项目部署在nginx上的配置" class="headerlink" title="Vue项目部署在nginx上的配置"></a>Vue项目部署在nginx上的配置</h4><ul>
<li>vue项目运行 npm run build 进行项目打包记得有本地静态资源文件的需要需要webpack配置, 如下:</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">config文件下的index.js文件找到build属性</span><br><span class="line">assetsPublicPath: <span class="string">&#x27;/&#x27;</span>   =&gt;&gt;&gt;&gt;&gt;   assetsPublicPath: <span class="string">&#x27;./&#x27;</span> </span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc6695ccab18fc~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">build文件下的untils文件中找到vue-style-loader</span><br><span class="line">增加 publicPath: <span class="string">&#x27;../../&#x27;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc66c364882a00~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>此时打包后的dist文件可以不放置服务器环境下访问, 直接打开dist文件目录下的index.html就可以打开访问</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这时候的静态资源都可以被加载出来,且不会报错,但是api访问的话还是会报错</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc66f8321c6eea~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>将打包后的dist文件里面的内容复制一份到nginx文件中的html文件中</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc6717b7bd4a65~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">打开<span class="selector-tag">html</span>文件清空里面的内容,将复制的内容粘贴进去</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc671c55473a00~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc672a64683778~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>进入cong文件,打开nginx.congf文件,找到server属性在里面新增一条配置</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">	location /api &#123;			</span><br><span class="line">		proxy_pass http://localhost:4000/;			</span><br><span class="line">	&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc675e8b58aca0~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">你要访问那个地址这里就修改为你要访问的那个地址</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/25/16cc67569354770a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>以上配置就全部完成啦</li>
</ul>
<p><strong>注意: 修改完nginx中的配置一定要重启nginx才可以, 切记!!!</strong></p>
<h3 id="nginx简单的操作命令"><a href="#nginx简单的操作命令" class="headerlink" title="nginx简单的操作命令"></a>nginx简单的操作命令</h3><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">nginx.exe -s stop <span class="comment">// stop是快速停止nginx，可能并不保存相关信息</span></span><br><span class="line">nginx.exe -s quit <span class="comment">// quit是完整有序的停止nginx，并保存相关信息</span></span><br><span class="line">nginx.exe -s reload <span class="comment">// 当配置信息修改，需要重新载入这些配置时使用此命令</span></span><br><span class="line">nginx.exe -s reopen <span class="comment">// 重新打开日志文件</span></span><br><span class="line">nginx -v <span class="comment">// 查看Nginx版本</span></span><br></pre></td></tr></table></figure>



<h1 id="Vue中路由跳的转进度条和数据加载Loading显示"><a href="#Vue中路由跳的转进度条和数据加载Loading显示" class="headerlink" title="Vue中路由跳的转进度条和数据加载Loading显示"></a>Vue中路由跳的转进度条和数据加载Loading显示</h1><p>我们在Vue项目中路由跳转时希望出现一个进度条来显示当前跳转状态,或者在数据发起请求时有个loading提示框来提示当前正在加载数据,本篇文章简单介绍一下我在项目中的使用方法。</p>
<h3 id="路由跳转进度条"><a href="#路由跳转进度条" class="headerlink" title="路由跳转进度条"></a>路由跳转进度条</h3><p>NProgress是页面跳转时出现在浏览器顶部的进度条 <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/2/16cf093d4834d6b0~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>官网：<a href="https://link.juejin.cn/?target=http://ricostacruz.com/nprogress/">ricostacruz.com&#x2F;nprogress&#x2F;</a></li>
<li>github：<a href="https://link.juejin.cn/?target=https://github.com/rstacruz/nprogress">github.com&#x2F;rstacruz&#x2F;np…</a></li>
<li>NProgress 安装</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">npm install <span class="attr">--save</span> nprogress</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>NProgress 使用</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 如果在main.js引入并挂载在Vue实例上,请最在顶部引入,否则会出现问题。</span></span><br><span class="line"><span class="comment">// NProgress最重要两个API就是start()和done()，基本一般用这两个就足够了。</span></span><br><span class="line"><span class="comment">// router.js页面</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NProgress</span> <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;nprogress/nprogress.css&#x27;</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">start</span>() <span class="comment">// 显示进度条</span></span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>() <span class="comment">// 完成进度条</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>NProgress 高级用法</li>
</ul>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (1)百分比：通过设置progress的百分比，调用 .set(n)来控制进度，其中n的取值范围为0-1。</span></span><br><span class="line">NProgress<span class="selector-class">.set</span>(<span class="number">0.0</span>)   </span><br><span class="line">NProgress<span class="selector-class">.set</span>(<span class="number">0.4</span>)</span><br><span class="line">NProgress<span class="selector-class">.set</span>(<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2)递增：要让进度条增加，只要调用.inc()。这会产生一个随机增量，但不会让进度条达到100%。</span></span><br><span class="line"><span class="comment">// 此函数适用于图片加载或其他类似的文件加载。</span></span><br><span class="line">NProgress<span class="selector-class">.inc</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3)强制完成：通过传递 true 参数给done()，使进度条满格，即使它没有被显示</span></span><br><span class="line">NProgress<span class="selector-class">.done</span>(true)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>NProgress 其他配置</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (1)minimum：设置最低百分比</span></span><br><span class="line">NProgress.<span class="title function_ invoke__">configure</span>(&#123;<span class="attr">minimum</span>:<span class="number">0.1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2)template：改变进度条的HTML结构。为保证进度条能正常工作，需要元素拥有role=’bar’属性。</span></span><br><span class="line">NProgress.<span class="title function_ invoke__">configure</span>(&#123;</span><br><span class="line">    <span class="attr">template</span>:<span class="string">&quot;&lt;div class=&#x27;....&#x27;&gt;...&lt;/div&gt;&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3)ease：调整动画设置，ease可传递CSS3缓冲动画字符串例如:</span></span><br><span class="line"><span class="comment">// (ease、linear、ease-in、ease-out、ease-in-out、cubic-bezier)</span></span><br><span class="line"><span class="comment">// speed为动画速度（单位ms）</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>以上内容就是NProgress的用法了,是不是非常简单,大家动手实践一下很容易就明白了。</p>
<h3 id="数据请求loading提示-Element-ui为例"><a href="#数据请求loading提示-Element-ui为例" class="headerlink" title="数据请求loading提示(Element-ui为例)"></a>数据请求loading提示(Element-ui为例)</h3><p>Element 提供了两种调用 Loading 的方法：指令和服务。对于自定义指令v-loading，只需要绑定Boolean即可。默认状况下，Loading 遮罩会插入到绑定元素的子节点，通过添加body修饰符，可以使遮罩插入至 DOM 中的 body 上。 <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/2/16cf0f625aaba4be~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>自定义指令v-loading</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// 通常展示表格数据的时候,会添加一个loading提示,当数据完全请求回来时关闭loading提示</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当前元素添加loading提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tabs</span> <span class="attr">type</span>=<span class="string">&quot;border-card&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;activeKey&quot;</span> <span class="attr">v-loading</span>=<span class="string">&quot;loading&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-tab-pane</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;item of tabsLisgt&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;item.key&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:label</span>=<span class="string">&quot;item.label&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:name</span>=<span class="string">&quot;item.name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:value</span>=<span class="string">&quot;item.key&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 自定义的组件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TabPane</span> <span class="attr">:tabsContent</span>=<span class="string">&quot;filterstabsContent&quot;</span> <span class="attr">:activeKey</span>=<span class="string">&quot;activeKey&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-tab-pane</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tabs</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> filtersDate <span class="keyword">from</span> <span class="string">&quot;@/utils/filtersTime&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">TabPane</span> <span class="keyword">from</span> <span class="string">&quot;./components/TabPane&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">TabPane</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// tabs标签列表</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tabsLisgt</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">label</span>: <span class="string">&quot;全部&quot;</span>, <span class="attr">key</span>: <span class="string">&quot;0&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">label</span>: <span class="string">&quot;一级权限&quot;</span>, <span class="attr">key</span>: <span class="string">&quot;1&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">label</span>: <span class="string">&quot;二级权限&quot;</span>, <span class="attr">key</span>: <span class="string">&quot;2&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">label</span>: <span class="string">&quot;三级权限&quot;</span>, <span class="attr">key</span>: <span class="string">&quot;3&quot;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//   tabs标签页面内容</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tabsContent</span>: [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">activeKey</span>: <span class="string">&quot;1&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">loading</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 根据tabs页面状态展示对应数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">filterstabsContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">activeKey</span> === <span class="string">&quot;0&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">tabsContent</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">tabsContent</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> item.<span class="property">status</span> === <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">activeKey</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取tabs页面展示内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">getTabsContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="variable language_">this</span>.$getService(<span class="string">&quot;TabsService&quot;</span>).<span class="title function_">getTabs</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (result &amp;&amp; result.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> result) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 转换时间格式</span></span></span><br><span class="line"><span class="language-javascript">          result[i].<span class="property">createTime</span> = <span class="title function_">filtersDate</span>(result[i].<span class="property">createTime</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">tabsContent</span> = result;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 关闭loading显示</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">async</span> <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取tabs页面展示内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getTabsContent</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>服务方式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Loading 还可以以服务的方式调用。引入 Loading 服务</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Loading</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在需要调用时：</span></span><br><span class="line"><span class="title class_">Loading</span>.<span class="title function_">service</span>(options);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其中 options 参数为 Loading 的配置项，具体见下。</span></span><br><span class="line"><span class="comment">// LoadingService 会返回一个 Loading 实例,可通过调用该实例的 close 方法来关闭它：</span></span><br><span class="line"><span class="keyword">let</span> loadingInstance = <span class="title class_">Loading</span>.<span class="title function_">service</span>(&#123; <span class="attr">fullscreen</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123; <span class="comment">// 以服务的方式调用的 Loading 需要异步关闭</span></span><br><span class="line">  loadingInstance.<span class="title function_">close</span>();</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>在我的项目中,我是通过以下方式来实现的</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 封装axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="variable constant_">API_BASE_URL</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;../config&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;../store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Loading</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> apiClient = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="variable constant_">API_BASE_URL</span></span><br><span class="line">&#125;)</span><br><span class="line">apiClient.<span class="property">defaults</span>.<span class="property">withCredentials</span> = <span class="literal">true</span></span><br><span class="line"><span class="comment">// 封装请求</span></span><br><span class="line">apiClient.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">config</span>) &#123;</span><br><span class="line">  <span class="comment">// 开启loading提示</span></span><br><span class="line">  <span class="keyword">let</span> loadingInstance = <span class="title class_">Loading</span>.<span class="title function_">service</span>(&#123; <span class="attr">fullscreen</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  <span class="comment">// 通过vuex来发起一个异步事件,保存当前开启状态和loading实例</span></span><br><span class="line">  store.<span class="title function_">dispatch</span>(<span class="string">&#x27;loading&#x27;</span>, &#123;<span class="attr">loadingStatus</span>: <span class="literal">true</span>, <span class="attr">loadingInstance</span>: loadingInstance&#125;)</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="comment">// 关闭loading提示</span></span><br><span class="line">  store.<span class="title function_">dispatch</span>(<span class="string">&#x27;loading&#x27;</span>, &#123;<span class="attr">loadingStatus</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br><span class="line">apiClient.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">  <span class="comment">// 关闭loading提示</span></span><br><span class="line">  store.<span class="title function_">dispatch</span>(<span class="string">&#x27;loading&#x27;</span>, &#123;<span class="attr">loadingStatus</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">  <span class="keyword">return</span> response.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">&#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="comment">// 关闭loading提示</span></span><br><span class="line">  store.<span class="title function_">dispatch</span>(<span class="string">&#x27;loading&#x27;</span>, &#123;<span class="attr">loadingStatus</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; apiClient &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// actions.js</span></span><br><span class="line"><span class="attr">loading</span>: <span class="keyword">function</span> (<span class="params">&#123; commit &#125;, data</span>) &#123;</span><br><span class="line">  <span class="title function_">commit</span>(types.<span class="property">LOADING</span>, data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mutaions.js</span></span><br><span class="line">[types.<span class="property">LOADING</span>]: <span class="keyword">function</span> (<span class="params">state, data</span>) &#123;</span><br><span class="line">state.<span class="property">loadingStatus</span> = data.<span class="property">loadingStatus</span></span><br><span class="line">  <span class="keyword">if</span> (!data.<span class="property">loadingStatus</span>) &#123;</span><br><span class="line">    state.<span class="property">loadingInstance</span>.<span class="title function_">close</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    state.<span class="property">loadingInstance</span> = data.<span class="property">loadingInstance</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>以上就是通过Element-ui提供的两种loading显示案例,大家可以手动实践一下,方便理解</p>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue_3</title>
    <url>/2023/04/17/vue_3/</url>
    <content><![CDATA[<h1 id="如何在Vue项目中导出Excel"><a href="#如何在Vue项目中导出Excel" class="headerlink" title="如何在Vue项目中导出Excel"></a>如何在Vue项目中导出Excel</h1><h1 id="Excel-导出"><a href="#Excel-导出" class="headerlink" title="Excel 导出"></a>Excel 导出</h1><p>Excel 的导入导出都是依赖于js-xlsx来实现的。</p>
<p>在 js-xlsx的基础上又封装了Export2Excel.js来方便导出数据。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>由于 Export2Excel不仅依赖js-xlsx还依赖file-saver和script-loader。</p>
<p>所以你先需要安装如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install xlsx file-saver -S</span><br><span class="line">npm install script-loader -S -D</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>由于js-xlsx体积还是很大的，导出功能也不是一个非常常用的功能，所以使用的时候建议使用懒加载。使用方法如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">  excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">    <span class="attr">header</span>: tHeader, <span class="comment">//表头 必填</span></span><br><span class="line">    data, <span class="comment">//具体数据 必填</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;excel-list&#x27;</span>, <span class="comment">//非必填, 导出文件的名字</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>, <span class="comment">//非必填, 导出文件的排列方式</span></span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span> <span class="comment">//非必填, 导出文件的格式</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>在v3.9.1+以后的版本中移除了对 Bolb 的兼容性代码，如果你还需要兼容很低版本的浏览器可以手动引入blob-polyfill进行兼容。</p>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">参数	    说明	          类型	    可选值	           默认值</span><br><span class="line">header	    导出数据的表头	  <span class="title class_">Array</span>	    /	                   []</span><br><span class="line">data	    导出的具体数据	  <span class="title class_">Array</span>	    /	                   []</span><br><span class="line">filename    导出文件名             <span class="title class_">String</span>    /                      excel-list</span><br><span class="line">autoWidth   单元格是否要自适应宽度  <span class="title class_">Boolean</span>   <span class="literal">true</span> / <span class="literal">false</span>           <span class="literal">true</span></span><br><span class="line">bookType    导出文件类型           <span class="title class_">String</span>    xlsx, csv, txt, more   xlsx</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="项目实战"><a href="#项目实战" class="headerlink" title="项目实战"></a>项目实战</h3><p>使用脚手架搭建出基本项目雏形,这时候在src目录下新建一个vendor(文件名自己定义)文件夹,新建一个Export2Excel.js文件,这个文件里面在js-xlsx的基础上又封装了Export2Excel.js来方便导出数据。</p>
<ul>
<li>目录如下 <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/18/16a2e7b05ada4bb5~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></li>
<li>Export2Excel.js代码如下</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">require(&#x27;script-loader!file-saver&#x27;)<span class="comment">;</span></span><br><span class="line">import XLSX from &#x27;xlsx&#x27;</span><br><span class="line"></span><br><span class="line">function generateArray(table) &#123;</span><br><span class="line">  var <span class="attr">out</span> = []<span class="comment">;</span></span><br><span class="line">  var <span class="attr">rows</span> = table.querySelectorAll(<span class="string">&#x27;tr&#x27;</span>)<span class="comment">;</span></span><br><span class="line">  var <span class="attr">ranges</span> = []<span class="comment">;</span></span><br><span class="line">  for (var <span class="attr">R</span> = <span class="number">0</span><span class="comment">; R &lt; rows.length; ++R) &#123;</span></span><br><span class="line">    var <span class="attr">outRow</span> = []<span class="comment">;</span></span><br><span class="line">    var <span class="attr">row</span> = rows[R]<span class="comment">;</span></span><br><span class="line">    var <span class="attr">columns</span> = row.querySelectorAll(<span class="string">&#x27;td&#x27;</span>)<span class="comment">;</span></span><br><span class="line">    for (var <span class="attr">C</span> = <span class="number">0</span><span class="comment">; C &lt; columns.length; ++C) &#123;</span></span><br><span class="line">      var <span class="attr">cell</span> = columns[C]<span class="comment">;</span></span><br><span class="line">      var <span class="attr">colspan</span> = cell.getAttribute(<span class="string">&#x27;colspan&#x27;</span>)<span class="comment">;</span></span><br><span class="line">      var <span class="attr">rowspan</span> = cell.getAttribute(<span class="string">&#x27;rowspan&#x27;</span>)<span class="comment">;</span></span><br><span class="line">      var <span class="attr">cellValue</span> = cell.innerText<span class="comment">;</span></span><br><span class="line">      if (cellValue !== &quot;&quot; &amp;&amp; <span class="attr">cellValue</span> == +cellValue) cellValue = +cellValue<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      //Skip ranges</span><br><span class="line">      ranges.forEach(function (range) &#123;</span><br><span class="line">        if (R &gt;= range.s.r &amp;&amp; R &lt;= range.e.r &amp;&amp; outRow.length &gt;= range.s.c &amp;&amp; outRow.length &lt;= range.e.c) &#123;</span><br><span class="line">          for (var <span class="attr">i</span> = <span class="number">0</span><span class="comment">; i &lt;= range.e.c - range.s.c; ++i) outRow.push(null);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      //Handle Row Span</span><br><span class="line">      if (rowspan || colspan) &#123;</span><br><span class="line">        <span class="attr">rowspan</span> = rowspan || <span class="number">1</span><span class="comment">;</span></span><br><span class="line">        <span class="attr">colspan</span> = colspan || <span class="number">1</span><span class="comment">;</span></span><br><span class="line">        ranges.push(&#123;</span><br><span class="line">          s: &#123;</span><br><span class="line">            r: R,</span><br><span class="line">            c: outRow.length</span><br><span class="line">          &#125;,</span><br><span class="line">          e: &#123;</span><br><span class="line">            r: R + rowspan - 1,</span><br><span class="line">            c: outRow.length + colspan - 1</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)<span class="comment">;</span></span><br><span class="line">      &#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      //Handle Value</span><br><span class="line">      outRow.push(cellValue !== &quot;&quot; ? cellValue : null)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      //Handle Colspan</span><br><span class="line">      if (colspan)</span><br><span class="line">        for (var <span class="attr">k</span> = <span class="number">0</span><span class="comment">; k &lt; colspan - 1; ++k) outRow.push(null);</span></span><br><span class="line">    &#125;</span><br><span class="line">    out.push(outRow)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  return <span class="section">[out, ranges]</span><span class="comment">;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">function datenum(v, date1904) &#123;</span><br><span class="line">  if (date1904) v += 1462<span class="comment">;</span></span><br><span class="line">  var <span class="attr">epoch</span> = Date.parse(v)<span class="comment">;</span></span><br><span class="line">  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function sheet_from_array_of_arrays(data, opts) &#123;</span><br><span class="line">  var <span class="attr">ws</span> = &#123;&#125;<span class="comment">;</span></span><br><span class="line">  var <span class="attr">range</span> = &#123;</span><br><span class="line">    s: &#123;</span><br><span class="line">      c: 10000000,</span><br><span class="line">      r: 10000000</span><br><span class="line">    &#125;,</span><br><span class="line">    e: &#123;</span><br><span class="line">      c: 0,</span><br><span class="line">      r: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="comment">;</span></span><br><span class="line">  for (var <span class="attr">R</span> = <span class="number">0</span><span class="comment">; R != data.length; ++R) &#123;</span></span><br><span class="line">    for (var <span class="attr">C</span> = <span class="number">0</span><span class="comment">; C != data[R].length; ++C) &#123;</span></span><br><span class="line">      if (range.s.r &gt; R) <span class="attr">range.s.r</span> = R<span class="comment">;</span></span><br><span class="line">      if (range.s.c &gt; C) <span class="attr">range.s.c</span> = C<span class="comment">;</span></span><br><span class="line">      if (range.e.r &lt; R) <span class="attr">range.e.r</span> = R<span class="comment">;</span></span><br><span class="line">      if (range.e.c &lt; C) <span class="attr">range.e.c</span> = C<span class="comment">;</span></span><br><span class="line">      var <span class="attr">cell</span> = &#123;</span><br><span class="line">        v: data<span class="section">[R]</span><span class="section">[C]</span></span><br><span class="line">      &#125;<span class="comment">;</span></span><br><span class="line">      if (<span class="attr">cell.v</span> == null) continue<span class="comment">;</span></span><br><span class="line">      var <span class="attr">cell_ref</span> = XLSX.utils.encode_cell(&#123;</span><br><span class="line">        c: C,</span><br><span class="line">        r: R</span><br><span class="line">      &#125;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      if (typeof <span class="attr">cell.v</span> === <span class="string">&#x27;number&#x27;</span>) cell.t = <span class="string">&#x27;n&#x27;</span><span class="comment">;</span></span><br><span class="line">      else if (typeof <span class="attr">cell.v</span> === <span class="string">&#x27;boolean&#x27;</span>) cell.t = <span class="string">&#x27;b&#x27;</span><span class="comment">;</span></span><br><span class="line">      else if (cell.v instanceof Date) &#123;</span><br><span class="line">        <span class="attr">cell.t</span> = <span class="string">&#x27;n&#x27;</span><span class="comment">;</span></span><br><span class="line">        <span class="attr">cell.z</span> = XLSX.SSF._table[<span class="number">14</span>]<span class="comment">;</span></span><br><span class="line">        <span class="attr">cell.v</span> = datenum(cell.v)<span class="comment">;</span></span><br><span class="line">      &#125; else <span class="attr">cell.t</span> = <span class="string">&#x27;s&#x27;</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">      ws<span class="section">[cell_ref]</span> = cell<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (range.s.c &lt; 10000000) ws<span class="section">[&#x27;!ref&#x27;]</span> = XLSX.utils.encode_range(range)<span class="comment">;</span></span><br><span class="line">  return ws<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Workbook() &#123;</span><br><span class="line">  if (!(this instanceof Workbook)) return new Workbook()<span class="comment">;</span></span><br><span class="line">  <span class="attr">this.SheetNames</span> = []<span class="comment">;</span></span><br><span class="line">  <span class="attr">this.Sheets</span> = &#123;&#125;<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function s2ab(s) &#123;</span><br><span class="line">  var <span class="attr">buf</span> = new ArrayBuffer(s.length)<span class="comment">;</span></span><br><span class="line">  var <span class="attr">view</span> = new Uint8Array(buf)<span class="comment">;</span></span><br><span class="line">  for (var <span class="attr">i</span> = <span class="number">0</span><span class="comment">; i != s.length; ++i) view[i] = s.charCodeAt(i) &amp; 0xFF;</span></span><br><span class="line">  return buf<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function export_table_to_excel(id) &#123;</span><br><span class="line">  var <span class="attr">theTable</span> = document.getElementById(id)<span class="comment">;</span></span><br><span class="line">  var <span class="attr">oo</span> = generateArray(theTable)<span class="comment">;</span></span><br><span class="line">  var <span class="attr">ranges</span> = oo[<span class="number">1</span>]<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  /* original data */</span><br><span class="line">  var <span class="attr">data</span> = oo[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">  var <span class="attr">ws_name</span> = <span class="string">&quot;SheetJS&quot;</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  var <span class="attr">wb</span> = new Workbook(),</span><br><span class="line">    <span class="attr">ws</span> = sheet_from_array_of_arrays(data)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  /* add ranges to worksheet */</span><br><span class="line">  // ws<span class="section">[&#x27;!cols&#x27;]</span> = <span class="section">[&#x27;apple&#x27;, &#x27;banan&#x27;]</span><span class="comment">;</span></span><br><span class="line">  ws<span class="section">[&#x27;!merges&#x27;]</span> = ranges<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  /* add worksheet to workbook */</span><br><span class="line">  wb.SheetNames.push(ws_name)<span class="comment">;</span></span><br><span class="line">  wb.Sheets<span class="section">[ws_name]</span> = ws<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  var <span class="attr">wbout</span> = XLSX.write(wb, &#123;</span><br><span class="line">    bookType: &#x27;xlsx&#x27;,</span><br><span class="line">    bookSST: false,</span><br><span class="line">    type: &#x27;binary&#x27;</span><br><span class="line">  &#125;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  saveAs(new Blob(<span class="section">[s2ab(wbout)]</span>, &#123;</span><br><span class="line">    type: &quot;application/octet-stream&quot;</span><br><span class="line">  &#125;), &quot;test.xlsx&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function export_json_to_excel(&#123;</span><br><span class="line">  <span class="attr">multiHeader</span> = [],</span><br><span class="line">  header,</span><br><span class="line">  data,</span><br><span class="line">  filename,</span><br><span class="line">  <span class="attr">merges</span> = [],</span><br><span class="line">  <span class="attr">autoWidth</span> = <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">bookType</span> = <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line">&#125; = &#123;&#125;) &#123;</span><br><span class="line">  /* original data */</span><br><span class="line">  <span class="attr">filename</span> = filename || <span class="string">&#x27;excel-list&#x27;</span></span><br><span class="line">  <span class="attr">data</span> = [...data]</span><br><span class="line">  data.unshift(header)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  for (let <span class="attr">i</span> = multiHeader.length - <span class="number">1</span><span class="comment">; i &gt; -1; i--) &#123;</span></span><br><span class="line">    data.unshift(multiHeader<span class="section">[i]</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var <span class="attr">ws_name</span> = <span class="string">&quot;SheetJS&quot;</span><span class="comment">;</span></span><br><span class="line">  var <span class="attr">wb</span> = new Workbook(),</span><br><span class="line">    <span class="attr">ws</span> = sheet_from_array_of_arrays(data)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  if (merges.length &gt; 0) &#123;</span><br><span class="line">    if (!ws<span class="section">[&#x27;!merges&#x27;]</span>) ws<span class="section">[&#x27;!merges&#x27;]</span> = <span class="section">[]</span><span class="comment">;</span></span><br><span class="line">    merges.forEach(<span class="attr">item</span> =&gt; &#123;</span><br><span class="line">      ws<span class="section">[&#x27;!merges&#x27;]</span>.push(XLSX.utils.decode_range(item))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (autoWidth) &#123;</span><br><span class="line">    /*设置worksheet每列的最大宽度*/</span><br><span class="line">    const <span class="attr">colWidth</span> = data.map(row =&gt; row.map(val =&gt; &#123;</span><br><span class="line">      /*先判断是否为null/undefined*/</span><br><span class="line">      if (<span class="attr">val</span> == null) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          &#x27;wch&#x27;: 10</span><br><span class="line">        &#125;<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">      /*再判断是否为中文*/</span><br><span class="line">      else if (val.toString().charCodeAt(0) &gt; 255) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          &#x27;wch&#x27;: val.toString().length * 2</span><br><span class="line">        &#125;<span class="comment">;</span></span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          &#x27;wch&#x27;: val.toString().length</span><br><span class="line">        &#125;<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;))</span><br><span class="line">    /*以第一行为初始值*/</span><br><span class="line">    let <span class="attr">result</span> = colWidth[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">    for (let <span class="attr">i</span> = <span class="number">1</span><span class="comment">; i &lt; colWidth.length; i++) &#123;</span></span><br><span class="line">      for (let <span class="attr">j</span> = <span class="number">0</span><span class="comment">; j &lt; colWidth[i].length; j++) &#123;</span></span><br><span class="line">        if (result<span class="section">[j]</span><span class="section">[&#x27;wch&#x27;]</span> &lt; colWidth<span class="section">[i]</span><span class="section">[j]</span><span class="section">[&#x27;wch&#x27;]</span>) &#123;</span><br><span class="line">          result<span class="section">[j]</span><span class="section">[&#x27;wch&#x27;]</span> = colWidth<span class="section">[i]</span><span class="section">[j]</span><span class="section">[&#x27;wch&#x27;]</span><span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ws<span class="section">[&#x27;!cols&#x27;]</span> = result<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* add worksheet to workbook */</span><br><span class="line">  wb.SheetNames.push(ws_name)<span class="comment">;</span></span><br><span class="line">  wb.Sheets<span class="section">[ws_name]</span> = ws<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  var <span class="attr">wbout</span> = XLSX.write(wb, &#123;</span><br><span class="line">    bookType: bookType,</span><br><span class="line">    bookSST: false,</span><br><span class="line">    type: &#x27;binary&#x27;</span><br><span class="line">  &#125;)<span class="comment">;</span></span><br><span class="line">  saveAs(new Blob(<span class="section">[s2ab(wbout)]</span>, &#123;</span><br><span class="line">    type: &quot;application/octet-stream&quot;</span><br><span class="line">  &#125;), `$&#123;filename&#125;.$&#123;bookType&#125;`)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>新建一个exportExcel.vue模板用于导出Excel表格,使用代码如下</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;exportExcel&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;excel-header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!--导出文件名称--&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;filename&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;radio-label&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-left:0;&quot;</span>&gt;</span>Filename:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">v-model</span>=<span class="string">&quot;filename&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">placeholder</span>=<span class="string">&quot;请输入导出文件名&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&quot;width:340px;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">prefix-icon</span>=<span class="string">&quot;el-icon-document&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!--设置表格导出的宽度是否自动--&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;autoWidth&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;radio-label&quot;</span>&gt;</span>Cell Auto-Width:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">&quot;autoWidth&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">&quot;true&quot;</span> <span class="attr">border</span>&gt;</span>True<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">&quot;false&quot;</span> <span class="attr">border</span>&gt;</span>False<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!--导出文件后缀类型--&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bookType&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;radio-label&quot;</span>&gt;</span>Book Type:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;bookType&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:120px;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">v-for</span>=<span class="string">&quot;item in options&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;item&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!--导出文件--&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;download&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:loading</span>=<span class="string">&quot;downloadLoading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">icon</span>=<span class="string">&quot;document&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click</span>=<span class="string">&quot;handleDownload&quot;</span>&gt;</span>export Excel<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-table</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-loading</span>=<span class="string">&quot;listLoading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:data</span>=<span class="string">&quot;list&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">element-loading-text</span>=<span class="string">&quot;拼命加载中&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">border</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">fit</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">highlight-current-row</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">height</span>=<span class="string">&quot;390px&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">label</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;95&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span>&#123;&#123; scope.$index &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;订单号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;230&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span>&#123;&#123; scope.row.title &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;菜品&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span>&#123;&#123; scope.row.foods &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;收银员&quot;</span> <span class="attr">width</span>=<span class="string">&quot;110&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-tag</span>&gt;</span>&#123;&#123; scope.row.author &#125;&#125;<span class="tag">&lt;/<span class="name">el-tag</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;金额&quot;</span> <span class="attr">width</span>=<span class="string">&quot;115&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span>&#123;&#123; scope.row.pageviews &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">label</span>=<span class="string">&quot;时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;220&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-time&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; scope.row.timestamp | parseTime(&#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;&#x27;) &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;exportExcelDialog&quot;</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 列表内容</span></span><br><span class="line">      <span class="attr">list</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="comment">// loding窗口状态</span></span><br><span class="line">      <span class="attr">listLoading</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// 下载loding窗口状态</span></span><br><span class="line">      <span class="attr">downloadLoading</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="comment">// 导出文件名称</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="comment">// 导出表格宽度是否auto</span></span><br><span class="line">      <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// 导出文件格式</span></span><br><span class="line">      <span class="attr">bookType</span>: <span class="string">&quot;xlsx&quot;</span>,</span><br><span class="line">      <span class="comment">// 默认导出文件后缀类型</span></span><br><span class="line">      <span class="attr">options</span>: [<span class="string">&quot;xlsx&quot;</span>, <span class="string">&quot;csv&quot;</span>, <span class="string">&quot;txt&quot;</span>]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// 导出Excel表格</span></span><br><span class="line">    <span class="title function_">handleDownload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// 懒加载该用法</span></span><br><span class="line">      <span class="title function_">import</span>(<span class="string">&quot;@/vendor/Export2Excel&quot;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 设置导出表格的头部</span></span><br><span class="line">        <span class="keyword">const</span> tHeader = [<span class="string">&quot;序号&quot;</span>, <span class="string">&quot;订单号&quot;</span>, <span class="string">&quot;菜品&quot;</span>, <span class="string">&quot;收银员&quot;</span>, <span class="string">&quot;金额&quot;</span>, <span class="string">&quot;时间&quot;</span>];</span><br><span class="line">        <span class="comment">// 设置要导出的属性</span></span><br><span class="line">        <span class="keyword">const</span> filterVal = [</span><br><span class="line">          <span class="string">&quot;id&quot;</span>,</span><br><span class="line">          <span class="string">&quot;title&quot;</span>,</span><br><span class="line">          <span class="string">&quot;foods&quot;</span>,</span><br><span class="line">          <span class="string">&quot;author&quot;</span>,</span><br><span class="line">          <span class="string">&quot;pageviews&quot;</span>,</span><br><span class="line">          <span class="string">&quot;display_time&quot;</span></span><br><span class="line">        ];</span><br><span class="line">        <span class="comment">// 获取当前展示的表格数据</span></span><br><span class="line">        <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">list</span>;</span><br><span class="line">        <span class="comment">// 将要导出的数据进行一个过滤</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="title function_">formatJson</span>(filterVal, list);</span><br><span class="line">        <span class="comment">// 调用我们封装好的方法进行导出Excel</span></span><br><span class="line">        excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">          <span class="comment">// 导出的头部</span></span><br><span class="line">          <span class="attr">header</span>: tHeader,</span><br><span class="line">          <span class="comment">// 导出的内容</span></span><br><span class="line">          data,</span><br><span class="line">          <span class="comment">// 导出的文件名称</span></span><br><span class="line">          <span class="attr">filename</span>: <span class="variable language_">this</span>.<span class="property">filename</span>,</span><br><span class="line">          <span class="comment">// 导出的表格宽度是否自动</span></span><br><span class="line">          <span class="attr">autoWidth</span>: <span class="variable language_">this</span>.<span class="property">autoWidth</span>,</span><br><span class="line">          <span class="comment">// 导出文件的后缀类型</span></span><br><span class="line">          <span class="attr">bookType</span>: <span class="variable language_">this</span>.<span class="property">bookType</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 对要导出的内容进行过滤</span></span><br><span class="line">    <span class="title function_">formatJson</span>(<span class="params">filterVal, jsonData</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> jsonData.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span></span><br><span class="line">        filterVal.<span class="title function_">map</span>(<span class="function"><span class="params">j</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (j === <span class="string">&quot;timestamp&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">parseTime</span>(v[j]);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> v[j];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 过滤时间</span></span><br><span class="line">    <span class="title function_">parseTime</span>(<span class="params">time, cFormat</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> format = cFormat || <span class="string">&quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span>;</span><br><span class="line">      <span class="keyword">let</span> date;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">        date = time;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="regexp">/^[0-9]+$/</span>.<span class="title function_">test</span>(time)) &#123;</span><br><span class="line">          time = <span class="built_in">parseInt</span>(time);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;number&quot;</span> &amp;&amp; time.<span class="title function_">toString</span>().<span class="property">length</span> === <span class="number">10</span>) &#123;</span><br><span class="line">          time = time * <span class="number">1000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        date = <span class="keyword">new</span> <span class="title class_">Date</span>(time);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> formatObj = &#123;</span><br><span class="line">        <span class="attr">y</span>: date.<span class="title function_">getFullYear</span>(),</span><br><span class="line">        <span class="attr">m</span>: date.<span class="title function_">getMonth</span>() + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">d</span>: date.<span class="title function_">getDate</span>(),</span><br><span class="line">        <span class="attr">h</span>: date.<span class="title function_">getHours</span>(),</span><br><span class="line">        <span class="attr">i</span>: date.<span class="title function_">getMinutes</span>(),</span><br><span class="line">        <span class="attr">s</span>: date.<span class="title function_">getSeconds</span>(),</span><br><span class="line">        <span class="attr">a</span>: date.<span class="title function_">getDay</span>()</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">const</span> timeStr = format.<span class="title function_">replace</span>(<span class="regexp">/&#123;(y|m|d|h|i|s|a)+&#125;/g</span>, <span class="function">(<span class="params">result, key</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> value = formatObj[key];</span><br><span class="line">        <span class="comment">// Note: getDay() returns 0 on Sunday</span></span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">&quot;a&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> [<span class="string">&quot;日&quot;</span>, <span class="string">&quot;一&quot;</span>, <span class="string">&quot;二&quot;</span>, <span class="string">&quot;三&quot;</span>, <span class="string">&quot;四&quot;</span>, <span class="string">&quot;五&quot;</span>, <span class="string">&quot;六&quot;</span>][value];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; value &lt; <span class="number">10</span>) &#123;</span><br><span class="line">          value = <span class="string">&quot;0&quot;</span> + value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value || <span class="number">0</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> timeStr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 模拟获取数据</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">list</span> = [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="number">1432179778664</span>,</span><br><span class="line">          <span class="attr">author</span>: <span class="string">&quot;Charles&quot;</span>,</span><br><span class="line">          <span class="attr">comment_disabled</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content_short</span>: <span class="string">&quot;mock data&quot;</span>,</span><br><span class="line">          <span class="attr">display_time</span>: <span class="string">&quot;1994-05-25 23:37:25&quot;</span>,</span><br><span class="line">          <span class="attr">foods</span>: <span class="string">&quot;鸡翅、萝卜、牛肉、红烧大闸蟹、红烧鸡翅&quot;</span>,</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">image_uri</span>:</span><br><span class="line">            <span class="string">&quot;https://wpimg.wallstcn.com/e4558086-631c-425c-9430-56ffb46e70b3&quot;</span>,</span><br><span class="line">          <span class="attr">importance</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">pageviews</span>: <span class="number">2864</span>,</span><br><span class="line">          <span class="attr">platforms</span>: [<span class="string">&quot;a-platform&quot;</span>],</span><br><span class="line">          <span class="attr">reviewer</span>: <span class="string">&quot;Sandra&quot;</span>,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;published&quot;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;O20190407135010000000001&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;CN&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">listLoading</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">filters</span>: &#123;</span><br><span class="line">    <span class="comment">// 过滤时间</span></span><br><span class="line">    <span class="title function_">parseTime</span>(<span class="params">time, cFormat</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> format = cFormat || <span class="string">&quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span>;</span><br><span class="line">      <span class="keyword">let</span> date;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">        date = time;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="regexp">/^[0-9]+$/</span>.<span class="title function_">test</span>(time)) &#123;</span><br><span class="line">          time = <span class="built_in">parseInt</span>(time);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;number&quot;</span> &amp;&amp; time.<span class="title function_">toString</span>().<span class="property">length</span> === <span class="number">10</span>) &#123;</span><br><span class="line">          time = time * <span class="number">1000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        date = <span class="keyword">new</span> <span class="title class_">Date</span>(time);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> formatObj = &#123;</span><br><span class="line">        <span class="attr">y</span>: date.<span class="title function_">getFullYear</span>(),</span><br><span class="line">        <span class="attr">m</span>: date.<span class="title function_">getMonth</span>() + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">d</span>: date.<span class="title function_">getDate</span>(),</span><br><span class="line">        <span class="attr">h</span>: date.<span class="title function_">getHours</span>(),</span><br><span class="line">        <span class="attr">i</span>: date.<span class="title function_">getMinutes</span>(),</span><br><span class="line">        <span class="attr">s</span>: date.<span class="title function_">getSeconds</span>(),</span><br><span class="line">        <span class="attr">a</span>: date.<span class="title function_">getDay</span>()</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">const</span> timeStr = format.<span class="title function_">replace</span>(<span class="regexp">/&#123;(y|m|d|h|i|s|a)+&#125;/g</span>, <span class="function">(<span class="params">result, key</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> value = formatObj[key];</span><br><span class="line">        <span class="comment">// Note: getDay() returns 0 on Sunday</span></span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">&quot;a&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> [<span class="string">&quot;日&quot;</span>, <span class="string">&quot;一&quot;</span>, <span class="string">&quot;二&quot;</span>, <span class="string">&quot;三&quot;</span>, <span class="string">&quot;四&quot;</span>, <span class="string">&quot;五&quot;</span>, <span class="string">&quot;六&quot;</span>][value];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; value &lt; <span class="number">10</span>) &#123;</span><br><span class="line">          value = <span class="string">&quot;0&quot;</span> + value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value || <span class="number">0</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> timeStr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>效果图如下</li>
</ul>
<h1 id="如何在Vue项目使用富文本"><a href="#如何在Vue项目使用富文本" class="headerlink" title="  如何在Vue项目使用富文本"></a><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/18/16a2ef02a2cbed75~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img">  如何在Vue项目使用富文本</h1><h1 id="富文本"><a href="#富文本" class="headerlink" title="富文本"></a>富文本</h1><p>富文本是管理后台一个核心的功能，但同时又是一个有很多坑的地方。在选择富文本的过程中我也走了不少的弯路，市面上常见的富文本都基本用过了，最终权衡了一下选择了Tinymce。</p>
<p>这里在简述一下推荐使用 tinymce 的原因：tinymce 是一家老牌做富文本的公司(这里也推荐 ckeditor，也是一家一直做富文本的公司，新版本很不错)，它的产品经受了市场的认可，不管是文档还是配置的自由度都很好。在使用富文本的时候有一点也很关键就是复制格式化，之前在用一款韩国人做的富文本 summernote 被它的格式化坑的死去活来，但 tinymce 的去格式化相当的好，它还有一些增值服务(付费插件)，最好用的就是powerpaste，非常的强大，支持从 word 里面复制各种东西，而且还帮你顺带格式化了。富文本还有一点也很关键，就是拓展性。楼主用 tinymce 写了好几个插件，学习成本和容易度都不错，很方便拓展。最后一点就是文档很完善，基本你想得到的配置项，它都有。tinymce 也支持按需加载，你可以通过它官方的 build 页定制自己需要的 plugins。</p>
<p><strong>以上内容引自<a href="https://link.juejin.cn/?target=https://panjiachen.github.io/vue-element-admin-site/zh/feature/component/rich-editor.html">vue-element-admin</a>作者官网</strong></p>
<h1 id="Tinymce的使用方法"><a href="#Tinymce的使用方法" class="headerlink" title="Tinymce的使用方法"></a>Tinymce的使用方法</h1><p>目前采用全局引用的方式。代码地址：static&#x2F;tinymce (static 目录下的文件不会被打包), 在 index.html 中引入。并确保它的引入顺序在你的app.js之前！</p>
<ul>
<li>第一步 我们需要去官网下载他的源文件,或者引入在线地址</li>
<li>第二步 由于TinyMCE允许通过CSS选择器识别可替换元素，因此唯一的要求是传递包含selectorto 的对象tinymce.init()。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">在这个例子中，替换<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&#x27;mytextarea&#x27;</span>&gt;</span></span><br><span class="line">通过使选择器与TinyMCE的5.0编辑器实例&#x27;#mytextarea&#x27;来tinymce.init()。</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;https://cloud.tinymce.com/5/tinymce.min.js?apiKey=your_API_key&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  tinymce.<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">selector</span>: <span class="string">&#x27;#mytextarea&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>TinyMCE Quick Start Guide<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;mytextarea&quot;</span>&gt;</span>Hello, World!<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>第三步 使用表单POST保存内容,当form被提交后，TinyMCE的5.0主编模仿一个普通的HTML行为textarea过程中POST。在用户的表单处理程序中，提交的内容可以与从常规创建的内容相同的方式处理textarea。</li>
</ul>
<h3 id="项目实战-1"><a href="#项目实战-1" class="headerlink" title="项目实战"></a>项目实战</h3><p>由于目前使用 npm 安装 Tinymce 方法比较复杂而且还有一些问题(日后可能会采用该模式)且会大大增加编译的时间所以暂时不准备采用。所以这里直接去官网下载源文件保存在项目static文件夹中</p>
<h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><p>由于富文本不适合双向数据流，所以只会 watch 传入富文本的内容一次变化，之后传入内容的变化就不会再监听了，如果之后还有改变富文本内容的需求。</p>
<p>可以通过 this.refs.xxx.setContent() 手动来设置。</p>
<ul>
<li>官网下载<a href="https://link.juejin.cn/?target=https://www.tiny.cloud/docs/quick-start/">源文件</a>放在static文件下如图</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/19/16a3356321b7a0f2~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>在index.html页面中引入 tinymce.min.js文件, 确保它的引入顺序在你的app.js之前！如图</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/19/16a335851214ab2a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>在component文件夹内创建一个Tinymce文件夹用于封装我们要使用的富文本组件, 目录如图</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/19/16a336eeee6fd42d~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"> 其中两个js文件是对应的工具栏列表等其他插件功能, index.vue是封装好的模板,components中的组件是封装的图片上传的弹窗功能</p>
<p>plugins.js文件的代码如下</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> plugins = [<span class="comment">&#x27;advlist anchor autolink autosave code codesample colorpicker colorpicker</span></span><br><span class="line">contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link</span><br><span class="line">lists media nonbreaking noneditable pagebreak paste preview print save searchreplace</span><br><span class="line">spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount<span class="comment">&#x27;]</span></span><br><span class="line"></span><br><span class="line">export <span class="keyword">default</span> plugins</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>toolbar.js文件的代码如下</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> toolbar = [<span class="comment">&#x27;searchreplace bold italic underline strikethrough alignleft aligncenter</span></span><br><span class="line">alignright outdent indent  blockquote undo redo removeformat subscript superscript code</span><br><span class="line">codesample<span class="comment">&#x27;, &#x27;hr bullist numlist link image charmap preview anchor pagebreak insertdatetime</span></span><br><span class="line">media table emoticons forecolor backcolor fullscreen<span class="comment">&#x27;]</span></span><br><span class="line"></span><br><span class="line">export <span class="keyword">default</span> toolbar</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>index.vue组件的代码如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;fullscreen:fullscreen&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;tinymce-container editor-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">:id</span>=<span class="string">&quot;tinymceId&quot;</span> <span class="attr">class</span>=<span class="string">&quot;tinymce-textarea&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editor-custom-btn-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">editorImage</span> <span class="attr">color</span>=<span class="string">&quot;#1890ff&quot;</span> <span class="attr">class</span>=<span class="string">&quot;editor-upload-btn&quot;</span> @<span class="attr">successCBK</span>=<span class="string">&quot;imageSuccessCBK&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 导入图片上传的组件</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> editorImage <span class="keyword">from</span> <span class="string">&#x27;./components/editorImage&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 导入富文本插件</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> plugins <span class="keyword">from</span> <span class="string">&#x27;./plugins&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 导入富文本工具栏</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> toolbar <span class="keyword">from</span> <span class="string">&#x27;./toolbar&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;Tinymce&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">components</span>: &#123; editorImage &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&#x27;vue-tinymce-&#x27;</span> + +<span class="keyword">new</span> <span class="title class_">Date</span>() + ((<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">1000</span>).<span class="title function_">toFixed</span>(<span class="number">0</span>) + <span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">value</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">toolbar</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">required</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">default</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">menubar</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="string">&#x27;file edit insert view format table&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">height</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">required</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="number">360</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hasChange</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hasInit</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tinymceId</span>: <span class="variable language_">this</span>.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">fullscreen</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">languageTypeList</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;en&#x27;</span>: <span class="string">&#x27;en&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;zh&#x27;</span>: <span class="string">&#x27;zh_CN&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">language</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="string">&#x27;zh_CN&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">value</span>(<span class="params">val</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">hasChange</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">hasInit</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">get</span>(<span class="variable language_">this</span>.<span class="property">tinymceId</span>).<span class="title function_">setContent</span>(val || <span class="string">&#x27;&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">language</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">destroyTinymce</span>()</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">initTinymce</span>())</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">initTinymce</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">activated</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">initTinymce</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">deactivated</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">destroyTinymce</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">destroyed</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">destroyTinymce</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">initTinymce</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> _this = <span class="variable language_">this</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">language</span>: <span class="variable language_">this</span>.<span class="property">language</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">selector</span>: <span class="string">`#<span class="subst">$&#123;<span class="variable language_">this</span>.tinymceId&#125;</span>`</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">height</span>: <span class="variable language_">this</span>.<span class="property">height</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">body_class</span>: <span class="string">&#x27;panel-body &#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">object_resizing</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">toolbar</span>: <span class="variable language_">this</span>.<span class="property">toolbar</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="variable language_">this</span>.<span class="property">toolbar</span> : toolbar,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">menubar</span>: <span class="variable language_">this</span>.<span class="property">menubar</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">plugins</span>: plugins,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">end_container_on_empty_block</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">powerpaste_word_import</span>: <span class="string">&#x27;clean&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">code_dialog_height</span>: <span class="number">450</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">code_dialog_width</span>: <span class="number">1000</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">advlist_bullet_styles</span>: <span class="string">&#x27;square&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">advlist_number_styles</span>: <span class="string">&#x27;default&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">imagetools_cors_hosts</span>: [<span class="string">&#x27;www.tinymce.com&#x27;</span>, <span class="string">&#x27;codepen.io&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default_link_target</span>: <span class="string">&#x27;_blank&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">link_title</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">nonbreaking_force_tab</span>: <span class="literal">true</span>, <span class="comment">// inserting nonbreaking space &amp;nbsp; need Nonbreaking Space Plugin</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">init_instance_callback</span>: <span class="function"><span class="params">editor</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (_this.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            editor.<span class="title function_">setContent</span>(_this.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          _this.<span class="property">hasInit</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">          editor.<span class="title function_">on</span>(<span class="string">&#x27;NodeChange Change KeyUp SetContent&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">hasChange</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;input&#x27;</span>, editor.<span class="title function_">getContent</span>())</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setup</span>(<span class="params">editor</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          editor.<span class="title function_">on</span>(<span class="string">&#x27;FullscreenStateChanged&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            _this.<span class="property">fullscreen</span> = e.<span class="property">state</span></span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 整合七牛上传</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// images_dataimg_filter(img) &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   setTimeout(() =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     const $image = $(img);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     $image.removeAttr(&#x27;width&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     $image.removeAttr(&#x27;height&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     if ($image[0].height &amp;&amp; $image[0].width) &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       $image.attr(&#x27;data-wscntype&#x27;, &#x27;image&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       $image.attr(&#x27;data-wscnh&#x27;, $image[0].height);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       $image.attr(&#x27;data-wscnw&#x27;, $image[0].width);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       $image.addClass(&#x27;wscnph&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     &#125;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   &#125;, 0);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   return img</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// images_upload_handler(blobInfo, success, failure, progress) &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   progress(0);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   const token = _this.$store.getters.token;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   getToken(token).then(response =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     const url = response.data.qiniu_url;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     const formData = new FormData();</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     formData.append(&#x27;token&#x27;, response.data.qiniu_token);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     formData.append(&#x27;key&#x27;, response.data.qiniu_key);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     formData.append(&#x27;file&#x27;, blobInfo.blob(), url);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     upload(formData).then(() =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       success(url);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//       progress(100);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   &#125;).catch(err =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     failure(&#x27;出现未知问题，刷新页面，或者联系程序员&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     console.log(err);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   &#125;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">destroyTinymce</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> tinymce = <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">get</span>(<span class="variable language_">this</span>.<span class="property">tinymceId</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fullscreen</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        tinymce.<span class="title function_">execCommand</span>(<span class="string">&#x27;mceFullScreen&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (tinymce) &#123;</span></span><br><span class="line"><span class="language-javascript">        tinymce.<span class="title function_">destroy</span>()</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">setContent</span>(<span class="params">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">get</span>(<span class="variable language_">this</span>.<span class="property">tinymceId</span>).<span class="title function_">setContent</span>(value)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">getContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">get</span>(<span class="variable language_">this</span>.<span class="property">tinymceId</span>).<span class="title function_">getContent</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">imageSuccessCBK</span>(<span class="params">arr</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> _this = <span class="variable language_">this</span></span></span><br><span class="line"><span class="language-javascript">      arr.<span class="title function_">forEach</span>(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">window</span>.<span class="property">tinymce</span>.<span class="title function_">get</span>(_this.<span class="property">tinymceId</span>).<span class="title function_">insertContent</span>(<span class="string">`&lt;img class=&quot;wscnph&quot; src=&quot;<span class="subst">$&#123;v.url&#125;</span>&quot; &gt;`</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.tinymce-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">line-height</span>: normal;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.tinymce-container</span>&gt;&gt;&gt;<span class="selector-class">.mce-fullscreen</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">10000</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.tinymce-textarea</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">visibility</span>: hidden;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.editor-custom-btn-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">right</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">top</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/*z-index: 2005;*/</span></span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fullscreen</span> <span class="selector-class">.editor-custom-btn-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">10000</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.editor-upload-btn</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>图片上传组件editorImage的代码如下</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="attr">class</span>=<span class="string">&quot;upload-container&quot;</span>&gt;</span><br><span class="line">    &lt;el-button :<span class="attr">style</span>=<span class="string">&quot;&#123;background:color,borderColor:color&#125;&quot;</span> icon=<span class="string">&quot;el-icon-upload&quot;</span> size=<span class="string">&quot;mini&quot;</span> type=<span class="string">&quot;primary&quot;</span> @click=<span class="string">&quot; dialogVisible=true&quot;</span>&gt;</span><br><span class="line">      上传图片</span><br><span class="line">    &lt;/el-button&gt;</span><br><span class="line">    &lt;el-dialog :<span class="attr">visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span>&gt;</span><br><span class="line">      &lt;el-upload</span><br><span class="line">        :<span class="attr">multiple</span>=<span class="string">&quot;true&quot;</span></span><br><span class="line">        :<span class="attr">file-list</span>=<span class="string">&quot;fileList&quot;</span></span><br><span class="line">        :<span class="attr">show-file-list</span>=<span class="string">&quot;true&quot;</span></span><br><span class="line">        :<span class="attr">on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span><br><span class="line">        :<span class="attr">on-success</span>=<span class="string">&quot;handleSuccess&quot;</span></span><br><span class="line">        :<span class="attr">before-upload</span>=<span class="string">&quot;beforeUpload&quot;</span></span><br><span class="line">        <span class="attr">class</span>=<span class="string">&quot;editor-slide-upload&quot;</span></span><br><span class="line">        <span class="attr">action</span>=<span class="string">&quot;https://httpbin.org/post&quot;</span></span><br><span class="line">        <span class="attr">list-type</span>=<span class="string">&quot;picture-card&quot;</span></span><br><span class="line">      &gt;</span><br><span class="line">        &lt;el-button <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> type=<span class="string">&quot;primary&quot;</span>&gt;</span><br><span class="line">          点击上传</span><br><span class="line">        &lt;/el-button&gt;</span><br><span class="line">      &lt;/el-upload&gt;</span><br><span class="line">      &lt;el-button @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span><br><span class="line">        取 消</span><br><span class="line">      &lt;/el-button&gt;</span><br><span class="line">      &lt;el-button <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @click=<span class="string">&quot;handleSubmit&quot;</span>&gt;</span><br><span class="line">        确 定</span><br><span class="line">      &lt;/el-button&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// import &#123; getToken &#125; from &#x27;api/qiniu&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;EditorSlideUpload&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    color: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;<span class="comment">#1890ff&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      dialogVisible: false,</span><br><span class="line">      listObj: &#123;&#125;,</span><br><span class="line">      fileList: <span class="section">[]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    checkAllSuccess() &#123;</span><br><span class="line">      return Object.keys(this.listObj).every(<span class="attr">item</span> =&gt; this.listObj[item].hasSuccess)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSubmit() &#123;</span><br><span class="line">      const <span class="attr">arr</span> = Object.keys(this.listObj).map(v =&gt; this.listObj[v])</span><br><span class="line">      if (!this.checkAllSuccess()) &#123;</span><br><span class="line">        this.$message(&#x27;请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！&#x27;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      this.$emit(&#x27;successCBK&#x27;, arr)</span><br><span class="line">      <span class="attr">this.listObj</span> = &#123;&#125;</span><br><span class="line">      <span class="attr">this.fileList</span> = []</span><br><span class="line">      <span class="attr">this.dialogVisible</span> = <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    handleSuccess(response, file) &#123;</span><br><span class="line">      const <span class="attr">uid</span> = file.uid</span><br><span class="line">      const <span class="attr">objKeyArr</span> = Object.keys(this.listObj)</span><br><span class="line">      for (let <span class="attr">i</span> = <span class="number">0</span>, len = objKeyArr.length<span class="comment">; i &lt; len; i++) &#123;</span></span><br><span class="line">        if (this.listObj<span class="section">[objKeyArr[i]]</span>.<span class="attr">uid</span> === uid) &#123;</span><br><span class="line">          this.listObj<span class="section">[objKeyArr[i]]</span>.<span class="attr">url</span> = response.files.file</span><br><span class="line">          this.listObj<span class="section">[objKeyArr[i]]</span>.<span class="attr">hasSuccess</span> = <span class="literal">true</span></span><br><span class="line">          return</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleRemove(file) &#123;</span><br><span class="line">      const <span class="attr">uid</span> = file.uid</span><br><span class="line">      const <span class="attr">objKeyArr</span> = Object.keys(this.listObj)</span><br><span class="line">      for (let <span class="attr">i</span> = <span class="number">0</span>, len = objKeyArr.length<span class="comment">; i &lt; len; i++) &#123;</span></span><br><span class="line">        if (this.listObj<span class="section">[objKeyArr[i]]</span>.<span class="attr">uid</span> === uid) &#123;</span><br><span class="line">          delete this.listObj<span class="section">[objKeyArr[i]]</span></span><br><span class="line">          return</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeUpload(file) &#123;</span><br><span class="line">      const <span class="attr">_self</span> = this</span><br><span class="line">      const <span class="attr">_URL</span> = window.URL || window.webkitURL</span><br><span class="line">      const <span class="attr">fileName</span> = file.uid</span><br><span class="line">      this.listObj<span class="section">[fileName]</span> = &#123;&#125;</span><br><span class="line">      return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        const <span class="attr">img</span> = new Image()</span><br><span class="line">        <span class="attr">img.src</span> = _URL.createObjectURL(file)</span><br><span class="line">        <span class="attr">img.onload</span> = function() &#123;</span><br><span class="line">          _self.listObj<span class="section">[fileName]</span> = &#123; hasSuccess: false, uid: file.uid, width: this.width, height: this.height &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        resolve(true)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> scoped&gt;</span><br><span class="line">.editor-slide-upload &#123;</span><br><span class="line">  margin-bottom: 20px<span class="comment">;</span></span><br><span class="line">  /deep/ .el-upload--picture-card &#123;</span><br><span class="line">    width: 100%<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>以上代码直接复制到本地就能够直接使用</p>
<ul>
<li>接下来在需要使用富文本组件的地方引用tinymce文件下的index.vue文件即可,如图使用</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/19/16a33a7758c67ce4~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"> 当form被提交后，TinyMCE的5.0主编模仿一个普通的HTML行为textarea过程中POST。在用户的表单处理程序中，提交的内容可以与从常规创建的内容相同的方式处理textarea。</p>
<p>这里定义了一个add方法 在富文本内编辑内容后,点击提交按钮即可获取到postForm.content的内容(富文本编辑的内容)</p>
<p><strong>当我们把富文本的内容传递后台后,如果有二次编辑的需求,后台又将数据原封不动的传递给前端,如何将传递回来的数据放置在富文本中呢?</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">使用方式:</span><br><span class="line">调用tinymce组件中的<span class="built_in">setContent</span>()方法即可;</span><br><span class="line">例如通过chage方法调用</span><br><span class="line">change () &#123;</span><br><span class="line">      this.$refs<span class="selector-class">.Tinymce</span><span class="selector-class">.setContent</span>(&quot;&#x27;&lt;<span class="selector-tag">h1</span>&gt;我是后台传递回来的数据,要放在富文本中二次编辑内容&lt;<span class="selector-tag">h1</span>&gt;&#x27;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>封装的代码都是看vue-element-admin开源项目的,具体代码还在学习当中,欢迎提出宝贵意见</p>
<h1 id="如何在Vue项目使用阿里iconfont图标"><a href="#如何在Vue项目使用阿里iconfont图标" class="headerlink" title="如何在Vue项目使用阿里iconfont图标"></a>如何在Vue项目使用阿里iconfont图标</h1><p><strong>我们在使用vue进行项目开发的时候,很多时候会手撸样式或者使用ui框架,这时候ui框架提供的原生icon图标可能会满足我们现有的需求,这时候我们就可以引用第三方图标库来达到我们的需求。</strong></p>
<p>这里讲解的是如何在vue中使用阿里图标;</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">阿里图标库有三种使用方式（<span class="title class_">Unicode</span>、<span class="title class_">Font</span> <span class="keyword">class</span>、<span class="title class_">Symbol</span>)</span><br><span class="line">这里主要说明 <span class="title class_">Font</span> <span class="keyword">class</span> 的使用方法（其他方法类似）</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="一、引入"><a href="#一、引入" class="headerlink" title="一、引入"></a>一、引入</h3><ul>
<li>登录阿里图标官网注册一个帐号,在图标库中选取自己需要的图标加入购物车</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bb7dbdc9b5be~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>点击购物车查看我已经添加到购物车的图标,点击添加至项目,没有项目新建一个</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bbae6fd05f92~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>进入我的项目中,将图标下载至本地,在vue项目中assets文件下新建iconfont文件夹将下载的图标复制到这里</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">因为这里主要说明Font <span class="keyword">class</span> 的使用方法,所以只需要拷贝这两个文件（其他方法类似）</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bec9394747a8~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>注意这里需要将iconfont.css文件中引用的路径全部修改为’.&#x2F;iconfont.ttf’</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">这里全部改为<span class="string">&#x27;./iconfont.ttf&#x27;</span>是因为我们当前只使用Font <span class="keyword">class</span> 的使用方法（其他方法类似）</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bf81b862e3d8~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>在main.js文件中引入阿里图标,将其挂载到全局,以后每个页面都可以使用 <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bee0a5b8575c~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这里引入阿里图标样式可能会报错,原因是没有css-loader依赖包,安装一下就可以了</span><br><span class="line">npm install css-loader -S</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>这里阿里图标的引入就全部完成了,接下来使用方式如图:</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bf0acce32c39~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<hr>
<p><strong>这里使用阿里图标都需要加iconfont前缀类名,否则不会显示出来的,当然这个类名是可以在阿里图标官网自己编辑的,默认都是iconfont</strong></p>
<ul>
<li>修改默认iconfont前缀类名</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bf30de05180a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>修改Font Famliy 修改为myicon,点击保存重新下载至本地替换当前阿里图标即可</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bf3f690f3561~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p>
<ul>
<li>这时候使用图标时前缀加myicon即可了</li>
</ul>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/7/26/16c2bf5f7a1c6ffc~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"> <strong>以上就是如何在vue中引用阿里图标的详细步骤了,完结撒花。</strong></p>
<p>作者：只会番茄炒蛋<br>链接：<a href="https://juejin.cn/post/6844903897509658638">https://juejin.cn/post/6844903897509658638</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<p>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>其他</title>
    <url>/2023/04/16/%E5%9B%9E%E9%A1%BE%E4%B8%8E%E6%9C%AA%E6%9D%A5%E5%BE%AE%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<p>回顾</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span> 三层架构</span><br><span class="line">    架构--》解耦</span><br><span class="line">  开发框架</span><br><span class="line">    spring</span><br><span class="line">      IOC AOP</span><br><span class="line">          IOC: 控制反转</span><br><span class="line">              约泡：</span><br><span class="line">                 泡温泉，泡茶，，，泡友</span><br><span class="line">                 流程：附近的人，打招呼，加微信，聊听啊----》约泡</span><br><span class="line">              浴场（容器）：温泉，茶庄，泡友</span><br><span class="line">                 直接进温泉，就有人和你一起</span><br><span class="line">              原来我们都是一步步操作，现在交给容器了，我们要就去拿</span><br><span class="line">          AOP： 切面（动态代理）</span><br><span class="line">              为了解决什么？在不影响业务本来的情况，实现动态增加，大量应用日志</span><br><span class="line">      spring是一个轻量级的java开源框架，容器</span><br><span class="line">      目的：解决企业开发的复杂性问题</span><br><span class="line">      spring是春天，也十分复杂</span><br><span class="line">    spring boot</span><br><span class="line">      新一代javaEE的开发标准，开箱机用！</span><br><span class="line">      帮我们配置非常多的东西</span><br><span class="line">      特定：约定&gt;配置</span><br><span class="line">随着公司体系越来越大，用户越来越多；</span><br><span class="line">微服务架构 --- &gt;新架构</span><br><span class="line">       模块化，功能化！</span><br><span class="line">       用户，支付，签到，娱乐,,</span><br><span class="line">       人多余多；<span class="number">1</span>台服务器不够；增加服务器！横向</span><br><span class="line">       假设A服务器 占用<span class="number">98</span>%资源，B服务器只占用<span class="number">10</span>%。-- 负载均衡</span><br><span class="line">           将整体项目分成模块化，分成模块化，用户就是一个单独的项目，项目和项目之前需要通信。如何通信？</span><br><span class="line">       用户非常多，而签到十分少  给用户多一点服务器，给签到少一点服务器！  </span><br><span class="line">微服务架构问题：</span><br><span class="line">      分布式架构会遇到的四个核心问题</span><br><span class="line">           <span class="number">1.</span> 这么多服务，客户端该如何去访问？ </span><br><span class="line">           <span class="number">2.</span> 这么多服务，服务之前如何进行通信？</span><br><span class="line">           <span class="number">3.</span> 这么多服务器，该如何治理？</span><br><span class="line">           <span class="number">4.</span> 服务挂了，怎么办？</span><br><span class="line">解决方案：</span><br><span class="line">      springcloud，是一套生态，就是来解决以上分布式架构的<span class="number">4</span>个问题。</span><br><span class="line">      想使用spring cloud，必须掌握spring boot。</span><br><span class="line">      <span class="number">1.</span> spring cloud Netflix 出来了一套解决方案</span><br><span class="line">           api网关，zuul组件</span><br><span class="line">           Feign --&gt; httpclient ---&gt;http的通信服务，同步并阻塞</span><br><span class="line">           服务注册与发现，Eureka</span><br><span class="line">           熔断机制 hystrix</span><br><span class="line">           </span><br><span class="line">           <span class="number">2018</span>年，Netflix宣布无限期停止维护，生态不再维护，就会脱节</span><br><span class="line">           </span><br><span class="line">       <span class="number">2.</span> Apache Dubbo zookeeper</span><br><span class="line">           API:没有！要么找第三方组件</span><br><span class="line">           Dubbo十一个高性能的基于java的 RPC框架</span><br><span class="line">           服务注册与发现，zookeeper</span><br><span class="line">           没有：借助了Hystrix</span><br><span class="line">            </span><br><span class="line">           不完善</span><br><span class="line">       <span class="number">3.</span> Spring Cloud Alibaba 一站式解决方案</span><br><span class="line">            </span><br><span class="line">               </span><br><span class="line">       <span class="number">4.</span> 目前又提出一种方案：</span><br><span class="line">          服务网格：下一代微服务标准</span><br><span class="line">               </span><br><span class="line">               </span><br><span class="line">万变不离其宗！</span><br><span class="line">       <span class="number">1.</span> API网关</span><br><span class="line">       <span class="number">2.</span> HTTP，RPC框架，异步调用</span><br><span class="line">       <span class="number">3.</span> 服务注册与发现，高可用</span><br><span class="line">       <span class="number">4.</span> 熔断机制，服务降级</span><br><span class="line">如果，你们基于这四个问题，开发解决方案，也叫spring cloud</span><br><span class="line">为什么解决这个问题，因为网络不可用</span><br><span class="line">           </span><br><span class="line">           </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>微服务</category>
      </categories>
  </entry>
  <entry>
    <title>vue_2</title>
    <url>/2023/04/17/vue_2/</url>
    <content><![CDATA[<h2 id="Vue中的全程动画"><a href="#Vue中的全程动画" class="headerlink" title="Vue中的全程动画"></a>Vue中的全程动画</h2><p>第一步： 需要把动画控制的元素用一个transition元素包裹起来，这个元素是Vue官方提供的。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">例如：</span><br><span class="line"><span class="comment">// &lt;transition&gt; &lt;h3&gt;我被transition元素包裹有了动画效果&lt;/h3&gt; &lt;/transition&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>第二步： 需要在style中定义你要控制元素的动画效果, Vue官方提供了6个class切换。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="comment">// 一般情况下， 元素的其实状态和终止状态的动画是一样的。</span></span><br><span class="line">    <span class="comment">// v-enter（这是一个时间点）是元素进入之前的其实状态，此时还没有开始进入。</span></span><br><span class="line">    <span class="comment">// v-lealve-to（这是一个时间点）是动画离开之后的终止状态，此时动画已经结束。</span></span><br><span class="line">    v-enter, v-leave-to&#123;</span><br><span class="line">        opctity: <span class="number">0</span> translateX(150px)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// v-enter-active是入场动画的时间段</span></span><br><span class="line">    <span class="comment">// v-leave-active是离场动画的时间段</span></span><br><span class="line">    v-enter-active，v-leave-active&#123;</span><br><span class="line">        transition： all <span class="number">0.</span>4s ease</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>第三步： 可以给动画添加时间属性 :duration</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 设置 :duration=&quot;毫秒值&quot; 属性来统一设置入场和离场动画的时长</span></span><br><span class="line">例如：设置入场和离场的动画时长为<span class="number">200</span>毫秒</span><br><span class="line">&lt;transition :duration=<span class="string">&quot;200&quot;</span>&gt; &lt;h3&gt;我被transition元素包裹有了动画效果&lt;/h3&gt; &lt;/transition&gt;</span><br><span class="line"><span class="comment">// 可以给:duration的值为一个对象，分别设置入场和离场的动画时长</span></span><br><span class="line">例如：</span><br><span class="line">&lt;transition :duration=<span class="string">&quot;&#123;enter:200, leave:400&#125;&quot;</span>&gt; &lt;h3&gt;我设置了入场和离场的动画时长&lt;/h3&gt; &lt;/transition&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>第四步： 我们可以自定义动画的前缀 v- 将其替换为自定义的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">例如：</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    my-enter, my-leave-to&#123;</span><br><span class="line">        opctity: <span class="number">0</span> translateX(150px)</span><br><span class="line">    &#125;</span><br><span class="line">    my-enter-active，my-leave-active&#123;</span><br><span class="line">        transition： all <span class="number">0.</span>4s ease</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;transition name=<span class="string">&quot;my&quot;</span>&gt; &lt;h3&gt;自定义动画的v-前缀&lt;/h3&gt; &lt;/transition&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：在实现列表过滤的时候，如果需要过度的元素是通过v-for循环出来的，不能使用 transition 元素包裹，需要使用 transition-group 元素包裹。</li>
<li>注意：再给 transition 和 transition-group 元素添加 appear 属性，可以实现页面创建出来的入场时候的动画。</li>
<li>注意：通过为 transition 和 transition-group 元素设置 tag 属性来指定渲染的标签元素，如果不指定默认渲染为 span 标签元素。</li>
<li>注意：通过为 transition 和 transition-group 元素设置 mode 属性来提供过度模式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 当前元素先进行过度，完成之后新元素过度进入</span></span><br><span class="line">&lt;transition mode=<span class="string">&quot;out-in&quot;</span>&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>设置动画过度模式<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span> &lt;/transition&gt;</span><br><span class="line"><span class="comment">// 新元素先进行过度，完成之后当前元素过度离开</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">mode</span>=<span class="string">&quot;in-out&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">h3</span>&gt;</span>设置动画过度模式<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h2 id="Vue中的半程动画"><a href="#Vue中的半程动画" class="headerlink" title="Vue中的半程动画"></a>Vue中的半程动画</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一步同样将被动画控制的元素用transition元素包裹起来</span></span><br><span class="line"><span class="comment">// 第二步调用钩子函数， 这里只介绍部分钩子，其余的动画钩子请移步到官网查看</span></span><br><span class="line">&lt;transition </span><br><span class="line">    <span class="meta">@before</span>-enter=<span class="string">&quot;beforeEnter&quot;</span></span><br><span class="line">    <span class="meta">@enter</span>=<span class="string">&quot;enter&quot;</span></span><br><span class="line">    <span class="meta">@after</span>-enter=<span class="string">&quot;afterEnter&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">&lt;h1&gt;半程动画&lt;/h1&gt;&lt;/transition&gt;</span><br><span class="line"><span class="comment">// 第三步在配置对象中的methods属性中定义方法</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        <span class="comment">// 注意：动画钩子函数的第一个参数 el 表示要执行动画的那个DOM元素，是个原生的js DOM元素</span></span><br><span class="line">        <span class="comment">// beforeEnter函数表示动画入场之前，此时动画还未开始，此时编辑动画之前的样式</span></span><br><span class="line">        beforeEnter (el) &#123;</span><br><span class="line">            el.style.transform = <span class="string">&quot;translate(0,0)&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// enter函数表示动画开始之后，这里可以设置完成动画之后的结束状态</span></span><br><span class="line">        enter (el) &#123;</span><br><span class="line">            <span class="comment">// 注意：这里要加一句el.offsetWidth/Height/Left/Right,这句话没有实际的作用。</span></span><br><span class="line">            <span class="comment">// 但是如果不写，不会出来动画效果，这里可以认为它会强制动画刷新。</span></span><br><span class="line">            el.offsetWidth</span><br><span class="line">            el.style.transform = <span class="string">&quot;translate(150px, 450px)&quot;</span></span><br><span class="line">            el.style.transiton = all 1s ease</span><br><span class="line">            <span class="title function_">done</span><span class="params">()</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 动画完成之后会调用这个函数</span></span><br><span class="line">        afterEnter (el) &#123;</span><br><span class="line">            <span class="comment">// 这里写动画完成以后的样式</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：在只用JavaScript过度的时候，在enter和leave中必须使用done进行回调，否则他们将被同步调用，过度会立即完成，看不到动画效果。</li>
</ul>
<h2 id="Vue中使用第三方类实现动画（全程）"><a href="#Vue中使用第三方类实现动画（全程）" class="headerlink" title="Vue中使用第三方类实现动画（全程）"></a>Vue中使用第三方类实现动画（全程）</h2><p>我们可以通过以下特性来自定义过渡类名：</p>
<ul>
<li>enter-class</li>
<li>enter-active-class</li>
<li>enter-to-class (2.1.8+)</li>
<li>leave-class</li>
<li>leave-active-class</li>
<li>leave-to-class (2.1.8+)</li>
</ul>
<p>他们的优先级高于普通的类名，这对于 Vue 的过渡系统和其他第三方 CSS 动画库，如 Animate.css 结合使用十分有用。</p>
<p>例如： 引入第三方 Animate.css 动画库</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在动画库中选取我们想要的动画效果名称，例如入场选 bounceln, 离场 bounceOut</span></span><br><span class="line">&lt;transition </span><br><span class="line">    enter-active-<span class="keyword">class</span>=<span class="string">&quot;animated bounceln&quot;</span></span><br><span class="line">    leave-active-<span class="keyword">class</span>=<span class="string">&quot;animated bounceOut&quot;</span></span><br><span class="line">&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>引用第三方动画库<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span> &lt;/transition&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：在引用第三方动画库选定动画类的的时候还要在其前面加上一个基本的类animated</li>
</ul>
<p>个人推荐在使用Vue的时候如果动画效果简单自己写就行，复杂的话在引用第三方动画库。而且在给元素添加动画的时候，要考虑清楚是加全程动画还是半程动画就够类。</p>
<h1 id="Vue中的组件"><a href="#Vue中的组件" class="headerlink" title="Vue中的组件"></a>Vue中的组件</h1><p>学习组件，我们首先要了解什么是组件。组件是Vue可以复用的Vue实例，且带有一个名字，在Vue中我们可以定义多个组件，在多个不同的页面的中引用多个多不同的组件，减少开发的工作量。因为组件是可复用的Vue实例，所以它们与new Vue接收相同的选项，例如：data,computed,watch,methods以及生命周期钩子等等，仅有的例外是像el这样根实例特有的选项。</p>
<h3 id="创建组件的几种方式"><a href="#创建组件的几种方式" class="headerlink" title="创建组件的几种方式"></a>创建组件的几种方式</h3><ul>
<li>第一种使用Vue.extend来创建全局的Vue组件</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建组件模版对象</span></span><br><span class="line"><span class="type">let</span> <span class="variable">mycomponent</span> <span class="operator">=</span> Vue.extend(&#123;</span><br><span class="line">    <span class="comment">// 通过template属性指定了组件要展示的HTML结构</span></span><br><span class="line">    template:<span class="string">&quot;&lt;div&gt;我是使用Vue.extend创建的组件&lt;/div&gt;&quot;</span> <span class="comment">// </span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用Vue.component(&quot;组件名称&quot;, 创建出来的组件模版对象)</span></span><br><span class="line">Vue.component(<span class="string">&quot;custom&quot;</span>, mycomponent) </span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接把组件的名称以HTML标签的形式引入到页面中就可以使用了</span></span><br><span class="line">&lt;custom&gt;&lt;/custom&gt; </span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>注意 ：不论是那种方式创建出来的组件，组件的template属性指向的模版内容，必须有且只能有一个唯一的根元素。</strong></p>
<p><strong>注意 ：在使用Vue.component定义全局组件的时候，组件名称使用驼峰命名，则在引用组件的时候，需要把大写的驼峰改为小写的字母，同时两个单词之间使用 - 连接，例如：</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Vue.component(<span class="string">&quot;customLabel&quot;</span>, mycomponent) <span class="comment">// 组件名称驼峰命名</span></span><br><span class="line">&lt;custom-label&gt;&lt;/custom-label&gt; <span class="comment">// 驼峰改为小写的字母，同时两个单词之间使用 - 连接</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>注册全局组件引用的简写方式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Vue.component(<span class="string">&quot;custom&quot;</span>, Vue.extend(&#123;</span><br><span class="line">    <span class="comment">// 通过template属性指定了组件要展示的HTML结构</span></span><br><span class="line">    template:<span class="string">&quot;&lt;div&gt;我是使用Vue.extend创建的组件&lt;/div&gt;&quot;</span> <span class="comment">// </span></span><br><span class="line">&#125;)) </span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>第二种使用Vue.component创建全局的Vue组件</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Vue.component(<span class="string">&quot;custom&quot;</span>, &#123;</span><br><span class="line">    <span class="comment">// 通过template属性指定了组件要展示的HTML结构</span></span><br><span class="line">    template:<span class="string">&quot;&lt;div&gt;我是使用Vue.component创建的组件&lt;/div&gt;&quot;</span> <span class="comment">// </span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过Vue.component的另一种书写方式创建全局组件</span></span><br><span class="line">Vue.component(<span class="string">&quot;custom&quot;</span>, &#123;template:<span class="string">&quot;#tmp&quot;</span>&#125;) <span class="comment">//  template属性指向一个id</span></span><br><span class="line"><span class="comment">// 在被控制的Vue实例el绑定的元素外，使用template元素定义组件的HTML模版结构</span></span><br><span class="line">&lt;template id=<span class="string">&quot;tmp&quot;</span>&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;我是Vue.component创建全局组件的第二种方式&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>第三种通过Vue实例的components属性创建Vue局部组件（实例内部私有组件）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    &lt;custom&gt;/custom&gt;</span><br><span class="line">    &lt;customTwo&gt;&lt;/customTwo&gt;</span><br><span class="line">    &lt;customThree&gt;&lt;/customThree&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;template id=<span class="string">&quot;tmp&quot;</span>&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;我是components创建的局部组件利用template元素&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="type">let</span> <span class="variable">customThree</span> <span class="operator">=</span> &#123;</span><br><span class="line">        template: <span class="string">&quot;&lt;div&gt;&lt;h1&gt;我是Vue实例外创建的组件模版对象&lt;/h1&gt;&lt;/div&gt;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        <span class="comment">// 第一种方式</span></span><br><span class="line">        <span class="string">&quot;custom&quot;</span>: &#123;template:<span class="string">&quot;&lt;div&gt;&lt;h1&gt;我是components创建的局部组件&lt;/h1&gt;&lt;/div&gt;&quot;</span>&#125;,</span><br><span class="line">        <span class="comment">// 第二种方式</span></span><br><span class="line">        <span class="string">&quot;customTwo&quot;</span>&#123;template:<span class="string">&quot;#tmp&quot;</span>&#125;，</span><br><span class="line">        <span class="comment">// 第三种方式</span></span><br><span class="line">        <span class="string">&quot;customThree&quot;</span>: customThree <span class="comment">// 自定义组件名称和组件模版对象名称一致可以简写为一个</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>注意 ： 组件中也可以定义数据和属性</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 但是组件中的data和实例中的data不一样，实例中的data可以为一个对象，但组件中的data必须是一个方法。</span></span><br><span class="line"><span class="comment">// 这个方法内部还必须return一个对象出来才行。</span></span><br><span class="line"><span class="comment">// 组件中data的数据和实例中data数据的使用方式完全一样</span></span><br><span class="line"><span class="comment">// 例如：</span></span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="keyword">data</span>: &#123;</span><br><span class="line">        msg: <span class="string">&quot;我是实例中data的数据&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">Vue.components(<span class="string">&quot;custom&quot;</span>,&#123;</span><br><span class="line">    template:<span class="string">&quot;&lt;div&gt; &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;&lt;/div&gt;&quot;</span>,</span><br><span class="line">    <span class="keyword">data</span> () &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            msg: <span class="string">&quot;我是组件中data的数据&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="Vue提供了components元素来展示对应名称的组件"><a href="#Vue提供了components元素来展示对应名称的组件" class="headerlink" title="Vue提供了components元素来展示对应名称的组件"></a>Vue提供了components元素来展示对应名称的组件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// components是一个占位符， :is 属性可以用来指定要展示的组件名称</span></span><br><span class="line"><span class="comment">// 注意 :is 属性的值为要展示的组件名称，但是也可以写成一个变量，方便某些时候动态切换要展示的组件。</span></span><br><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;msg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;change&quot;</span>&gt;</span>切换组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">msg</span>: <span class="string">&quot;custom&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">components</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">&quot;custom&quot;</span>: &#123;<span class="attr">template</span>:<span class="string">&quot;&lt;div&gt;&lt;h1&gt;我是components创建的局部组件custom&lt;/h1&gt;&lt;/div&gt;&quot;</span>&#125;，</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">&quot;customTwo&quot;</span>: &#123;<span class="attr">template</span>:<span class="string">&quot;&lt;div&gt;&lt;h1&gt;我是components创建的局部组件customTwo&lt;/h1&gt;&lt;/div&gt;&quot;</span>&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        change () &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// 通过chage方法动态改变msg的值来切换要展示的组件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="组件通信-x3D-gt-父子组件，兄弟组件之间通信"><a href="#组件通信-x3D-gt-父子组件，兄弟组件之间通信" class="headerlink" title="组件通信 &#x3D;&gt; 父子组件，兄弟组件之间通信"></a>组件通信 &#x3D;&gt; 父子组件，兄弟组件之间通信</h3><ul>
<li>组件通信中，子组件是无法访问到父组件中的数据和方法的。</li>
<li>父组件可以在引用子组件的时候，通过属性绑定(v-bind)的形式，把数据传递给子组件使用。</li>
<li>父组件通过自定义属性传过来的数据，需要子组件在props属性上接收才能使用。</li>
</ul>
<h4 id="父传子值"><a href="#父传子值" class="headerlink" title="父传子值"></a>父传子值</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    &lt;custom :parentmsg=<span class="string">&quot;msg&quot;</span>&gt;&lt;/custom&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">&quot;我是父组件中的数据&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        <span class="string">&quot;custom&quot;</span>: &#123;</span><br><span class="line">            props: [<span class="string">&quot;parentmsg&quot;</span>]，<span class="comment">// 子组件通过props属性接收父组件传来的数据</span></span><br><span class="line">            template:<span class="string">&quot;&lt;div&gt;&lt;h1&gt;我要引用父组件中的数据----&#123;&#123; parentmsg &#125;&#125;&lt;/h1&gt;&lt;/div&gt;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="父传子方法-子传父数据"><a href="#父传子方法-子传父数据" class="headerlink" title="父传子方法, 子传父数据"></a>父传子方法, 子传父数据</h3><p>父组件向子组件传递方法，使用的是事件绑定机制v-on,当我们自定义事件属性后，那么子组件就可以通过某些方式来调用父组件传递的这个方法。</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    <span class="comment">// 通过自定义事件名称func以事件绑定机制@func=&quot;show&quot;将父组件的show方法传递给子组件</span></span><br><span class="line">    &lt;custom <span class="meta">@func</span>=<span class="string">&quot;show&quot;</span>&gt;&lt;/custom&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    new Vue(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="keyword">data</span>: &#123;</span><br><span class="line">        msg: <span class="string">&quot;我是父组件中的数据&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        <span class="string">&quot;custom&quot;</span>: &#123;</span><br><span class="line">            props: [<span class="string">&quot;parentmsg&quot;</span>]，<span class="comment">// 子组件通过props属性接收父组件传来的数据</span></span><br><span class="line">            <span class="keyword">data</span> () &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    childmsg: <span class="string">&quot;我是子组件的数据&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            template:`</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;h1&gt;我要调用父组件传递过来的方法&lt;/h1&gt;</span><br><span class="line">                    &lt;button <span class="meta">@click</span>=<span class="string">&quot;emit&quot;</span>&gt;点我调用父组件传递的方法&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;`，</span><br><span class="line">            methods: &#123;</span><br><span class="line">                emit () &#123;</span><br><span class="line">                    <span class="comment">// 触发父组件传过来的func方法，配合参数可以将子组件的数据传递给父组件</span></span><br><span class="line">                    <span class="comment">// vm.$emit(evebtNane, [...args]) 触发当前实例上的事件，附加参数会传给监听器回调。</span></span><br><span class="line">                    <span class="keyword">this</span>.$emit(<span class="string">&quot;func&quot;</span>，<span class="keyword">this</span>.childmsg) </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;，</span><br><span class="line">    &#125;，</span><br><span class="line">    methods: &#123;</span><br><span class="line">        <span class="comment">// 子组件触发了我，并且给我传递了子组件的数据data</span></span><br><span class="line">        show (<span class="keyword">data</span>) &#123;</span><br><span class="line">            console.log(<span class="string">&quot;我是父组件中的show方法&quot;</span>)</span><br><span class="line">            console.log(<span class="string">&quot;接收到了子组件传递的数据---&quot;</span> + <span class="keyword">data</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>注意组件中所有props属性中的数据，都是通过父组件传递给子组件的。</li>
<li>props中的数据都是只读不可写的，data上的数据都是可读可写的，</li>
<li>子组件中data中的数据，并不是通过父组件传递过来的，而是子组件自己私有的。</li>
</ul>
<h3 id="兄弟组件之间数据传递"><a href="#兄弟组件之间数据传递" class="headerlink" title="兄弟组件之间数据传递"></a>兄弟组件之间数据传递</h3><ul>
<li>第一种借助中央事件总线</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// 重新实例一个Vue</span></span><br><span class="line">    <span class="type">let</span> <span class="variable">Bus</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vue</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">        el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">        components: &#123;</span><br><span class="line">            <span class="string">&quot;custom&quot;</span>: &#123;</span><br><span class="line">                template:`&lt;div <span class="meta">@click</span> = sendMsg&gt;</span><br><span class="line">                    &lt;button&gt;点我给customTwo组件传递我的数据&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;`,</span><br><span class="line">                data () &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        msg: <span class="string">&quot;我是custom组件的数据&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                methods: &#123;</span><br><span class="line">                    sendMsg () &#123;</span><br><span class="line">                        Bus.$emit(<span class="string">&quot;myFunc&quot;</span>, <span class="built_in">this</span>.msg) <span class="comment">// $emit这个方法会触发一个事件</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;，</span><br><span class="line">            <span class="string">&quot;customTwo&quot;</span>: &#123;</span><br><span class="line">                template:`&lt;div&gt;</span><br><span class="line">                    &lt;h1&gt;下面是我接收custom组件传来的数据&lt;/h1&gt;</span><br><span class="line">                    &lt;p&gt;&#123;&#123; customTwoMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">                &lt;/div&gt;`,</span><br><span class="line">                data () &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        customTwoMsg: <span class="string">&quot;&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;，</span><br><span class="line">                created () &#123;</span><br><span class="line">                    <span class="built_in">this</span>.brotherFunc()</span><br><span class="line">                &#125;,</span><br><span class="line">                methods: &#123;</span><br><span class="line">                    brotherFunc () &#123;</span><br><span class="line">                        Bus.$on(<span class="string">&quot;myFunc&quot;</span>, (data) =&gt; &#123; <span class="comment">// 这里要用箭头函数，否则this指向有问题。</span></span><br><span class="line">                            <span class="built_in">this</span>.customTwoMsg = data</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>这样借助总线机制，实现兄弟组件之间的数据共享。</p>
<ul>
<li>第二种借助第三方vuex库（这是我推荐使用的）</li>
</ul>
<p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。Vuex 也集成到 Vue 的官方调试工具 devtools extension，提供了诸如零配置的 time-travel 调试、状态快照导入导出等高级调试功能。</p>
<h1 id="Vue中的标签-x2F-如何获取DOM元素"><a href="#Vue中的标签-x2F-如何获取DOM元素" class="headerlink" title="Vue中的标签&#x2F;如何获取DOM元素"></a>Vue中的标签&#x2F;如何获取DOM元素</h1><p>Vue中提供了一些固定的标签来方便我们在开发过程中使用，并且在开发过程中，我们很有可能因为要使用某些第三方库而不得已要操作DOM元素，因此如何获取并操作DOM元素的使用呢。</p>
<h3 id="Vue中提供的标签"><a href="#Vue中提供的标签" class="headerlink" title="Vue中提供的标签"></a>Vue中提供的标签</h3><ul>
<li>component</li>
</ul>
<p>这个标签是用来展示组件的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    &lt;component :is=<span class="string">&quot;要展示的组件名称&quot;</span>&gt;&lt;/component&gt; </span><br><span class="line">    &lt;custom&gt;&lt;/custom&gt; <span class="comment">// 直接通过自定义组件名称当作标签使用</span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        <span class="string">&quot;要展示的组件名称&quot;</span>: &#123;</span><br><span class="line">            template: `&lt;div&gt; <span class="comment">// 注意自定义组件的模版对象需要有且只有一个根标签。</span></span><br><span class="line">                &lt;h1&gt;我是自定的组件一&lt;/h1&gt;</span><br><span class="line">            &lt;/div&gt;`</span><br><span class="line">        &#125;，</span><br><span class="line">        <span class="string">&quot;custom&quot;</span>: &#123;</span><br><span class="line">            template: `&lt;div&gt;</span><br><span class="line">                &lt;h1&gt;我是自定义组件二&lt;/h1&gt;</span><br><span class="line">            &lt;/div&gt;`</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>template</li>
</ul>
<p>这个标签用来定义组件的HTML结构</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">custom</span>&gt;</span><span class="tag">&lt;/<span class="name">custom</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;tmp&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是用template标签定义组件的HTML模版<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">components</span>: &#123;</span><br><span class="line">        <span class="string">&quot;custom&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;#tmp&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>transition</li>
</ul>
<p>这个标签是用来把需要被动画控制的元素包裹起来，展示自定义的动画效果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="comment">// 一般情况下， 元素的其实状态和终止状态的动画是一样的。</span></span><br><span class="line">    <span class="comment">// v-enter（这是一个时间点）是元素进入之前的其实状态，此时还没有开始进入。</span></span><br><span class="line">    <span class="comment">// v-lealve-to（这是一个时间点）是动画离开之后的终止状态，此时动画已经结束。</span></span><br><span class="line">    v-enter, v-leave-to&#123;</span><br><span class="line">        opctity: <span class="number">0</span> translateX(150px)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// v-enter-active是入场动画的时间段</span></span><br><span class="line">    <span class="comment">// v-leave-active是离场动画的时间段</span></span><br><span class="line">    v-enter-active，v-leave-active&#123;</span><br><span class="line">        transition： all <span class="number">0.</span>4s ease</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    &lt;transition&gt;</span><br><span class="line">        &lt;h1&gt;我是有动画效果的&lt;/h1&gt;</span><br><span class="line">    &lt;/transition&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>transition-group</li>
</ul>
<p>通过v-for渲染出来的标签不能使用transition包裹， 需要使用transition-group包裹添加动画。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="comment">// 一般情况下， 元素的其实状态和终止状态的动画是一样的。</span></span><br><span class="line">    <span class="comment">// v-enter（这是一个时间点）是元素进入之前的其实状态，此时还没有开始进入。</span></span><br><span class="line">    <span class="comment">// v-lealve-to（这是一个时间点）是动画离开之后的终止状态，此时动画已经结束。</span></span><br><span class="line">    v-enter, v-leave-to&#123;</span><br><span class="line">        <span class="attr">opctity</span>: <span class="number">0</span> <span class="title function_">translateX</span>(150px)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// v-enter-active是入场动画的时间段</span></span><br><span class="line">    <span class="comment">// v-leave-active是离场动画的时间段</span></span><br><span class="line">    v-enter-active，v-leave-active&#123;</span><br><span class="line">        transition： all <span class="number">0.</span>4s ease</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">tag</span>=<span class="string">&quot;ul&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item of list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是有动画效果的<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">list</span>:[</span><br><span class="line">            &#123;<span class="attr">name</span>:<span class="string">&quot;fanqie&quot;</span>, <span class="attr">id</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="attr">name</span>: <span class="string">&quot;chaofan&quot;</span>, <span class="attr">id</span>: <span class="number">2</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>keep-alive</li>
</ul>
<p>当前标签包裹组件时，会缓存不活动的组件实例，而不是销毁它们，keep-alive是一个抽象组件：它自身不会渲染一个DOM元素，也不会出现在父组件中。</p>
<p>当组件在内被切换，它的 activated 和 deactivated 这个两个生命周期钩子函数将会被对应执行。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 主要用于保留组件状态或避免重新渲染。</span></span><br><span class="line">&lt;!-- 基本 --&gt;</span><br><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;component :is=<span class="string">&quot;view&quot;</span>&gt;&lt;/component&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 多个条件判断的子组件 --&gt;</span><br><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;comp-a v-<span class="keyword">if</span>=<span class="string">&quot;a &gt; 1&quot;</span>&gt;&lt;/comp-a&gt;</span><br><span class="line">  &lt;comp-b v-<span class="keyword">else</span>&gt;&lt;/comp-b&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 和 `&lt;transition&gt;` 一起使用 --&gt;</span><br><span class="line">&lt;transition&gt;</span><br><span class="line">  &lt;keep-alive&gt;</span><br><span class="line">    &lt;component :is=<span class="string">&quot;view&quot;</span>&gt;&lt;/component&gt;</span><br><span class="line">  &lt;/keep-alive&gt;</span><br><span class="line">&lt;/transition&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>注意，keep-alive 是用在其一个直属的子组件被开关的情形。如果你在其中有 v-for 则不会工作。如果有上述的多个条件性的子元素，keep-alive 要求同时只有一个子元素被渲染。</p>
<ul>
<li>solt</li>
</ul>
<p>slot 元素作为组件模板之中的内容分发插槽。slot 元素自身将被替换。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 和HTML元素一样，我们经常需要向组件传递内容，例如：</span></span><br><span class="line"><span class="comment">// custom 是自定义的组件</span></span><br><span class="line">&lt;custom&gt; </span><br><span class="line">    &lt;div&gt;我是在组件内添加的标签&lt;/div&gt;</span><br><span class="line">&lt;/custom&gt; </span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>但是我们渲染出来的却是这样：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/4/1/169d6d92a7b2eebb~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"> 幸好，Vue 自定义的  元素让这变得非常简单：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Vue.component(<span class="string">&#x27;custom&#x27;</span>, &#123;</span><br><span class="line">  template: `</span><br><span class="line">    &lt;div class=<span class="string">&quot;demo-alert-box&quot;</span>&gt;</span><br><span class="line">      &lt;strong&gt;Error!&lt;/strong&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  `</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="Vue中获取DOM元素"><a href="#Vue中获取DOM元素" class="headerlink" title="Vue中获取DOM元素"></a>Vue中获取DOM元素</h3><p>在我们的vue项目中，难免会因为引用第三方库而需要操作DOM标签，vue为我们提供了ref属性。 ref 被用来给元素或子组件注册引用信息。引用信息将会注册在父组件的 $refs 对象上。如果在普通的 DOM 元素上使用，引用指向的就是 DOM 元素；如果用在子组件上，引用就指向组件实例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;p ref=<span class="string">&quot;p&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"><span class="comment">// 现在在你已经定义了这个 ref 的组件里，你可以使用：</span></span><br><span class="line"><span class="built_in">this</span>.$refs.p 来操作这个DOM元素来。</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>vue不提倡我们操作DOM元素，因此在引用第三方插件或者项目中，尽量少的不要出现操作DOM元素。</p>
<p>作者：只会番茄炒蛋<br>链接：<a href="https://juejin.cn/post/6844903810935029767">https://juejin.cn/post/6844903810935029767</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>微服务阶段以及需要考虑的问题</title>
    <url>/2023/04/16/%E5%BE%AE%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<p>微服务阶段</p>
<p>javase:oop;</p>
<p>mysql:持久化；</p>
<p>html+css+js+jquery+框架；</p>
<p>javaweb:独立开发mvc三层架构；</p>
<p>ssm :框架</p>
<p>war：tomcat运行</p>
<p>spring再简化：springBoot -jar :内嵌tomcat;微服务;</p>
<p>服务越来越多 spring cloud;</p>
<p>阶段六： spring boot—spring cloud</p>
<p><img src="C:\Users\小木木\AppData\Roaming\Typora\typora-user-images\image-20230313170705578.png" alt="image-20230313170705578"></p>
<h3 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h3><p>用户下单 controller！</p>
<p>仓库解冻；资金冻结；验证；购买成功，仓库数量减少。资金解冻，仓库解冻；10s</p>
<p>MVC三层架构 mvvc 微服务架构</p>
<p>业务： service：</p>
<p>微服务架构区别于传统的单体软件架构，是一种为了适应当前互联网后台服务的「<strong>三高需求：高并发、高性能、高可用</strong>」而产生的的软件架构。</p>
<p>由于工作需要，本人曾调研过微服务相关内容，其实微服务也没什么神秘的，今天就用图解的形式了来和大家唠唠<strong>什么是微服务？</strong></p>
<h2 id="单体式应用程序"><a href="#单体式应用程序" class="headerlink" title="单体式应用程序"></a><strong>单体式应用程序</strong></h2><p>与微服务相对的另一个概念是传统的<strong>单体式应用程序</strong>( Monolithic application )，单体式应用内部包含了所有需要的服务。而且各个服务功能模块有很强的耦合性，也就是相互依赖彼此，很难拆分和扩容。</p>
<p>说在做的各位都写过单体程序，大家都没意见吧？给大家举个栗子，刚开始写代码你写的helloworld程序就是单体程序，一个程序包含所有功能，虽然 helloworld 功能很简单。</p>
<h3 id="单体应用程序的优点"><a href="#单体应用程序的优点" class="headerlink" title="单体应用程序的优点"></a>单体应用程序的优点</h3><ul>
<li>开发简洁，功能都在单个程序内部，便于软件设计和开发规划。</li>
<li>容易部署，程序单一不存在分布式集群的复杂部署环境，降低了部署难度。</li>
<li>容易测试，没有各种复杂的服务调用关系，都是内部调用方便测试。</li>
</ul>
<h3 id="单体应用程序的缺点"><a href="#单体应用程序的缺点" class="headerlink" title="单体应用程序的缺点"></a><strong>单体应用程序的缺点</strong></h3><p>单体程序的缺点一开始不是特别明显，项目刚开始需求少，业务逻辑简单，写代码一时爽，一直爽。噩梦从业务迭代更新，系统日益庞大开始，前期的爽没有了，取而代之的是软件维护和迭代更新的无尽痛苦。</p>
<p><img src="https://pic1.zhimg.com/80/v2-28abdbf63886720b624e7d72f9bdb418_720w.webp" alt="img"></p>
<p>由于单体式应用程序就像一个大型容器一样，里面放置了许多服务，且他们都是密不可分的，这导致应用程序在扩展时必须以「应用程序」为单位。</p>
<p>当里面有个业务模块负载过高时，并不能够单独扩展该服务，必须扩展整个应用程序（就是这么霸道），这可能导致额外的资源浪费。</p>
<p>此外，单体式应用程序由于服务之间的紧密度、相依性过高，这将导致测试、升级有所困难，且开发曲线有可能会在后期大幅度地上升，令开发不易。相较之下「微服务架构」能够解决这个问题。</p>
<h2 id="微服务-1"><a href="#微服务-1" class="headerlink" title="微服务"></a><strong>微服务</strong></h2><p>微服务 (Microservices) 就是一些协同工作小而自治的服务。</p>
<blockquote>
<p>2014年，<a href="https://link.zhihu.com/?target=https://zh.wikipedia.org/wiki/Martin_Fowler">Martin Fowler</a> 与 <a href="https://link.zhihu.com/?target=https://zh.wikipedia.org/w/index.php?title=James_Lewis&action=edit&redlink=1">James Lewis</a> 共同提出了微服务的概念，定义了微服务是由以单一应用程序构成的小服务，自己拥有自己的行程与轻量化处理，服务依业务功能设计，以全自动的方式部署，与其他服务使用 HTTP API 通信。同时服务会使用最小的规模的集中管理 (例如 <a href="https://link.zhihu.com/?target=https://zh.wikipedia.org/wiki/Docker">Docker</a>) 能力，服务可以用不同的编程语言与数据库等组件实现 。「维基百科」</p>
</blockquote>
<h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a><strong>举例</strong></h3><p><img src="https://pic4.zhimg.com/80/v2-e4a1491d321a9389cd1e6585d354f3b7_720w.webp" alt="img"></p>
<p>还是拿前面的 helloworld 程序来举栗子，想象一下你是 helloworld 公司的 CTO（老板还缺人吗？会写代码的那种），假设你们公司的 helloworld 业务遍布全球，需要编写不同语种的 helloworld<br>版本，分别输出英语、日语、法语、俄语…现在世界有6000多种语言（奇怪的知识又增加了）。</p>
<p>有人会说这还不简单我用switch case语句就完事了，同学，不要较真我就是举个例子，现实中的业务比 helloworld 复杂多了。好了，我们姑且认为按语言输出是个庞大复杂的工作，这时候就可以用微服务架构了，架构图如下：</p>
<p><img src="https://pic4.zhimg.com/80/v2-10ffb1a815476a629c526ae66a510c3b_720w.webp" alt="img"></p>
<h2 id="微服务与SOA"><a href="#微服务与SOA" class="headerlink" title="微服务与SOA"></a><strong>微服务与SOA</strong></h2><p><strong>面向服务的体系结构</strong> SOA (Service-Oriented Architecture) 听起来和微服务很像，但 SOA<br>早期均使用了总线模式，这种总线模式是与某种技术栈强绑定的，比如：J2EE。这导致很多企业的遗留系统很难对接，切换时间太长，成本太高，新系统稳定性的收敛也需要一些时间，最终 SOA 看起来很美，但却成为了企业级奢侈品，中小公司都望而生畏。</p>
<p>此外，实施SOA时会遇到很多问题，比如通信协议（例如SOAP)<br>的选择、第三方中间件如何选择、服务粒度如何确定等，目前也存在一些关于如何划分系统的指导性原则，但其中有很多都是错误的。SOA并没有告诉你如何划分单体应用成微服务，所以在实施SOA时会遇到很多问题。</p>
<p>这些问题再微服务框架中得到很好的解决，你可以认为微服务架构是SOA的一种特定方法。</p>
<h2 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a><strong>微服务架构</strong></h2><p>合久必分，鉴于「单体应用程序」有上述的缺点，单个应用程序被划分成各种小的、互相连接的微服务，一个微服务完成一个比较单一的功能，相互之间保持独立和解耦合，这就是微服务架构。</p>
<h3 id="微服务优点"><a href="#微服务优点" class="headerlink" title="微服务优点"></a><strong>微服务优点</strong></h3><p>相对于单体服务，微服务有很多优点，这里列举几个主要的好处</p>
<h3 id="技术异构性"><a href="#技术异构性" class="headerlink" title="技术异构性"></a>技术异构性</h3><p>不同服务内部的开发技术可以不一致，你可以用java来开发helloworld服务A，用golang来开发helloworld服务B，大家再也不用为哪种语言是世界上最好的语言而争论不休。</p>
<p><img src="https://pic2.zhimg.com/80/v2-7562b0be8f63c7823e09d7a295d9cf99_720w.webp" alt="img"></p>
<p>为不同的服务选择最适合该服务的技术，系统中不同部分也可以使用不同的存储技术，比如A服务可以选择redis存储，B服务你可以选择用MySQL存储，这都是允许的，你的服务你做主。</p>
<h3 id="隔离性"><a href="#隔离性" class="headerlink" title="隔离性"></a>隔离性</h3><p>一个服务不可用不会导致另一个服务也瘫痪，因为各个服务是相互独立和自治的系统。这在单体应用程序中是做不到的，单体应用程序中某个模块瘫痪，必将导致整个系统不可用，当然，单体程序也可以在不同机器上部署同样的程序来实现备份，不过，同样存在上面说的资源浪费问题。</p>
<h3 id="可扩展性"><a href="#可扩展性" class="headerlink" title="可扩展性"></a>可扩展性</h3><p>庞大的单体服务如果出现性能瓶颈只能对软件整体进行扩展，可能真正影响性能的只是其中一个很小的模块，我们也不得不付出升级整个应用的代价。这在微服务架构中得到了改善，你可以只对那些影响性能的服务做扩展升级，这样对症下药的效果是很好的。</p>
<h3 id="简化部署"><a href="#简化部署" class="headerlink" title="简化部署"></a>简化部署</h3><p>如果你的服务是一个超大的单体服务，有几百万行代码，即使修改了几行代码也要重新编译整个应用，这显然是非常繁琐的，而且软件变更带来的不确定性非常高，软件部署的影响也非常大。在微服务架构中，各个服务的部署是独立的，如果真出了问题也只是影响单个服务，可以快速回滚版本解决。</p>
<h3 id="易优化"><a href="#易优化" class="headerlink" title="易优化"></a>易优化</h3><p>微服务架构中单个服务的代码量不会很大，这样当你需要重构或者优化这部分服务的时候，就会容易很多，毕竟，代码量越少意味着代码改动带来的影响越可控。</p>
<h3 id="微服务缺点"><a href="#微服务缺点" class="headerlink" title="微服务缺点"></a><strong>微服务缺点</strong></h3><p>我们上面一直在强调微服务的好处，但是，微服务架构不是万能的，并不能解决所有问题，其实这也是微服务把单体应用拆分成很多小的分布式服务导致的，所谓人多手杂，服务多起来管理的不好各种问题就来了。</p>
<p>为了解决微服务的缺点，前辈们提出了下面这些概念。</p>
<h3 id="服务注册与发现"><a href="#服务注册与发现" class="headerlink" title="服务注册与发现"></a>服务注册与发现</h3><p>微服务之间相互调用完成整体业务功能，如何在众多微服务中找到正确的目标服务地址，这就是所谓「服务发现」功能。</p>
<p>常用的做法是服务提供方启动的时候把自己的地址上报给「服务注册中心」，这就是「服务注册」。服务调用方「订阅」服务变更「通知」，动态的接收服务注册中心推送的服务地址列表，以后想找哪个服务直接发给他就可以。</p>
<p><img src="https://pic2.zhimg.com/80/v2-3578297e7768e6c99d1fa1f33ebde659_720w.webp" alt="img"></p>
<h3 id="服务监控"><a href="#服务监控" class="headerlink" title="服务监控"></a>服务监控</h3><p>单体程序的监控运维还好说，大型微服务架构的服务运维是一大挑战。服务运维人员需要实时的掌握服务运行中的各种状态，最好有个控制面板能看到服务的内存使用率、调用次数、健康状况等信息。</p>
<p>这就需要我们有一套完备的服务监控体系，包括拓扑关系、监控（Metrics）、日志监控（Logging）、调用追踪（Trace）、告警通知、健康检查等，防患于未然。</p>
<h3 id="服务容错"><a href="#服务容错" class="headerlink" title="服务容错"></a>服务容错</h3><p>任何服务都不能保证100%不出问题，生产环境复杂多变，服务运行过程中不可避免的发生各种故障（宕机、过载等等），工程师能够做的是在故障发生时尽可能降低影响范围、尽快恢复正常服务。</p>
<p>程序员为此避免被祭天，需要引入「熔断、隔离、限流和降级、超时机制」等「服务容错」机制来保证服务持续可用性。</p>
<h3 id="服务安全"><a href="#服务安全" class="headerlink" title="服务安全"></a>服务安全</h3><p>有些服务的敏感数据存在安全问题，「服务安全」就是对敏感服务采用安全鉴权机制，对服务的访问需要进行相应的身份验证和授权，防止数据泄露的风险，安全是一个长久的话题，在微服务中也有很多工作要做。</p>
<h2 id="服务治理"><a href="#服务治理" class="headerlink" title="服务治理"></a><strong>服务治理</strong></h2><p>说到「治理」一般都是有问题才需要治理，我们平常说环境治理、污染治理一个意思，微服务架构中的微服务越来越多，上面说的那些问题就更加显现，为了解决上面微服务架构缺陷「服务治理」就出现了。</p>
<p><img src="https://pic1.zhimg.com/80/v2-238e741a39592caeb236a001013580a0_720w.webp" alt="img"></p>
<p>微服务的那些问题都要公司技术团队自己解决的话，如果不是大型公司有成熟的技术团队，估计会很头大。幸好，有巨人的肩膀可以借给我们站上去，通过引入「微服务框架」来帮助我们完成服务治理。</p>
<h2 id="微服务框架"><a href="#微服务框架" class="headerlink" title="微服务框架"></a><strong>微服务框架</strong></h2><p>介绍一些业界比较成熟的微服务框架。</p>
<h3 id="Dubbo"><a href="#Dubbo" class="headerlink" title="Dubbo"></a><strong>Dubbo</strong></h3><p>是阿里巴巴公司开源的一个Java高性能优秀的服务框架，使得应用可通过高性能的 RPC 实现服务的输出和输入功能，可以和 Spring框架无缝集成。 Apache Dubbo |ˈdʌbəʊ| 是一款高性能、轻量级的开源Java<br>RPC框架，它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现 。2011 年末对外开源，仅支持 Java 语言。</p>
<p>官网：<a href="https://link.zhihu.com/?target=http://dubbo.apache.org/zh-cn/">http://dubbo.apache.org/zh-cn/</a></p>
<h3 id="Tars"><a href="#Tars" class="headerlink" title="Tars"></a><strong>Tars</strong></h3><p>腾讯内部使用的微服务架构 TAF（Total Application Framework）多年的实践成果总结而成的开源项目。 仅支持 C++ 语言，目前在腾讯内部应用也非常广泛。2017 年对外开源，仅支持 C++ 语言。</p>
<p>源码： <a href="https://link.zhihu.com/?target=https://github.com/TarsCloud/Tars/">https://github.com/TarsCloud/Tars/</a></p>
<p><img src="https://pic3.zhimg.com/80/v2-8fe78be188c0577ec94e2fb443ec09e2_720w.webp" alt="img"></p>
<h2 id="工作原因，本身用的较多的是腾讯自研-TARS-框架，这个RPC框架的详细介绍-PPT-已下载，文末也给出了。"><a href="#工作原因，本身用的较多的是腾讯自研-TARS-框架，这个RPC框架的详细介绍-PPT-已下载，文末也给出了。" class="headerlink" title="工作原因，本身用的较多的是腾讯自研 TARS 框架，这个RPC框架的详细介绍 PPT 已下载，文末也给出了。"></a><strong>工作原因，本身用的较多的是腾讯自研 TARS 框架，这个RPC框架的详细介绍 PPT 已下载，文末也给出了。</strong></h2><h3 id="Motan"><a href="#Motan" class="headerlink" title="Motan"></a><strong>Motan</strong></h3><p>是新浪微博开源的一个Java 框架。Motan 在微博平台中已经广泛应用，每天为数百个服务完成近千亿次的调用。于 2016 年对外开源，仅支持 Java 语言。</p>
<p>官方指南： <a href="https://link.zhihu.com/?target=https://github.com/weibocom/motan/wiki/zh_userguide">https://github.com/weibocom/motan/wiki/zh_userguide</a></p>
<p><img src="https://pic3.zhimg.com/80/v2-8980cffbcf69b0987418b0b003d2a1a2_720w.webp" alt="img"></p>
<h3 id="gRPC"><a href="#gRPC" class="headerlink" title="gRPC"></a><strong>gRPC</strong></h3><p>是Google开发的高性能、通用的开源RPC框架，其由Google主要面向移动应用开发并基于HTTP&#x2F;2协议标准而设计，基于ProtoBuf(Protocol Buffers)<br>序列化协议开发。本身它不是分布式的，所以要实现上面的框架的功能需要进一步的开发。2015 年对外开源的跨语言 RPC 框架，支持多种语言。</p>
<p>中文教程：<a href="https://link.zhihu.com/?target=https://doc.oschina.net/grpc?t=58008">https://doc.oschina.net/grpc?t=58008</a></p>
<p><img src="https://pic4.zhimg.com/80/v2-c0eb4a1e7411af2da9ffa76b9969ef33_720w.webp" alt="img"></p>
<h3 id="thrift"><a href="#thrift" class="headerlink" title="thrift"></a><strong>thrift</strong></h3><p>最初是由 Facebook 开发的内部系统跨语言的高性能 RPC 框架，2007 年贡献给了 Apache 基金，成为 Apache 开源项目之一， 跟 gRPC 一样，Thrift 也有一套自己的接口定义语言<br>IDL，可以通过代码生成器，生成各种编程语言的 Client 端和 Server 端的 SDK 代码，支持多种语言。</p>
<p><img src="https://pic2.zhimg.com/80/v2-08205252ae7a4b5632c3087ff7167a85_720w.webp" alt="img"></p>
<h2 id="微服务框架和RPC"><a href="#微服务框架和RPC" class="headerlink" title="微服务框架和RPC"></a><strong>微服务框架和RPC</strong></h2><p>很多人对这两个概念有点混淆，微服务框架上面我们说过了，我们再来看下RPC的概念。</p>
<h3 id="什么是RPC"><a href="#什么是RPC" class="headerlink" title="什么是RPC"></a><strong>什么是RPC</strong></h3><p>RPC (Remote Procedure Call)<br>远程过程调用是一个计算机通信协议。我们一般的程序调用是本地程序内部的调用，RPC允许你像调用本地函数一样去调用另一个程序的函数，这中间会涉及网络通信和进程间通信，但你无需知道实现细节，RPC框架为你屏蔽了底层实现。RPC是一种服务器-客户端（Client&#x2F;Server）模式，经典实现是一个通过**<br>发送请求-接受回应**进行信息交互的系统。</p>
<h3 id="两者关系"><a href="#两者关系" class="headerlink" title="两者关系"></a><strong>两者关系</strong></h3><p>RPC和微服务框架的关系我的理解，微服务框架一般都包含了RPC的实现和一系列「服务治理」能力，是一套软件开发框架。我们可以基于这个框架之上实现自己的微服务，方便的利用微服务框架提供的「服务治理」能力和RPC能力，所以微服务框架也被有些人称作RPC框架。</p>
<h2 id="下一代微服务架构"><a href="#下一代微服务架构" class="headerlink" title="下一代微服务架构"></a><strong>下一代微服务架构</strong></h2><p>Service Mesh（服务网格）被认为是下一代微服务架构，Service Mesh并没有给我们带来新的功能，它是用于解决其他工具已经解决过的服务网络调用、限流、熔断和监控等问题，只不过这次是在Cloud Native 的<br>kubernetes 环境下的实现。</p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a><strong>特点</strong></h3><p>Service Mesh 有如下几个特点：</p>
<ul>
<li>应用程序间通讯的中间层</li>
<li>轻量级网络代理</li>
<li>应用程序无感知</li>
<li>解耦应用程序的重试&#x2F;超时、监控、追踪和服务发现</li>
</ul>
<p>目前两款流行的 Service Mesh 开源软件 <a href="%5Bhttps://istio.io/%5D(https://link.zhihu.com/?target=https://istio.io/)">Istio</a><br>和 <a href="%5Bhttps://linkerd.io/%5D(https://link.zhihu.com/?target=https://linkerd.io/)">Linkerd</a>都可以直接在kubernetes<br>中集成，其中Linkerd已经成为云原生计算基金会 CNCF (Cloud Native Computing Foundation) 成员。</p>
<h3 id="Why-Service-Mesh"><a href="#Why-Service-Mesh" class="headerlink" title="Why Service Mesh"></a><strong>Why Service Mesh</strong></h3><p>为什么现有微服务架构已经解决的问题还要用Service Mesh呢？这个问题问的好。</p>
<p><img src="https://pic1.zhimg.com/80/v2-a7de7ff7d10faf4f58b8bee244d50e60_720w.webp" alt="img"></p>
<p>回答问题之前，先看下<a href="https://link.zhihu.com/?target=http://istio.io">http://istio.io</a>上对service mesh的解释，我觉得挺好的，摘抄出来：</p>
<blockquote>
<p>As a service mesh grows in size and complexity, it can become harder to understand and manage. Its requirements can include discovery, load balancing, failure recovery, metrics, and monitoring. A service mesh also often has more complex operational requirements, like A&#x2F;B testing, canary rollouts, rate limiting, access control, and end-to-end authentication. makes it easy to create a network of deployed services with load balancing, service-to-service authentication, monitoring, and more, <strong>with few or no code changes in service code.</strong></p>
</blockquote>
<p>试着总结一下：随着微服务的增多复杂程度也增加，管理变得更加困难，微服务架构虽然解决了「网络调用、限流、熔断和监控」等问题，但大多数框架和开源软件对原有业务是侵入式的，也就是需要在业务服务程序中集成相关的「服务治理」组件。</p>
<p>Service Mesh之于微服务，就像TCP&#x2F;IP之于互联网，TCP&#x2F;IP为网络通信提供了面向连接的、可靠的、基于字节流的基础通信功能，你不再需要关心底层的重传、校验、流量控制、拥塞控制。</p>
<p>用了Service Mesh你也不必去操心「服务治理」的细节，不需要对服务做特殊的改造，所有业务之外的功能都由Service Mesh帮你去做了。它就像一个轻量级网络代理<br>对应用程序来说是透明，所有应用程序间的流量都会通过它，所以对应用程序流量的控制都可以在 serivce mesh 中实现 。</p>
<p><img src="https://pic3.zhimg.com/80/v2-2a2e5b537c564ad8cf1dcd1b47d5d68a_720w.webp" alt="img"></p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a><strong>写在最后</strong></h2><p>在IT世界没有什么技术是永不过时的，微服务架构的演进就是一个例子，从单体程序到微服务架构，再到service mesh架构，我不知道下一个技术迭代点是什么时候，但我知道微服务架构肯定还会更新，IT人更应该建立终身学习习惯。<br>当然更重要的是拥有对技术的热情，热于拥抱变化、接受新技术，当我看到新技术我是兴奋的，内心os是厉害了，还能这么玩！，希望你也有这般热情，而不仅仅是面向工资编程，生活会有趣很多。</p>
<h3 id="你主导面试官"><a href="#你主导面试官" class="headerlink" title="你主导面试官"></a>你主导面试官</h3>]]></content>
      <categories>
        <category>微服务</category>
      </categories>
  </entry>
  <entry>
    <title>其他</title>
    <url>/2023/04/16/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3synchronized%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%EF%BC%8C%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B0%B1%E5%A4%9F%E4%BA%86%EF%BC%81/</url>
    <content><![CDATA[<h1 id="深入理解synchronized底层原理，一篇文章就够了！"><a href="#深入理解synchronized底层原理，一篇文章就够了！" class="headerlink" title="深入理解synchronized底层原理，一篇文章就够了！"></a>深入理解synchronized底层原理，一篇文章就够了！</h1><ul>
<li>前言</li>
<li>一、synchronized的特性<ul>
<li>1.1 原子性</li>
<li>1.2 可见性</li>
<li>1.3 有序性</li>
<li>1.4 可重入性</li>
</ul>
</li>
<li>二、synchronized的用法</li>
<li>三、synchronized锁的实现<ul>
<li>3.1 同步方法</li>
<li>3.2 同步代码块</li>
</ul>
</li>
<li>四、synchronized锁的底层实现</li>
<li>五、JVM对synchronized的优化<ul>
<li>5.1 锁膨胀<ul>
<li>5.1.1 偏向锁</li>
<li>5.1.2 轻量级锁</li>
<li>5.1.3 重量级锁</li>
</ul>
</li>
<li>5.2 锁消除</li>
<li>5.3 锁粗化</li>
<li>5.4 自旋锁与自适应自旋锁</li>
</ul>
</li>
<li>结语</li>
<li><strong>前言</strong></li>
</ul>
<p>如果某一个资源被多个线程共享，为了避免因为资源抢占导致资源数据错乱，我们需要对线程进行同步，那么synchronized就是实现线程同步的关键字，可以说在并发控制中是必不可少的部分，今天就来看一下synchronized的使用和底层原理。</p>
<h1 id="一、synchronized的特性"><a href="#一、synchronized的特性" class="headerlink" title="一、synchronized的特性"></a><strong>一、synchronized的特性</strong></h1><h2 id="1-1-原子性"><a href="#1-1-原子性" class="headerlink" title="1.1 原子性"></a><strong>1.1 原子性</strong></h2><p><strong>所谓原子性就是指一个操作或者多个操作，要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行。</strong></p>
<p>在Java中，对基本数据类型的变量的读取和赋值操作是原子性操作，即这些操作是不可被中断的，要么执行，要么不执行。但是像i++、i+&#x3D;1等操作字符就不是原子性的，它们是分成<strong>读取、计算、赋值</strong><br>几步操作，原值在这些步骤还没完成时就可能已经被赋值了，那么最后赋值写入的数据就是脏数据，无法保证原子性。</p>
<p>被synchronized修饰的类或对象的所有操作都是原子的，因为在执行操作之前必须先获得类或对象的锁，直到执行完才能释放，这中间的过程无法被中断（除了已经废弃的stop()方法），即保证了原子性。</p>
<p><strong>注意！面试时经常会问比较synchronized和volatile，它们俩特性上最大的区别就在于原子性，volatile不具备原子性。</strong></p>
<h2 id="1-2-可见性"><a href="#1-2-可见性" class="headerlink" title="1.2 可见性"></a><strong>1.2 可见性</strong></h2><p><strong>可见性是指多个线程访问一个资源时，该资源的状态、值信息等对于其他线程都是可见的。</strong></p>
<p>synchronized和volatile都具有可见性，其中synchronized对一个类或对象加锁时，一个线程如果要访问该类或对象必须先获得它的锁，而这个锁的状态对于其他任何线程都是可见的，并且在释放锁之前会将对变量的修改刷新到主存当中，保证资源变量的可见性，如果某个线程占用了该锁，其他线程就必须在锁池中等待锁的释放。</p>
<p>而volatile的实现类似，被volatile修饰的变量，每当值需要修改时都会立即更新主存，主存是共享的，所有线程可见，所以确保了其他线程读取到的变量永远是最新值，保证可见性。</p>
<h2 id="1-3-有序性"><a href="#1-3-有序性" class="headerlink" title="1.3 有序性"></a><strong>1.3 有序性</strong></h2><p><strong>有序性值程序执行的顺序按照代码先后执行。</strong></p>
<p>synchronized和volatile都具有有序性，Java允许编译器和处理器对指令进行重排，但是指令重排并不会影响单线程的顺序，它影响的是多线程并发执行的顺序性。synchronized保证了每个时刻都只有一个线程访问同步代码块，也就确定了线程执行同步代码块是分先后顺序的，保证了有序性。</p>
<h2 id="1-4-可重入性"><a href="#1-4-可重入性" class="headerlink" title="1.4 可重入性"></a><strong>1.4 可重入性</strong></h2><p>synchronized和ReentrantLock都是可重入锁。当一个线程试图操作一个由其他线程持有的对象锁的临界资源时，将会处于阻塞状态，但当一个线程再次请求自己持有对象锁的临界资源时，这种情况属于重入锁。通俗一点讲就是说一个线程拥有了锁仍然还可以重复申请锁。</p>
<h1 id="二、synchronized的用法"><a href="#二、synchronized的用法" class="headerlink" title="二、synchronized的用法"></a><strong>二、synchronized的用法</strong></h1><p>synchronized可以修饰静态方法、成员函数，同时还可以直接定义代码块，但是归根结底它上锁的资源只有两类：一个是<strong>对象</strong>，一个是<strong>类</strong>。</p>
<p>先看看下面的代码（初学者看到先不要晕，后面慢慢讲解）：</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/7fppcq4izk.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p>首先我们知道被<code>static</code><br>修饰的静态方法、静态属性都是归类所有，同时该类的所有实例对象都可以访问。但是普通成员属性、成员方法是归实例化的对象所有，必须实例化之后才能访问，这也是为什么静态方法不能访问非静态属性的原因。我们明确了这些属性、方法归哪些所有之后就可以理解上面几个synchronized的锁到底是加给谁的了。</p>
<p>首先看第一个synchronized所加的方法是<code>add1()</code>，该方法没有被<code>static</code>修饰，也就是说该方法是归实例化的对象所有，那么这个锁就是加给Test1类所实例化的对象。</p>
<p>然后是<code>add2()</code>方法，该方法是静态方法，归Test1类所有，所以这个锁是加给Test1类的。</p>
<p>最后是<code>method()</code>方法中两个同步代码块，第一个代码块所锁定的是<code>Test1.class</code>，通过字面意思便知道该锁是加给Test1类的，而下面那个锁定的是<code>instance</code><br>，这个instance是Test1类的一个实例化对象，自然它所上的锁是给instance实例化对象的。</p>
<p>弄清楚这些锁是上给谁的就应该很容易懂synchronized的使用啦，只要记住要进入同步方法或同步块必须先获得相应的锁才行。那么我下面再列举出一个非常容易进入误区的代码，看看你是否真的理解了上面的解释。</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/bdx17z87nc.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p>上面的简单意思就是用两个线程分别对i加100万次，理论结果应该是200万，而且我还加了synchronized锁住了add方法，保证了其线程安全性。可是！！！我无论运行多少次都是小于200万的，为什么呢？</p>
<p>原因就在于synchronized加锁的函数，这个方法是普通成员方法，那么锁就是加给对象的，但是<strong>在创建线程时却new了两个Test2实例，也就是说这个锁是给这两个实例加的锁，并没有达到同步的效果</strong><br>，所以才会出现错误。至于为什么小于200万，要理解<code>i++</code>的过程就明白了，我之前写了一篇文章讲解过这个过程，请阅读：<a href="https://mp.weixin.qq.com/s?__biz=MzU3OTkyMDAxNg==&mid=2247483817&idx=1&sn=1d782e56995356dec7eaeb8749260c61&chksm=fd5f8856ca280140e21ded04dd6304ae8832a160505e632800a8ce245e3a1b1fea27b3b3671a&token=268872677&lang=zh_CN&scene=21#wechat_redirect">**<br>详谈Java中的CAS操作**</a></p>
<h1 id="三、synchronized锁的实现"><a href="#三、synchronized锁的实现" class="headerlink" title="三、synchronized锁的实现"></a><strong>三、synchronized锁的实现</strong></h1><p>synchronized有两种形式上锁，一个是对方法上锁，一个是构造同步代码块。他们的底层实现其实都一样，在进入同步代码之前先获取锁，获取到锁之后锁的计数器+1，同步代码执行完锁的计数器-1，如果获取失败就阻塞式等待锁的释放。只是他们在同步块识别方式上有所不一样，从class字节码文件可以表现出来，一个是通过方法flags标志，一个是monitorenter和monitorexit指令操作。</p>
<h2 id="3-1-同步方法"><a href="#3-1-同步方法" class="headerlink" title="3.1 同步方法"></a><strong>3.1 同步方法</strong></h2><p>首先来看在方法上上锁，我们就新定义一个同步方法然后进行反编译，查看其字节码：</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/wdzcv6eszv.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/mbe3ktwj6h.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p>可以看到在add方法的flags里面多了一个<code>ACC_SYNCHRONIZED</code>标志，这标志用来告诉JVM这是一个同步方法，在进入该方法之前先获取相应的锁，锁的计数器加1，方法结束后计数器-1，如果获取失败就阻塞住，知道该锁被释放。</p>
<p>如果看不懂字节码指令的朋友可以先阅读我之前写的两篇文章，了解一下class的结构：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzU3OTkyMDAxNg==&mid=2247484028&idx=1&sn=a84dc06e221444cfed73fcb60322678f&chksm=fd5f8b83ca2802950e7bc4ae28f5fe80a463c78996acee09904a2a2a8d7f19d11a92289f559e&scene=21#wechat_redirect">**<br>详解Class类文件的结构（上）**</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzU3OTkyMDAxNg==&mid=2247484033&idx=1&sn=9fde746119825b09faa08a36d142bec4&chksm=fd5f8b7eca2802682f03ce38f9d51fb59ec033c54cb776836161f7151939020bfe76113f3034&token=268872677&lang=zh_CN&scene=21#wechat_redirect">**<br>详解Class类文件的结构（下）**</a></li>
</ul>
<h2 id="3-2-同步代码块"><a href="#3-2-同步代码块" class="headerlink" title="3.2 同步代码块"></a><strong>3.2 同步代码块</strong></h2><p>我们新定义一个同步代码块，编译出class字节码，然后找到method方法所在的指令块，可以清楚的看到其实现上锁和释放锁的过程，截图如下：</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/8v9z1ullj9.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/445esedcaq.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p>从反编译的同步代码块可以看到同步块是由monitorenter指令进入，然后monitorexit释放锁，在执行monitorenter之前需要尝试获取锁，如果这个对象没有被锁定，或者当前线程已经拥有了这个对象的锁，那么就把锁的计数器加1。当执行monitorexit指令时，锁的计数器也会减1。当获取锁失败时会被阻塞，一直等待锁被释放。</p>
<p>但是为什么会有两个monitorexit呢？其实第二个monitorexit是来处理异常的，仔细看反编译的字节码，正常情况下第一个monitorexit之后会执行<code>goto</code>指令，而该指令转向的就是23行的<code>return</code><br>，也就是说正常情况下只会执行第一个monitorexit释放锁，然后返回。而如果在执行中发生了异常，第二个monitorexit就起作用了，它是由编译器自动生成的，在发生异常时处理异常然后释放掉锁。</p>
<h1 id="四、synchronized锁的底层实现"><a href="#四、synchronized锁的底层实现" class="headerlink" title="四、synchronized锁的底层实现"></a><strong>四、synchronized锁的底层实现</strong></h1><p>在理解锁实现原理之前先了解一下Java的对象头和Monitor，在JVM中，对象是分成三部分存在的：对象头、实例数据、对其填充。</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/fu98yi2bmj.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<p>实例数据和对其填充与synchronized无关，这里简单说一下（我也是阅读《深入理解Java虚拟机》学到的，读者可仔细阅读该书相关章节学习）。<strong>实例数据</strong><br>存放类的属性数据信息，包括父类的属性信息，如果是数组的实例部分还包括数组的长度，这部分内存按4字节对齐；<strong>对其填充</strong>不是必须部分，由于虚拟机要求对象起始地址必须是8字节的整数倍，对齐填充仅仅是为了使字节对齐。</p>
<p>对象头是我们需要关注的重点，它是synchronized实现锁的基础，因为synchronized申请锁、上锁、释放锁都与对象头有关。对象头主要结构是由<code>Mark Word</code> 和 <code>Class Metadata Address</code>组成，**<br>其中**<code>**Mark Word**</code><strong>存储对象的hashCode、锁信息或分代年龄或GC标志等信息</strong>，<code>**Class Metadata Address**</code>**<br>是类型指针指向对象的类元数据，JVM通过该指针确定该对象是哪个类的实例**。</p>
<p>锁也分不同状态，JDK6之前只有两个状态：无锁、有锁（重量级锁），而在JDK6之后对synchronized进行了优化，新增了两种状态，总共就是四个状态：<strong>无锁状态、偏向锁、轻量级锁、重量级锁</strong><br>，其中无锁就是一种状态了。锁的类型和状态在对象头<code>Mark Word</code>中都有记录，在申请锁、锁升级等过程中JVM都需要读取对象的<code>Mark Word</code>数据。</p>
<p>每一个锁都对应一个monitor对象，在HotSpot虚拟机中它是由ObjectMonitor实现的（C++实现）。每个对象都存在着一个monitor与之关联，对象与其monitor之间的关系有存在多种实现方式，如monitor可以与对象一起创建销毁或当线程试图获取对象锁时自动生成，但当一个monitor被某个线程持有后，它便处于锁定状态。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">ObjectMonitor</span>() &#123;</span><br><span class="line">    _header       = <span class="variable constant_">NULL</span>;</span><br><span class="line">    _count        = <span class="number">0</span>;  <span class="comment">//锁计数器</span></span><br><span class="line">    _waiters      = <span class="number">0</span>,</span><br><span class="line">    _recursions   = <span class="number">0</span>;</span><br><span class="line">    _object       = <span class="variable constant_">NULL</span>;</span><br><span class="line">    _owner        = <span class="variable constant_">NULL</span>;</span><br><span class="line">    _WaitSet      = <span class="variable constant_">NULL</span>; <span class="comment">//处于wait状态的线程，会被加入到_WaitSet</span></span><br><span class="line">    _WaitSetLock  = <span class="number">0</span> ;</span><br><span class="line">    _Responsible  = <span class="variable constant_">NULL</span> ;</span><br><span class="line">    _succ         = <span class="variable constant_">NULL</span> ;</span><br><span class="line">    _cxq          = <span class="variable constant_">NULL</span> ;</span><br><span class="line">    <span class="title class_">FreeNext</span>      = <span class="variable constant_">NULL</span> ;</span><br><span class="line">    _EntryList    = <span class="variable constant_">NULL</span> ; <span class="comment">//处于等待锁block状态的线程，会被加入到该列表</span></span><br><span class="line">    _SpinFreq     = <span class="number">0</span> ;</span><br><span class="line">    _SpinClock    = <span class="number">0</span> ;</span><br><span class="line">    <span class="title class_">OwnerIsThread</span> = <span class="number">0</span> ;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>复制</p>
<blockquote>
<p>该段摘自：<a href="https://blog.csdn.net/javazejian/article/details/72828483">https://blog.csdn.net/javazejian/article/details/72828483</a>  ObjectMonitor中有两个队列_WaitSet和_EntryList，用来保存ObjectWaiter对象列表(每个等待锁的线程都会被封装ObjectWaiter对象)，_owner指向持有ObjectMonitor对象的线程，当多个线程同时访问一段同步代码时，首先会进入_EntryList 集合，当线程获取到对象的monitor 后进入 _Owner 区域并把monitor中的owner变量设置为当前线程同时monitor中的计数器count加1，若线程调用 wait() 方法，将释放当前持有的monitor，owner变量恢复为null，count自减1，同时该线程进入 WaitSe t集合中等待被唤醒。若当前线程执行完毕也将释放monitor(锁)并复位变量的值，以便其他线程进入获取monitor(锁)。 monitor对象存在于每个Java对象的对象头中(存储的指针的指向)，synchronized锁便是通过这种方式获取锁的，也是为什么Java中任意对象可以作为锁的原因，同时也是notify&#x2F;notifyAll&#x2F;wait等方法存在于顶级对象Object中的原因(关于这点稍后还会进行分析)</p>
</blockquote>
<h1 id="五、JVM对synchronized的优化"><a href="#五、JVM对synchronized的优化" class="headerlink" title="五、JVM对synchronized的优化"></a><strong>五、JVM对synchronized的优化</strong></h1><p>从最近几个jdk版本中可以看出，Java的开发团队一直在对synchronized优化，其中最大的一次优化就是在jdk6的时候，新增了两个锁状态，通过锁消除、锁粗化、自旋锁等方法使用各种场景，给synchronized性能带来了很大的提升。</p>
<h2 id="5-1-锁膨胀"><a href="#5-1-锁膨胀" class="headerlink" title="5.1 锁膨胀"></a><strong>5.1 锁膨胀</strong></h2><p>上面讲到锁有四种状态，并且会因实际情况进行膨胀升级，其膨胀方向是：<strong>无锁——&gt;偏向锁——&gt;轻量级锁——&gt;重量级锁</strong>，并且膨胀方向不可逆。</p>
<h3 id="5-1-1-偏向锁"><a href="#5-1-1-偏向锁" class="headerlink" title="5.1.1 偏向锁"></a><strong>5.1.1 偏向锁</strong></h3><p>一句话总结它的作用：<strong>减少统一线程获取锁的代价</strong>。在大多数情况下，锁不存在多线程竞争，总是由同一线程多次获得，那么此时就是偏向锁。</p>
<p><strong>核心思想：</strong></p>
<p>如果一个线程获得了锁，那么锁就进入偏向模式，此时<code>Mark Word</code>的结构也就变为偏向锁结构，<strong>当该线程再次请求锁时，无需再做任何同步操作，即获取锁的过程只需要检查</strong><code>**Mark Word**</code>**<br>的锁标记位为偏向锁以及当前线程ID等于**<code>**Mark Word**</code><strong>的ThreadID即可</strong>，这样就省去了大量有关锁申请的操作。</p>
<h3 id="5-1-2-轻量级锁"><a href="#5-1-2-轻量级锁" class="headerlink" title="5.1.2 轻量级锁"></a><strong>5.1.2 轻量级锁</strong></h3><p>轻量级锁是由偏向锁升级而来，当存在第二个线程申请同一个锁对象时，偏向锁就会立即升级为轻量级锁。注意这里的第二个线程只是申请锁，不存在两个线程同时竞争锁，可以是一前一后地交替执行同步块。</p>
<h3 id="5-1-3-重量级锁"><a href="#5-1-3-重量级锁" class="headerlink" title="5.1.3 重量级锁"></a><strong>5.1.3 重量级锁</strong></h3><p>重量级锁是由轻量级锁升级而来，当<strong>同一时间</strong>有多个线程竞争锁时，锁就会被升级成重量级锁，此时其申请锁带来的开销也就变大。</p>
<p>重量级锁一般使用场景会在追求吞吐量，同步块或者同步方法执行时间较长的场景。</p>
<h2 id="5-2-锁消除"><a href="#5-2-锁消除" class="headerlink" title="5.2 锁消除"></a><strong>5.2 锁消除</strong></h2><p>消除锁是虚拟机另外一种锁的优化，这种优化更彻底，在JIT编译时，对运行上下文进行扫描，去除不可能存在竞争的锁。比如下面代码的method1和method2的执行效率是一样的，因为object锁是私有变量，不存在所得竞争关系。</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/crldlzz0n7.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<h2 id="5-3-锁粗化"><a href="#5-3-锁粗化" class="headerlink" title="5.3 锁粗化"></a><strong>5.3 锁粗化</strong></h2><p>锁粗化是虚拟机对另一种极端情况的优化处理，通过扩大锁的范围，避免反复加锁和释放锁。比如下面method3经过锁粗化优化之后就和method4执行效率一样了。</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-5522483/vra4opn4on.webp?imageView2/2/w/1620/format/jpg" alt="img"></p>
<h2 id="5-4-自旋锁与自适应自旋锁"><a href="#5-4-自旋锁与自适应自旋锁" class="headerlink" title="5.4 自旋锁与自适应自旋锁"></a><strong>5.4 自旋锁与自适应自旋锁</strong></h2><p>轻量级锁失败后，虚拟机为了避免线程真实地在操作系统层面挂起，还会进行一项称为自旋锁的优化手段。</p>
<p>自旋锁：许多情况下，共享数据的锁定状态持续时间较短，切换线程不值得，通过让线程执行循环等待锁的释放，不让出CPU。如果得到锁，就顺利进入临界区。如果还不能获得锁，那就会将线程在操作系统层面挂起，这就是自旋锁的优化方式。但是它也存在缺点：如果锁被其他线程长时间占用，一直不释放CPU，会带来许多的性能开销。</p>
<p><strong>自适应自旋锁</strong>：这种相当于是对上面自旋锁优化方式的进一步优化，它的自旋的次数不再固定，其自旋的次数由前一次在同一个锁上的自旋时间及锁的拥有者的状态来决定，这就解决了自旋锁带来的缺点。</p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a><strong>结语</strong></h1><p>synchronized关键字是并发编程不可或缺的部分，个人认为能真实理解其内部运作原理能对平时的开发带来很大意义上的帮助，希望这篇文章能帮助你！</p>
<p>文章分享自微信公众号：</p>
<p><img src="https://open.weixin.qq.com/qr/code?username=gh_f1c6f5c801ce" alt="img"></p>
<p>北风IT之路</p>
<p>复制公众号名称</p>
<p>本文参与 <a href="https://cloud.tencent.com/developer/support-plan">腾讯云自媒体分享计划</a> ，欢迎热爱写作的你一起参与！</p>
<p>作者：beifengtz</p>
<p>原始发表时间：2019-07-15</p>
<p>如有侵权，请联系 <a href="mailto:&#x63;&#x6c;&#x6f;&#x75;&#100;&#99;&#x6f;&#109;&#109;&#x75;&#110;&#x69;&#116;&#x79;&#x40;&#116;&#101;&#110;&#99;&#101;&#110;&#x74;&#x2e;&#x63;&#111;&#x6d;">&#x63;&#x6c;&#x6f;&#x75;&#100;&#99;&#x6f;&#109;&#109;&#x75;&#110;&#x69;&#116;&#x79;&#x40;&#116;&#101;&#110;&#99;&#101;&#110;&#x74;&#x2e;&#x63;&#111;&#x6d;</a> 删除。</p>
]]></content>
      <categories>
        <category>spring</category>
      </categories>
  </entry>
  <entry>
    <title>狂神说SpringBoot02：运行原理初探</title>
    <url>/2023/04/06/%E7%8B%82%E7%A5%9E%E8%AF%B4SpringBoot02%EF%BC%9A%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86%E5%88%9D%E6%8E%A2/</url>
    <content><![CDATA[<h1 id="狂神说SpringBoot02：运行原理初探"><a href="#狂神说SpringBoot02：运行原理初探" class="headerlink" title="狂神说SpringBoot02：运行原理初探"></a>狂神说SpringBoot02：运行原理初探</h1><p>我们之前写的HelloSpringBoot，到底是怎么运行的呢，Maven项目，我们一般从pom.xml文件探究起；</p>
<p><strong>pom.xml</strong></p>
<h2 id="父依赖"><a href="#父依赖" class="headerlink" title="父依赖"></a>父依赖</h2><p>其中它主要是依赖一个父项目，主要是管理项目的资源过滤及插件！</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">2.2</span><span class="number">.5</span>.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure>

<p>点进去，发现还有一个父依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>&gt;</span>../../spring-boot-dependencies<span class="tag">&lt;/<span class="name">relativePath</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里才是真正管理SpringBoot应用里面所有依赖版本的地方，SpringBoot的版本控制中心；</p>
<p><strong>以后我们导入依赖默认是不需要写版本；但是如果导入的包没有在依赖中管理着就需要手动配置版本了；</strong></p>
<h2 id="启动器-spring-boot-starter"><a href="#启动器-spring-boot-starter" class="headerlink" title="启动器 spring-boot-starter"></a>启动器 spring-boot-starter</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>springboot-boot-starter-xxx</strong>：就是spring-boot的场景启动器</p>
<p><strong>spring-boot-starter-web</strong>：帮我们导入了web模块正常运行所依赖的组件；</p>
<p>SpringBoot将所有的功能场景都抽取出来，做成一个个的starter （启动器），只需要在项目中引入这些starter即可，所有相关的依赖都会导入进来 ， 我们要用什么功能就导入什么样的场景启动器即可 ；我们未来也可以自己自定义<br>starter；</p>
<blockquote>
<p><strong>主启动类</strong></p>
</blockquote>
<p>分析完了 pom.xml 来看看这个启动类</p>
<h2 id="默认的主启动类"><a href="#默认的主启动类" class="headerlink" title="默认的主启动类"></a>默认的主启动类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">默认的主启动类</span><br><span class="line">    </span><br><span class="line"><span class="comment">//@SpringBootApplication 来标注一个主程序类</span></span><br><span class="line"><span class="comment">//说明这是一个Spring Boot应用</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="comment">//以为是启动了一个方法，没想到启动了一个服务</span></span><br><span class="line">      SpringApplication.run(SpringbootApplication.class, args);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是<strong>一个简单的启动类并不简单！</strong>我们来分析一下这些注解都干了什么</p>
<h2 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h2><p>作用：标注在某个类上说明这个类是SpringBoot的主配置类 ， SpringBoot就应该运行这个类的main方法来启动SpringBoot应用；</p>
<p>进入这个注解：可以看到上面还有很多其他注解！</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">    excludeFilters = &#123;@Filter(</span></span><br><span class="line"><span class="meta">    type = FilterType.CUSTOM,</span></span><br><span class="line"><span class="meta">    classes = &#123;TypeExcludeFilter.class&#125;</span></span><br><span class="line"><span class="meta">), @Filter(</span></span><br><span class="line"><span class="meta">    type = FilterType.CUSTOM,</span></span><br><span class="line"><span class="meta">    classes = &#123;AutoConfigurationExcludeFilter.class&#125;</span></span><br><span class="line"><span class="meta">)&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h2><p>这个注解在Spring中很重要 ,它对应XML配置中的元素。</p>
<p>作用：自动扫描并加载符合条件的组件或者bean ， 将这个bean定义加载到IOC容器中</p>
<h2 id="SpringBootConfiguration"><a href="#SpringBootConfiguration" class="headerlink" title="@SpringBootConfiguration"></a>@SpringBootConfiguration</h2><p>作用：SpringBoot的配置类 ，标注在某个类上 ， 表示这是一个SpringBoot的配置类；</p>
<p>我们继续进去这个注解查看</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootConfiguration &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Configuration &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>这里的 @Configuration，说明这是一个配置类 ，配置类就是对应Spring的xml 配置文件；</p>
<p>里面的 @Component 这就说明，启动类本身也是Spring中的一个组件而已，负责启动应用！</p>
<p>我们回到 SpringBootApplication 注解中继续看。</p>
<h2 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h2><p><strong>@EnableAutoConfiguration ：开启自动配置功能</strong></p>
<p>以前我们需要自己配置的东西，而现在SpringBoot可以自动帮我们配置 ；@EnableAutoConfiguration告诉SpringBoot开启自动配置功能，这样自动配置才能生效；</p>
<p>点进注解接续查看：</p>
<p><strong>@AutoConfigurationPackage ：自动配置包</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Import(&#123;Registrar.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AutoConfigurationPackage &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@Import({AutoConfigurationImportSelector.class}) ：给容器导入组件 ；</strong></p>
<p>AutoConfigurationImportSelector ：自动配置导入选择器，那么它会导入哪些组件的选择器呢？我们点击去这个类看源码：</p>
<p>1、这个类中有一个这样的方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获得候选的配置</span></span><br><span class="line"><span class="keyword">protected</span> List&lt;String&gt; <span class="title function_">getCandidateConfigurations</span><span class="params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> &#123;</span><br><span class="line">    <span class="comment">//这里的getSpringFactoriesLoaderFactoryClass（）方法</span></span><br><span class="line">    <span class="comment">//返回的就是我们最开始看的启动自动导入配置文件的注解类；EnableAutoConfiguration</span></span><br><span class="line">    List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(<span class="built_in">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="built_in">this</span>.getBeanClassLoader());</span><br><span class="line">    Assert.notEmpty(configurations, <span class="string">&quot;No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> configurations;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、这个方法又调用了 SpringFactoriesLoader 类的静态方法！我们进入SpringFactoriesLoader类loadFactoryNames() 方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">loadFactoryNames</span><span class="params">(Class&lt;?&gt; factoryClass, <span class="meta">@Nullable</span> ClassLoader classLoader)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">factoryClassName</span> <span class="operator">=</span> factoryClass.getName();</span><br><span class="line">    <span class="comment">//这里它又调用了 loadSpringFactories 方法</span></span><br><span class="line">    <span class="keyword">return</span> (List)loadSpringFactories(classLoader).getOrDefault(factoryClassName, Collections.emptyList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、我们继续点击查看 loadSpringFactories 方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, List&lt;String&gt;&gt; <span class="title function_">loadSpringFactories</span><span class="params">(<span class="meta">@Nullable</span> ClassLoader classLoader)</span> &#123;</span><br><span class="line">    <span class="comment">//获得classLoader ， 我们返回可以看到这里得到的就是EnableAutoConfiguration标注的类本身</span></span><br><span class="line">    MultiValueMap&lt;String, String&gt; result = (MultiValueMap)cache.get(classLoader);</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//去获取一个资源 &quot;META-INF/spring.factories&quot;</span></span><br><span class="line">            Enumeration&lt;URL&gt; urls = classLoader != <span class="literal">null</span> ? classLoader.getResources(<span class="string">&quot;META-INF/spring.factories&quot;</span>) : ClassLoader.getSystemResources(<span class="string">&quot;META-INF/spring.factories&quot;</span>);</span><br><span class="line">            <span class="type">LinkedMultiValueMap</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedMultiValueMap</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//将读取到的资源遍历，封装成为一个Properties</span></span><br><span class="line">            <span class="keyword">while</span>(urls.hasMoreElements()) &#123;</span><br><span class="line">                <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> (URL)urls.nextElement();</span><br><span class="line">                <span class="type">UrlResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlResource</span>(url);</span><br><span class="line">                <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> PropertiesLoaderUtils.loadProperties(resource);</span><br><span class="line">                <span class="type">Iterator</span> <span class="variable">var6</span> <span class="operator">=</span> properties.entrySet().iterator();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span>(var6.hasNext()) &#123;</span><br><span class="line">                    Entry&lt;?, ?&gt; entry = (Entry)var6.next();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">factoryClassName</span> <span class="operator">=</span> ((String)entry.getKey()).trim();</span><br><span class="line">                    String[] var9 = StringUtils.commaDelimitedListToStringArray((String)entry.getValue());</span><br><span class="line">                    <span class="type">int</span> <span class="variable">var10</span> <span class="operator">=</span> var9.length;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">var11</span> <span class="operator">=</span> <span class="number">0</span>; var11 &lt; var10; ++var11) &#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">factoryName</span> <span class="operator">=</span> var9[var11];</span><br><span class="line">                        result.add(factoryClassName, factoryName.trim());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            cache.put(classLoader, result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var13) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Unable to load factories from location [META-INF/spring.factories]&quot;</span>, var13);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、发现一个多次出现的文件：spring.factories，全局搜索它</p>
<h2 id="spring-factories"><a href="#spring-factories" class="headerlink" title="spring.factories"></a>spring.factories</h2><p>我们根据源头打开spring.factories ， 看到了很多自动配置的文件；这就是自动配置根源所在！</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZicEIZDCZKtTPxQrKTvEdxHFGsG824OkO8XN8CfP2x4OdpC8DwjHYwcFw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>WebMvcAutoConfiguration</strong></p>
<p>我们在上面的自动配置类随便找一个打开看看，比如 ：WebMvcAutoConfiguration</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZicaV7UfSRiaRdCHNmHE1wS10QwbLEVZJLB2sN9ztcvjx7n2dKDJ0HrCmA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>可以看到这些一个个的都是JavaConfig配置类，而且都注入了一些Bean，可以找一些自己认识的类，看着熟悉一下！</p>
<p>所以，自动配置真正实现是从classpath中搜寻所有的META-INF&#x2F;spring.factories配置文件 ，并将其中对应的 org.springframework.boot.autoconfigure.<br>包下的配置项，通过反射实例化为对应标注了 @Configuration的JavaConfig形式的IOC容器配置类 ， 然后将这些都汇总成为一个实例并加载到IOC容器中。</p>
<p><strong>结论：</strong></p>
<ol>
<li>SpringBoot在启动的时候从类路径下的META-INF&#x2F;spring.factories中获取EnableAutoConfiguration指定的值</li>
<li>将这些值作为自动配置类导入容器 ， 自动配置类就生效 ， 帮我们进行自动配置工作；</li>
<li>整个J2EE的整体解决方案和自动配置都在springboot-autoconfigure的jar包中；</li>
<li>它会给容器中导入非常多的自动配置类 （xxxAutoConfiguration）, 就是给容器中导入这个场景需要的所有组件 ， 并配置好这些组件 ；</li>
<li>有了自动配置类 ， 免去了我们手动编写配置注入功能组件等的工作；</li>
</ol>
<p><strong>现在大家应该大概的了解了下，SpringBoot的运行原理，后面我们还会深化一次！</strong></p>
<blockquote>
<p><strong>SpringApplication</strong></p>
</blockquote>
<h2 id="不简单的方法"><a href="#不简单的方法" class="headerlink" title="不简单的方法"></a>不简单的方法</h2><p>我最初以为就是运行了一个main方法，没想到却开启了一个服务；</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringbootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SpringApplication.run分析</strong></p>
<p>分析该方法主要分两部分，一部分是SpringApplication的实例化，二是run方法的执行；</p>
<h2 id="SpringApplication"><a href="#SpringApplication" class="headerlink" title="SpringApplication"></a>SpringApplication</h2><p><strong>这个类主要做了以下四件事情：</strong></p>
<p>1、推断应用的类型是普通的项目还是Web项目</p>
<p>2、查找并加载所有可用初始化器 ， 设置到initializers属性中</p>
<p>3、找出所有的应用程序监听器，设置到listeners属性中</p>
<p>4、推断并设置main方法的定义类，找到运行的主类</p>
<p>查看构造器：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">SpringApplication</span><span class="params">(ResourceLoader resourceLoader, Class... primarySources)</span> &#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    <span class="built_in">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class="line">    <span class="built_in">this</span>.setInitializers(<span class="built_in">this</span>.getSpringFactoriesInstances();</span><br><span class="line">    <span class="built_in">this</span>.setListeners(<span class="built_in">this</span>.getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class="line">    <span class="built_in">this</span>.mainApplicationClass = <span class="built_in">this</span>.deduceMainApplicationClass();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZicjafiawQLp9u8wc4ic1Mjy6OyfibzfjVofeL5pnS1NSFKVjlIg6neI9ySg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
]]></content>
      <categories>
        <category>spring</category>
      </categories>
  </entry>
  <entry>
    <title>狂神说spring boot第一讲 hello world</title>
    <url>/2023/04/06/%E7%8B%82%E7%A5%9E%E8%AF%B4spring%20boot%E7%AC%AC%E4%B8%80%E8%AE%B2%20hello%20world/</url>
    <content><![CDATA[<h1 id="狂神说spring-boot第一讲-hello-world"><a href="#狂神说spring-boot第一讲-hello-world" class="headerlink" title="狂神说spring boot第一讲 hello world"></a>狂神说spring boot第一讲 hello world</h1><h2 id="回顾什么是Spring"><a href="#回顾什么是Spring" class="headerlink" title="回顾什么是Spring"></a>回顾什么是Spring</h2><p>Spring是一个开源框架，2003 年兴起的一个轻量级的Java 开发框架，作者：Rod Johnson 。</p>
<p><strong>Spring是为了解决企业级应用开发的复杂性而创建的，简化开发。</strong></p>
<h2 id="Spring是如何简化Java开发的"><a href="#Spring是如何简化Java开发的" class="headerlink" title="Spring是如何简化Java开发的"></a>Spring是如何简化Java开发的</h2><p>为了降低Java开发的复杂性，Spring采用了以下4种关键策略：</p>
<p>1、基于POJO的轻量级和最小侵入性编程，所有东西都是bean；</p>
<p>2、通过IOC，依赖注入（DI）和面向接口实现松耦合；</p>
<p>3、基于切面（AOP）和惯例进行声明式编程；</p>
<p>4、通过切面和模版减少样式代码，RedisTemplate，xxxTemplate；</p>
<h2 id="什么是SpringBoot"><a href="#什么是SpringBoot" class="headerlink" title="什么是SpringBoot"></a>什么是SpringBoot</h2><p>学过javaweb的同学就知道，开发一个web应用，从最初开始接触Servlet结合Tomcat, 跑出一个Hello<br>Wolrld程序，是要经历特别多的步骤；后来就用了框架Struts，再后来是SpringMVC，到了现在的SpringBoot，过一两年又会有其他web框架出现；你们有经历过框架不断的演进，然后自己开发项目所有的技术也在不断的变化、改造吗？建议都可以去经历一遍；</p>
<p>言归正传，什么是SpringBoot呢，就是一个javaweb的开发框架，和SpringMVC类似，对比其他javaweb框架的好处，官方说是简化开发，约定大于配置， you can “just run”<br>，能迅速的开发web应用，几行代码开发一个http接口。</p>
<p>所有的技术框架的发展似乎都遵循了一条主线规律：从一个复杂应用场景 衍生<br>一种规范框架，人们只需要进行各种配置而不需要自己去实现它，这时候强大的配置功能成了优点；发展到一定程度之后，人们根据实际生产应用情况，选取其中实用功能和设计精华，重构出一些轻量级的框架；之后为了提高开发效率，嫌弃原先的各类配置过于麻烦，于是开始提倡“约定大于配置”，进而衍生出一些一站式的解决方案。</p>
<p>是的这就是Java企业级应用-&gt;J2EE-&gt;spring-&gt;springboot的过程。</p>
<p>随着 Spring 不断的发展，涉及的领域越来越多，项目整合开发需要配合各种各样的文件，慢慢变得不那么易用简单，违背了最初的理念，甚至人称配置地狱。Spring Boot<br>正是在这样的一个背景下被抽象出来的开发框架，目的为了让大家更容易的使用 Spring 、更容易的集成各种常用的中间件、开源软件；</p>
<p>Spring Boot 基于 Spring 开发，Spirng Boot 本身并不提供 Spring 框架的核心特性以及扩展功能，只是用于快速、敏捷地开发新一代基于 Spring 框架的应用程序。也就是说，它并不是用来替代 Spring<br>的解决方案，而是和 Spring 框架紧密结合用于提升 Spring 开发者体验的工具。Spring Boot 以<strong>约定大于配置的核心思想</strong>，默认帮我们进行了很多设置，多数 Spring Boot 应用只需要很少的 Spring<br>配置。同时它集成了大量常用的第三方库配置（例如 Redis、MongoDB、Jpa、RabbitMQ、Quartz 等等），Spring Boot 应用中这些第三方库几乎可以零配置的开箱即用。</p>
<p>简单来说就是SpringBoot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，spring boot整合了所有的框架 。</p>
<p>Spring Boot 出生名门，从一开始就站在一个比较高的起点，又经过这几年的发展，生态足够完善，Spring Boot 已经当之无愧成为 Java 领域最热门的技术。</p>
<p><strong>Spring Boot的主要优点：</strong></p>
<ul>
<li>为所有Spring开发者更快的入门</li>
<li><strong>开箱即用</strong>，提供各种默认配置来简化项目配置</li>
<li>内嵌式容器简化Web项目</li>
<li>没有冗余代码生成和XML配置的要求</li>
</ul>
<p>真的很爽，我们快速去体验开发个接口的感觉吧！</p>
<p><strong>项目结构分析：</strong></p>
<p>通过上面步骤完成了基础项目的创建。就会自动生成以下文件。</p>
<p>1、程序的主启动类</p>
<p>2、一个 application.properties 配置文件</p>
<p>3、一个 测试类</p>
<p>4、一个 pom.xml</p>
<h2 id="pom-xml-分析"><a href="#pom-xml-分析" class="headerlink" title="pom.xml 分析"></a>pom.xml 分析</h2><p>打开pom.xml，看看Spring Boot项目的依赖：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- web场景启动器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- springboot单元测试 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 剔除依赖 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 打包插件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="编写一个http接口"><a href="#编写一个http接口" class="headerlink" title="编写一个http接口"></a>编写一个http接口</h2><p>1、在主程序的同级目录下，新建一个controller包，一定要在同级目录下，否则识别不到</p>
<p>2、在包中新建一个HelloController类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、编写完毕后，从主程序启动项目，浏览器发起请求，看页面返回；控制台输出了 Tomcat 访问的端口号！</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZic3WmhvicMATPwQLpTwLtWWE0aQs32iaEKyFnVViacPQbtEdCjBXm5yZf0A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZiczfno2TOQbfItia25xQzicMFnkicKh5pVD7IrHrUicb03y381CicrLFKXNMw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>如果遇到以上错误，可以配置打包时 跳过项目运行测试用例</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    在工作中,很多情况下我们打包是不想执行测试用例的</span></span><br><span class="line"><span class="comment">    可能是测试用例不完事,或是测试用例会影响数据库数据</span></span><br><span class="line"><span class="comment">    跳过测试用例执</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--跳过项目运行测试用例--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果打包成功，则会在target目录下生成一个 jar 包</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7L1vFQMnaRIJSmeZ58T2eZic03vupvIqMbibWh4aIKyjiaQfwuvDWKo033g9kRvj6aXnJO4brKTdwnvA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
]]></content>
      <categories>
        <category>spring boot</category>
      </categories>
  </entry>
</search>
